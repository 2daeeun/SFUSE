<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SFUSE_Documentation: include/fs.h 파일 참조</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SFUSE_Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','검색',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('df/d26/fs_8h.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">로딩중...</div>
<div class="SRStatus" id="Searching">검색중...</div>
<div class="SRStatus" id="NoMatches">일치하는것 없음</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">fs.h 파일 참조</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/d98/super_8h_source.html">super.h</a>&quot;</code><br />
<code>#include &lt;fuse3/fuse.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
fs.h에 대한 include 의존 그래프</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/de1/fs_8h__incl.png" border="0" usemap="#ainclude_2fs_8h" loading="lazy" alt=""/></div>
<map name="ainclude_2fs_8h" id="ainclude_2fs_8h">
<area shape="rect" title=" " alt="" coords="219,5,315,33"/>
<area shape="rect" href="../../db/d98/super_8h.html" title=" " alt="" coords="6,81,75,109"/>
<area shape="poly" title=" " alt="" coords="227,36,91,80,89,75,226,31"/>
<area shape="rect" title=" " alt="" coords="99,81,200,109"/>
<area shape="poly" title=" " alt="" coords="248,36,185,75,182,71,245,31"/>
<area shape="rect" title=" " alt="" coords="225,81,309,109"/>
<area shape="poly" title=" " alt="" coords="270,34,270,65,264,65,264,34"/>
<area shape="rect" title=" " alt="" coords="333,81,428,109"/>
<area shape="poly" title=" " alt="" coords="289,31,349,70,346,75,286,36"/>
<area shape="rect" title=" " alt="" coords="453,81,516,109"/>
<area shape="poly" title=" " alt="" coords="307,31,439,75,437,80,305,36"/>
<area shape="rect" title=" " alt="" coords="5,157,76,184"/>
<area shape="poly" title=" " alt="" coords="43,109,43,141,38,141,38,109"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
이 그래프는 이 파일을 직/간접적으로 include 하는 파일들을 보여줍니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d98/fs_8h__dep__incl.png" border="0" usemap="#ainclude_2fs_8hdep" loading="lazy" alt=""/></div>
<map name="ainclude_2fs_8hdep" id="ainclude_2fs_8hdep">
<area shape="rect" title=" " alt="" coords="136,5,232,33"/>
<area shape="rect" href="../../df/d9c/dir_8h.html" title=" " alt="" coords="5,81,107,109"/>
<area shape="poly" title=" " alt="" coords="149,43,80,83,77,78,147,39"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html" title=" " alt="" coords="110,157,178,184"/>
<area shape="poly" title=" " alt="" coords="179,49,150,157,145,155,174,47"/>
<area shape="rect" href="../../d0/d29/main_8c.html" title=" " alt="" coords="181,81,270,109"/>
<area shape="poly" title=" " alt="" coords="201,46,220,79,216,82,197,48"/>
<area shape="rect" href="../../d9/d70/ops_8c.html" title=" " alt="" coords="294,81,372,109"/>
<area shape="poly" title=" " alt="" coords="226,38,308,78,306,83,223,43"/>
<area shape="rect" href="../../de/d32/dir_8c.html" title=" " alt="" coords="14,157,87,184"/>
<area shape="poly" title=" " alt="" coords="57,125,54,156,49,156,51,124"/>
<area shape="poly" title=" " alt="" coords="85,117,130,154,127,158,82,121"/>
</map>
</div>
</div>
<p><a href="../../df/d26/fs_8h_source.html">이 파일의 소스 코드 페이지로 가기</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
데이터 구조</h2></td></tr>
<tr class="memitem:sfuse_5Ffs" id="r_sfuse_5Ffs"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SFUSE 파일 시스템 컨텍스트 구조체  <a href="../../df/dc5/structsfuse__fs.html#details">더 자세히 ...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
함수</h2></td></tr>
<tr class="memitem:a585a14f482e0d9dc375d2f10808be104" id="r_a585a14f482e0d9dc375d2f10808be104"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a585a14f482e0d9dc375d2f10808be104">fs_initialize</a> (const char *image_path, int *error_out)</td></tr>
<tr class="memdesc:a585a14f482e0d9dc375d2f10808be104"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 시스템 초기화  <br /></td></tr>
<tr class="memitem:a2bc3c75472b51af52b6e3bf1e4f17667" id="r_a2bc3c75472b51af52b6e3bf1e4f17667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bc3c75472b51af52b6e3bf1e4f17667">fs_teardown</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs)</td></tr>
<tr class="memdesc:a2bc3c75472b51af52b6e3bf1e4f17667"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 시스템 정리  <br /></td></tr>
<tr class="memitem:a8d5826ede78fcd2b76628eabb56e70db" id="r_a8d5826ede78fcd2b76628eabb56e70db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, uint32_t *out_ino)</td></tr>
<tr class="memdesc:a8d5826ede78fcd2b76628eabb56e70db"><td class="mdescLeft">&#160;</td><td class="mdescRight">경로를 inode 번호로 변환  <br /></td></tr>
<tr class="memitem:a012d00e6eafc0bb7c9402e3f36cee00a" id="r_a012d00e6eafc0bb7c9402e3f36cee00a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a012d00e6eafc0bb7c9402e3f36cee00a">fs_getattr</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, struct stat *stbuf)</td></tr>
<tr class="memdesc:a012d00e6eafc0bb7c9402e3f36cee00a"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일/디렉터리 속성 조회  <br /></td></tr>
<tr class="memitem:ae8816ea1bc016bed838b45345615d46c" id="r_ae8816ea1bc016bed838b45345615d46c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8816ea1bc016bed838b45345615d46c">fs_access</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, int mask)</td></tr>
<tr class="memdesc:ae8816ea1bc016bed838b45345615d46c"><td class="mdescLeft">&#160;</td><td class="mdescRight">접근 권한 검사  <br /></td></tr>
<tr class="memitem:addbb0f0d2e2d634975c40330e23bc8ae" id="r_addbb0f0d2e2d634975c40330e23bc8ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addbb0f0d2e2d634975c40330e23bc8ae">fs_readdir</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, void *buf, fuse_fill_dir_t filler, off_t offset)</td></tr>
<tr class="memdesc:addbb0f0d2e2d634975c40330e23bc8ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리 내용 읽기  <br /></td></tr>
<tr class="memitem:a9741976c80c2167280c9a0c3ff856d2d" id="r_a9741976c80c2167280c9a0c3ff856d2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9741976c80c2167280c9a0c3ff856d2d">fs_open</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, struct fuse_file_info *fi)</td></tr>
<tr class="memdesc:a9741976c80c2167280c9a0c3ff856d2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 열기  <br /></td></tr>
<tr class="memitem:a28b88e33bc2ea2e1f024968f35073824" id="r_a28b88e33bc2ea2e1f024968f35073824"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28b88e33bc2ea2e1f024968f35073824">fs_read</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, char *buf, size_t size, off_t offset)</td></tr>
<tr class="memdesc:a28b88e33bc2ea2e1f024968f35073824"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 읽기  <br /></td></tr>
<tr class="memitem:aecadaa463253df28c47f4a201dda2359" id="r_aecadaa463253df28c47f4a201dda2359"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecadaa463253df28c47f4a201dda2359">fs_write</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, const char *buf, size_t size, off_t offset)</td></tr>
<tr class="memdesc:aecadaa463253df28c47f4a201dda2359"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 쓰기  <br /></td></tr>
<tr class="memitem:a6129288ed91728ed7ef053ad8d0cc79d" id="r_a6129288ed91728ed7ef053ad8d0cc79d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6129288ed91728ed7ef053ad8d0cc79d">fs_create</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, mode_t mode, struct fuse_file_info *fi)</td></tr>
<tr class="memdesc:a6129288ed91728ed7ef053ad8d0cc79d"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 생성  <br /></td></tr>
<tr class="memitem:a0e6c18058ed432a1b33962e1f7fda11f" id="r_a0e6c18058ed432a1b33962e1f7fda11f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e6c18058ed432a1b33962e1f7fda11f">fs_mkdir</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, mode_t mode)</td></tr>
<tr class="memdesc:a0e6c18058ed432a1b33962e1f7fda11f"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리 생성  <br /></td></tr>
<tr class="memitem:add11b7953b7d14deb0456e14c8d7b197" id="r_add11b7953b7d14deb0456e14c8d7b197"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add11b7953b7d14deb0456e14c8d7b197">fs_unlink</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path)</td></tr>
<tr class="memdesc:add11b7953b7d14deb0456e14c8d7b197"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 삭제  <br /></td></tr>
<tr class="memitem:a8cf3ec78e9108f22f73ac3ab974fe8dc" id="r_a8cf3ec78e9108f22f73ac3ab974fe8dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8cf3ec78e9108f22f73ac3ab974fe8dc">fs_rmdir</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path)</td></tr>
<tr class="memdesc:a8cf3ec78e9108f22f73ac3ab974fe8dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리 삭제  <br /></td></tr>
<tr class="memitem:af677d22449626003a22868b28501f79a" id="r_af677d22449626003a22868b28501f79a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af677d22449626003a22868b28501f79a">fs_rename</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *from, const char *to)</td></tr>
<tr class="memdesc:af677d22449626003a22868b28501f79a"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 또는 디렉터리 이름 변경  <br /></td></tr>
<tr class="memitem:a6a7f3ad04cc17f3fb58519236a2ee996" id="r_a6a7f3ad04cc17f3fb58519236a2ee996"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a7f3ad04cc17f3fb58519236a2ee996">fs_truncate</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, off_t size)</td></tr>
<tr class="memdesc:a6a7f3ad04cc17f3fb58519236a2ee996"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일 크기 조정 (truncate)  <br /></td></tr>
<tr class="memitem:a818f99fae8ad5abcc450d41aac5d37ec" id="r_a818f99fae8ad5abcc450d41aac5d37ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a818f99fae8ad5abcc450d41aac5d37ec">fs_utimens</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, const struct timespec tv[2])</td></tr>
<tr class="memdesc:a818f99fae8ad5abcc450d41aac5d37ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">파일의 시간 속성 변경 (utimens)  <br /></td></tr>
<tr class="memitem:afa59764091da583a569ad9e517043425" id="r_afa59764091da583a569ad9e517043425"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa59764091da583a569ad9e517043425">fs_flush</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, struct fuse_file_info *fi)</td></tr>
<tr class="memdesc:afa59764091da583a569ad9e517043425"><td class="mdescLeft">&#160;</td><td class="mdescRight">FUSE에서 플러시 요청 처리  <br /></td></tr>
<tr class="memitem:ab503c5dc5cb6a0dc77f0b6d92bfccf5f" id="r_ab503c5dc5cb6a0dc77f0b6d92bfccf5f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab503c5dc5cb6a0dc77f0b6d92bfccf5f">fs_fsync</a> (struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs, const char *path, int datasync, struct fuse_file_info *fi)</td></tr>
<tr class="memdesc:ab503c5dc5cb6a0dc77f0b6d92bfccf5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">FUSE에서 fsync 요청 처리  <br /></td></tr>
<tr class="memitem:a7f093e2e9259d0b6002f4da685de854d" id="r_a7f093e2e9259d0b6002f4da685de854d"><td class="memItemLeft" align="right" valign="top">struct fuse_operations *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f093e2e9259d0b6002f4da685de854d">sfuse_get_operations</a> (void)</td></tr>
<tr class="memdesc:a7f093e2e9259d0b6002f4da685de854d"><td class="mdescLeft">&#160;</td><td class="mdescRight">SFUSE용 FUSE operations 구조체 반환  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">함수 문서화</h2>
<a id="ae8816ea1bc016bed838b45345615d46c" name="ae8816ea1bc016bed838b45345615d46c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8816ea1bc016bed838b45345615d46c">&#9670;&#160;</a></span>fs_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_access </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>mask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>접근 권한 검사 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 </td></tr>
    <tr><td class="paramname">mask</td><td>검사할 접근 마스크 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>접근 권한 검사</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>검사할 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">mask</td><td>접근 마스크 (R_OK, W_OK, X_OK) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01381">1381</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1381</span>                                                               {</div>
<div class="line"><span class="lineno"> 1382</span>  uint32_t ino;</div>
<div class="line"><span class="lineno"> 1383</span>  <span class="comment">/* 경로 → inode 변환 실패 시 ENOENT 반환 */</span></div>
<div class="line"><span class="lineno"> 1384</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0)</div>
<div class="line"><span class="lineno"> 1385</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1386</span>  <span class="comment">/* mask에 따른 실제 권한 검사는 필요 시 구현 가능 */</span></div>
<div class="line"><span class="lineno"> 1387</span>  (void)mask;</div>
<div class="line"><span class="lineno"> 1388</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1389</span>}</div>
<div class="ttc" id="afs_8c_html_a8d5826ede78fcd2b76628eabb56e70db"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a></div><div class="ttdeci">int fs_resolve_path(struct sfuse_fs *fs, const char *path, uint32_t *out_ino)</div><div class="ttdoc">경로 문자열을 inode 번호로 변환</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00236">fs.c:236</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_cgraph.png" border="0" usemap="#adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_cgraph" id="adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_cgraph">
<area shape="rect" title="접근 권한 검사" alt="" coords="5,32,90,60"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="138,32,262,60"/>
<area shape="poly" title=" " alt="" coords="90,43,122,43,122,48,90,48"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="310,32,399,60"/>
<area shape="poly" title=" " alt="" coords="263,43,294,43,294,48,263,48"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="447,5,540,33"/>
<area shape="poly" title=" " alt="" coords="399,35,431,28,433,34,400,40"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="447,57,540,85"/>
<area shape="poly" title=" " alt="" coords="400,51,432,57,432,63,399,57"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="588,5,690,33"/>
<area shape="poly" title=" " alt="" coords="540,16,572,16,572,22,540,22"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_icgraph.png" border="0" usemap="#adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_icgraph" id="adf/d26/fs_8h_ae8816ea1bc016bed838b45345615d46c_icgraph">
<area shape="rect" title="접근 권한 검사" alt="" coords="493,5,578,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4" title="access 콜백" alt="" coords="316,5,445,33"/>
<area shape="poly" title=" " alt="" coords="478,22,446,22,446,16,478,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a6129288ed91728ed7ef053ad8d0cc79d" name="a6129288ed91728ed7ef053ad8d0cc79d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6129288ed91728ed7ef053ad8d0cc79d">&#9670;&#160;</a></span>fs_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fuse_file_info *</td>          <td class="paramname"><span class="paramname"><em>fi</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 생성 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>생성할 파일 경로 </td></tr>
    <tr><td class="paramname">mode</td><td>생성 모드 (퍼미션) </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일 생성</p>
<p>지정된 경로에 새 파일을 생성하고 상위 디렉터리에 디렉터리 엔트리를 추가한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>생성할 파일 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">mode</td><td>파일 모드 및 권한 (하위 12비트 사용) </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 (사용되지 않음) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 일반 파일로 설정</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00608">608</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  609</span>                                         {</div>
<div class="line"><span class="lineno">  610</span>  (void)fi;</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>  uint32_t dummy;</div>
<div class="line"><span class="lineno">  613</span>  <span class="comment">/* 이미 존재하면 실패 */</span></div>
<div class="line"><span class="lineno">  614</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;dummy) == 0) {</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">return</span> -EEXIST;</div>
<div class="line"><span class="lineno">  616</span>  }</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>  <span class="comment">/* 상위 디렉터리와 새 파일 이름 분리 */</span></div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordtype">char</span> *path_copy = strdup(path);</div>
<div class="line"><span class="lineno">  620</span>  <span class="keywordflow">if</span> (!path_copy)</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">  622</span>  <span class="keywordtype">char</span> *name = strrchr(path_copy, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  623</span>  <span class="keywordflow">if</span> (!name || *(name + 1) == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno">  624</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><span class="lineno">  626</span>  }</div>
<div class="line"><span class="lineno">  627</span>  *name = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  628</span>  <span class="keywordtype">char</span> *parent_path = (*path_copy == <span class="charliteral">&#39;\0&#39;</span>) ? <span class="stringliteral">&quot;/&quot;</span> : path_copy;</div>
<div class="line"><span class="lineno">  629</span>  name++;</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  <span class="comment">/* 상위 디렉터리 inode 찾기 */</span></div>
<div class="line"><span class="lineno">  632</span>  uint32_t parent_ino;</div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, parent_path, &amp;parent_ino) &lt; 0) {</div>
<div class="line"><span class="lineno">  634</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  636</span>  }</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> parent_inode;</div>
<div class="line"><span class="lineno">  639</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  640</span>  <span class="comment">/* 상위가 디렉터리인지 확인 */</span></div>
<div class="line"><span class="lineno">  641</span>  <span class="keywordflow">if</span> ((parent_inode.mode &amp; S_IFDIR) == 0) {</div>
<div class="line"><span class="lineno">  642</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordflow">return</span> -ENOTDIR;</div>
<div class="line"><span class="lineno">  644</span>  }</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  <span class="comment">/* 새 아이노드 할당 */</span></div>
<div class="line"><span class="lineno">  647</span>  <span class="keywordtype">int</span> new_ino = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a08b712b2489ab7b3346f82316300c6b3">alloc_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>);</div>
<div class="line"><span class="lineno">  648</span>  <span class="keywordflow">if</span> (new_ino &lt; 0) {</div>
<div class="line"><span class="lineno">  649</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">return</span> new_ino;</div>
<div class="line"><span class="lineno">  651</span>  }</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>  <span class="comment">/* 새 아이노드 초기화 */</span></div>
<div class="line"><span class="lineno">  654</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> new_inode;</div>
<div class="line"><span class="lineno">  655</span>  memset(&amp;new_inode, 0, <span class="keyword">sizeof</span>(new_inode));</div>
<div class="line"><span class="lineno">  656</span>  new_inode.mode = (<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a399b204af355418f3faa7cde72389973">mode</a> &amp; 0xFFF) | S_IFREG; </div>
<div class="line"><span class="lineno">  657</span>  new_inode.uid = getuid();</div>
<div class="line"><span class="lineno">  658</span>  new_inode.gid = getgid();</div>
<div class="line"><span class="lineno">  659</span>  new_inode.size = 0;</div>
<div class="line"><span class="lineno">  660</span>  time_t now = time(NULL);</div>
<div class="line"><span class="lineno">  661</span>  new_inode.atime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  662</span>  new_inode.mtime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  663</span>  new_inode.ctime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>  <span class="comment">/* 상위 디렉터리에 엔트리 추가 */</span></div>
<div class="line"><span class="lineno">  666</span>  uint8_t dir_block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordtype">bool</span> added = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  668</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 12 &amp;&amp; !added; ++i) {</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> (parent_inode.direct[i] == 0) {</div>
<div class="line"><span class="lineno">  670</span>      <span class="comment">/* 새 디렉터리 블록 할당 및 초기화 */</span></div>
<div class="line"><span class="lineno">  671</span>      <span class="keywordtype">int</span> new_dir_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  672</span>      <span class="keywordflow">if</span> (new_dir_block &lt; 0) {</div>
<div class="line"><span class="lineno">  673</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  674</span>        free(path_copy);</div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  676</span>      }</div>
<div class="line"><span class="lineno">  677</span>      parent_inode.direct[i] =</div>
<div class="line"><span class="lineno">  678</span>          fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> + (uint32_t)new_dir_block;</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>      memset(dir_block, 0, <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">  681</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)dir_block;</div>
<div class="line"><span class="lineno">  682</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = new_ino;</div>
<div class="line"><span class="lineno">  683</span>      strncpy(entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno">  684</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[<a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block);</div>
<div class="line"><span class="lineno">  687</span>      parent_inode.size += <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>;</div>
<div class="line"><span class="lineno">  688</span>      added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  689</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  690</span>      <span class="comment">/* 기존 블록에서 빈 슬롯 검색 */</span></div>
<div class="line"><span class="lineno">  691</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block) &lt; 0) {</div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  693</span>        free(path_copy);</div>
<div class="line"><span class="lineno">  694</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  695</span>      }</div>
<div class="line"><span class="lineno">  696</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)dir_block;</div>
<div class="line"><span class="lineno">  697</span>      <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno">  698</span>        <span class="keywordflow">if</span> (entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> == 0) {</div>
<div class="line"><span class="lineno">  699</span>          entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = new_ino;</div>
<div class="line"><span class="lineno">  700</span>          strncpy(entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno">  701</span>          entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[<a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  702</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block);</div>
<div class="line"><span class="lineno">  703</span>          added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  704</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  705</span>        }</div>
<div class="line"><span class="lineno">  706</span>      }</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>  }</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>  <span class="keywordflow">if</span> (!added) {</div>
<div class="line"><span class="lineno">  711</span>    <span class="comment">/* 공간 부족 시 롤백 */</span></div>
<div class="line"><span class="lineno">  712</span>    <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  713</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  715</span>  }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>  <span class="comment">/* 새 아이노드를 디스크에 기록 */</span></div>
<div class="line"><span class="lineno">  718</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, new_ino, &amp;new_inode);</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>  <span class="comment">/* 상위 디렉터리 메타데이터 갱신 */</span></div>
<div class="line"><span class="lineno">  721</span>  parent_inode.mtime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  722</span>  parent_inode.ctime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  723</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>  free(path_copy);</div>
<div class="line"><span class="lineno">  726</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  727</span>}</div>
<div class="ttc" id="abitmap_8h_html_a08b712b2489ab7b3346f82316300c6b3"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a08b712b2489ab7b3346f82316300c6b3">alloc_inode</a></div><div class="ttdeci">int alloc_inode(struct sfuse_superblock *sb, struct sfuse_inode_bitmap *imap)</div><div class="ttdoc">슈퍼블록 기반으로 아이노드 할당</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00095">bitmap.c:95</a></div></div>
<div class="ttc" id="abitmap_8h_html_a156ed842116a648997c737d182b7416a"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a></div><div class="ttdeci">void free_inode(struct sfuse_superblock *sb, struct sfuse_inode_bitmap *imap, uint32_t ino)</div><div class="ttdoc">슈퍼블록 기반으로 아이노드 해제</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00109">bitmap.c:109</a></div></div>
<div class="ttc" id="abitmap_8h_html_a7342a6b6280af158749416ff1fffadfc"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a></div><div class="ttdeci">int alloc_block(struct sfuse_superblock *sb, struct sfuse_block_bitmap *bmap)</div><div class="ttdoc">슈퍼블록 기반으로 데이터 블록 할당</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00121">bitmap.c:121</a></div></div>
<div class="ttc" id="ablock_8h_html_a737beb05c598c11278e8b17146b48dcf"><div class="ttname"><a href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a></div><div class="ttdeci">ssize_t read_block(int fd, uint32_t blk, void *out_buf)</div><div class="ttdoc">지정한 블록 번호의 데이터를 읽어 버퍼에 저장</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d1c/block_8c_source.html#l00015">block.c:15</a></div></div>
<div class="ttc" id="ablock_8h_html_af4beb38783113f42a845b7702ebaa8d5"><div class="ttname"><a href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a></div><div class="ttdeci">ssize_t write_block(int fd, uint32_t blk, const void *buf)</div><div class="ttdoc">버퍼의 내용을 지정한 블록 번호에 기록</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d1c/block_8c_source.html#l00031">block.c:31</a></div></div>
<div class="ttc" id="adir_8h_html_a309b8658c2817a5c55a08445e9760743"><div class="ttname"><a href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a></div><div class="ttdeci">#define SFUSE_NAME_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00010">dir.h:10</a></div></div>
<div class="ttc" id="adir_8h_html_aea073931da657513026982c1aac99b4d"><div class="ttname"><a href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a></div><div class="ttdeci">#define DENTS_PER_BLOCK</div><div class="ttdoc">한 블록당 디렉터리 엔트리 수</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00014">dir.h:14</a></div></div>
<div class="ttc" id="ainode_8h_html_a490b41738be882c224282cb0873c4185"><div class="ttname"><a href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a></div><div class="ttdeci">int inode_load(int fd, const struct sfuse_superblock *sb, uint32_t ino, struct sfuse_inode *out)</div><div class="ttdoc">디스크 이미지에서 아이노드를 읽어 구조체에 로드</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d2b/inode_8c_source.html#l00032">inode.c:32</a></div></div>
<div class="ttc" id="ainode_8h_html_abbb03a523d329cec86d9473e1a6ff70b"><div class="ttname"><a href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a></div><div class="ttdeci">int inode_sync(int fd, const struct sfuse_superblock *sb, uint32_t ino, const struct sfuse_inode *in)</div><div class="ttdoc">아이노드 구조체 내용을 디스크 이미지에 동기화</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d2b/inode_8c_source.html#l00051">inode.c:51</a></div></div>
<div class="ttc" id="astructsfuse__bitmaps_html_a9b626055d1a1c2f76698bd9723f0110f"><div class="ttname"><a href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">sfuse_bitmaps::block</a></div><div class="ttdeci">struct sfuse_block_bitmap block</div><div class="ttdef"><b>Definition</b> <a href="../../da/dcb/bitmap_8h_source.html#l00032">bitmap.h:32</a></div></div>
<div class="ttc" id="astructsfuse__bitmaps_html_ae875a8ba6b9ca19192fc23bef93c8adf"><div class="ttname"><a href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">sfuse_bitmaps::inode</a></div><div class="ttdeci">struct sfuse_inode_bitmap inode</div><div class="ttdef"><b>Definition</b> <a href="../../da/dcb/bitmap_8h_source.html#l00031">bitmap.h:31</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a></div><div class="ttdoc">디스크에 저장되는 디렉터리 엔트리 구조체</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00019">dir.h:19</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html_a73e74a2f27bfdd1383b6292beff30476"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">sfuse_dirent::inode</a></div><div class="ttdeci">uint32_t inode</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00020">dir.h:20</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html_a9b38e50447844882ddaaacb947f3d5dc"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">sfuse_dirent::name</a></div><div class="ttdeci">char name[256]</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00021">dir.h:21</a></div></div>
<div class="ttc" id="astructsfuse__fs_html_a188eaee1b599d1c0260a905a1c27c73d"><div class="ttname"><a href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">sfuse_fs::bmaps</a></div><div class="ttdeci">struct sfuse_bitmaps * bmaps</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00022">fs.h:22</a></div></div>
<div class="ttc" id="astructsfuse__fs_html_a86cd2ebfda2408f59d3260897c1a4866"><div class="ttname"><a href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sfuse_fs::sb</a></div><div class="ttdeci">struct sfuse_superblock sb</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00021">fs.h:21</a></div></div>
<div class="ttc" id="astructsfuse__fs_html_af14cab3f6994b0e91e858ddffc424140"><div class="ttname"><a href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">sfuse_fs::backing_fd</a></div><div class="ttdeci">int backing_fd</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00020">fs.h:20</a></div></div>
<div class="ttc" id="astructsfuse__inode_html"><div class="ttname"><a href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a></div><div class="ttdoc">디스크에 저장되는 아이노드 구조체</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00022">inode.h:22</a></div></div>
<div class="ttc" id="astructsfuse__inode_html_a399b204af355418f3faa7cde72389973"><div class="ttname"><a href="../../d2/d13/structsfuse__inode.html#a399b204af355418f3faa7cde72389973">sfuse_inode::mode</a></div><div class="ttdeci">uint32_t mode</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00023">inode.h:23</a></div></div>
<div class="ttc" id="astructsfuse__superblock_html_a85add9a4b064a3a048d7580e1ecd9a85"><div class="ttname"><a href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">sfuse_superblock::data_block_start</a></div><div class="ttdeci">uint32_t data_block_start</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00060">super.h:60</a></div></div>
<div class="ttc" id="asuper_8h_html_a0f31825083a6f1e0e2f5b5a2fd1181aa"><div class="ttname"><a href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a></div><div class="ttdeci">#define SFUSE_BLOCK_SIZE</div><div class="ttdoc">블록 크기 (바이트 단위)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00020">super.h:20</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_cgraph" id="adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_cgraph">
<area shape="rect" title="파일 생성" alt="" coords="5,185,87,213"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="150,5,244,33"/>
<area shape="poly" title=" " alt="" coords="50,184,78,118,102,79,133,44,138,39,142,44,137,48,106,82,83,121,54,186"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a08b712b2489ab7b3346f82316300c6b3" title="슈퍼블록 기반으로 아이노드 할당" alt="" coords="149,57,244,85"/>
<area shape="poly" title=" " alt="" coords="54,183,86,141,108,117,133,96,141,91,144,95,136,100,112,121,90,145,59,187"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a156ed842116a648997c737d182b7416a" title="슈퍼블록 기반으로 아이노드 해제" alt="" coords="152,109,242,137"/>
<area shape="poly" title=" " alt="" coords="74,182,153,142,155,147,77,187"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="135,261,259,289"/>
<area shape="poly" title=" " alt="" coords="77,211,155,251,153,256,74,216"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="445,264,538,292"/>
<area shape="poly" title=" " alt="" coords="57,212,86,257,109,280,136,298,174,312,213,319,254,322,295,321,371,310,435,294,436,299,372,315,295,326,254,328,213,325,172,317,133,303,106,285,82,261,52,215"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="445,212,538,240"/>
<area shape="poly" title=" " alt="" coords="87,199,430,220,430,225,87,204"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="444,160,539,188"/>
<area shape="poly" title=" " alt="" coords="87,194,428,175,429,180,87,200"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="149,363,245,390"/>
<area shape="poly" title=" " alt="" coords="55,212,85,273,108,310,137,343,149,352,146,357,133,346,104,313,80,276,50,214"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="314,32,390,60"/>
<area shape="poly" title=" " alt="" coords="245,25,299,34,298,39,244,30"/>
<area shape="poly" title=" " alt="" coords="245,61,297,52,298,57,246,66"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="316,109,387,137"/>
<area shape="poly" title=" " alt="" coords="243,120,301,120,301,126,243,126"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="307,261,396,289"/>
<area shape="poly" title=" " alt="" coords="260,272,291,272,291,278,260,278"/>
<area shape="poly" title=" " alt="" coords="397,273,430,274,430,279,397,279"/>
<area shape="poly" title=" " alt="" coords="392,258,435,243,437,248,394,263"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="587,212,689,240"/>
<area shape="poly" title=" " alt="" coords="532,261,582,243,584,248,534,266"/>
<area shape="poly" title=" " alt="" coords="534,186,584,204,582,209,532,191"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_icgraph" id="adf/d26/fs_8h_a6129288ed91728ed7ef053ad8d0cc79d_icgraph">
<area shape="rect" title="파일 생성" alt="" coords="490,5,572,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e" title="파일 생성 콜백" alt="" coords="316,5,442,33"/>
<area shape="poly" title=" " alt="" coords="474,22,443,22,443,16,474,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,269,22,269,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="afa59764091da583a569ad9e517043425" name="afa59764091da583a569ad9e517043425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa59764091da583a569ad9e517043425">&#9670;&#160;</a></span>fs_flush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_flush </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fuse_file_info *</td>          <td class="paramname"><span class="paramname"><em>fi</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FUSE에서 플러시 요청 처리 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 파일 경로 </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>FUSE에서 플러시 요청 처리</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 (사용되지 않음) </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 (사용되지 않음) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01340">1340</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1340</span>                                                                               {</div>
<div class="line"><span class="lineno"> 1341</span>  (void)path;</div>
<div class="line"><span class="lineno"> 1342</span>  (void)fi;</div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keywordflow">if</span> (fsync(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1344</span>    <span class="keywordflow">return</span> -errno;</div>
<div class="line"><span class="lineno"> 1345</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1346</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_afa59764091da583a569ad9e517043425_icgraph.png" border="0" usemap="#adf/d26/fs_8h_afa59764091da583a569ad9e517043425_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_afa59764091da583a569ad9e517043425_icgraph" id="adf/d26/fs_8h_afa59764091da583a569ad9e517043425_icgraph">
<area shape="rect" title="FUSE에서 플러시 요청 처리" alt="" coords="481,5,554,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#ae6af7e792b2c9c0e5b3f1d29d0d22925" title="flush 콜백" alt="" coords="316,5,433,33"/>
<area shape="poly" title=" " alt="" coords="466,22,434,22,434,16,466,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="301,22,269,22,269,16,301,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="ab503c5dc5cb6a0dc77f0b6d92bfccf5f" name="ab503c5dc5cb6a0dc77f0b6d92bfccf5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab503c5dc5cb6a0dc77f0b6d92bfccf5f">&#9670;&#160;</a></span>fs_fsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_fsync </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>datasync</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fuse_file_info *</td>          <td class="paramname"><span class="paramname"><em>fi</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FUSE에서 fsync 요청 처리 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 파일 경로 </td></tr>
    <tr><td class="paramname">datasync</td><td>데이터 sync 플래그 </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>FUSE에서 fsync 요청 처리</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 (사용되지 않음) </td></tr>
    <tr><td class="paramname">datasync</td><td>데이터만 동기화할지 여부 </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 (사용되지 않음) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01318">1318</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1319</span>                                        {</div>
<div class="line"><span class="lineno"> 1320</span>  (void)path;</div>
<div class="line"><span class="lineno"> 1321</span>  (void)fi;</div>
<div class="line"><span class="lineno"> 1322</span>  <span class="keywordflow">if</span> (datasync) {</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keywordflow">if</span> (fdatasync(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1324</span>      <span class="keywordflow">return</span> -errno;</div>
<div class="line"><span class="lineno"> 1325</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1326</span>    <span class="keywordflow">if</span> (fsync(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1327</span>      <span class="keywordflow">return</span> -errno;</div>
<div class="line"><span class="lineno"> 1328</span>  }</div>
<div class="line"><span class="lineno"> 1329</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1330</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_ab503c5dc5cb6a0dc77f0b6d92bfccf5f_icgraph.png" border="0" usemap="#adf/d26/fs_8h_ab503c5dc5cb6a0dc77f0b6d92bfccf5f_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_ab503c5dc5cb6a0dc77f0b6d92bfccf5f_icgraph" id="adf/d26/fs_8h_ab503c5dc5cb6a0dc77f0b6d92bfccf5f_icgraph">
<area shape="rect" title="FUSE에서 fsync 요청 처리" alt="" coords="484,5,560,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a1fddf11f9d0514cb1ba55bddd68e3d7f" title="fsync 콜백" alt="" coords="316,5,436,33"/>
<area shape="poly" title=" " alt="" coords="469,22,436,22,436,16,469,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,269,22,269,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a012d00e6eafc0bb7c9402e3f36cee00a" name="a012d00e6eafc0bb7c9402e3f36cee00a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012d00e6eafc0bb7c9402e3f36cee00a">&#9670;&#160;</a></span>fs_getattr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_getattr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *</td>          <td class="paramname"><span class="paramname"><em>stbuf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일/디렉터리 속성 조회 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 </td></tr>
    <tr><td class="paramname">stbuf</td><td>출력할 stat 구조체 포인터 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일/디렉터리 속성 조회</p>
<p>지정 경로의 inode를 조회하여 stat 구조체에 채움</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 문자열 </td></tr>
    <tr><td class="paramname">stbuf</td><td>속성 정보를 채울 stat 구조체 포인터 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00275">275</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>                                                                          {</div>
<div class="line"><span class="lineno">  276</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordtype">int</span> ret = <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino);</div>
<div class="line"><span class="lineno">  278</span>  <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">  282</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode) &lt; 0)</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>  <span class="comment">/* stat 구조체 초기화 및 채우기 */</span></div>
<div class="line"><span class="lineno">  286</span>  memset(stbuf, 0, <span class="keyword">sizeof</span>(*stbuf));</div>
<div class="line"><span class="lineno">  287</span>  stbuf-&gt;st_mode = inode.mode;</div>
<div class="line"><span class="lineno">  288</span>  stbuf-&gt;st_nlink = S_ISDIR(inode.mode) ? 2 : 1;</div>
<div class="line"><span class="lineno">  289</span>  stbuf-&gt;st_uid = inode.uid;</div>
<div class="line"><span class="lineno">  290</span>  stbuf-&gt;st_gid = inode.gid;</div>
<div class="line"><span class="lineno">  291</span>  stbuf-&gt;st_size = inode.size;</div>
<div class="line"><span class="lineno">  292</span>  stbuf-&gt;st_atime = inode.atime;</div>
<div class="line"><span class="lineno">  293</span>  stbuf-&gt;st_mtime = inode.mtime;</div>
<div class="line"><span class="lineno">  294</span>  stbuf-&gt;st_ctime = inode.ctime;</div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  296</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_cgraph" id="adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_cgraph">
<area shape="rect" title="파일/디렉터리 속성 조회" alt="" coords="5,32,90,60"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="138,7,262,34"/>
<area shape="poly" title=" " alt="" coords="90,36,122,31,123,36,91,41"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="447,57,540,85"/>
<area shape="poly" title=" " alt="" coords="90,46,432,65,432,70,90,51"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="310,7,399,34"/>
<area shape="poly" title=" " alt="" coords="263,18,294,18,294,23,263,23"/>
<area shape="poly" title=" " alt="" coords="396,32,440,49,438,54,394,37"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="447,5,540,33"/>
<area shape="poly" title=" " alt="" coords="400,17,432,17,432,22,400,23"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="588,57,690,85"/>
<area shape="poly" title=" " alt="" coords="540,68,572,68,572,74,540,74"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_icgraph" id="adf/d26/fs_8h_a012d00e6eafc0bb7c9402e3f36cee00a_icgraph">
<area shape="rect" title="파일/디렉터리 속성 조회" alt="" coords="493,5,578,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe" title="파일/디렉터리 속성 조회 콜백" alt="" coords="316,5,445,33"/>
<area shape="poly" title=" " alt="" coords="478,22,446,22,446,16,478,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a585a14f482e0d9dc375d2f10808be104" name="a585a14f482e0d9dc375d2f10808be104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585a14f482e0d9dc375d2f10808be104">&#9670;&#160;</a></span>fs_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> * fs_initialize </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>image_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>error_out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 시스템 초기화 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">image_path</td><td>디스크 이미지 파일 경로 </td></tr>
    <tr><td class="paramname">error_out</td><td>오류 코드를 저장할 포인터 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>초기화된 <a class="el" href="../../df/dc5/structsfuse__fs.html" title="SFUSE 파일 시스템 컨텍스트 구조체">sfuse_fs</a> 포인터 또는 NULL</dd></dl>
<p>디스크 이미지 파일을 열고 슈퍼블록, 비트맵, 아이노드 테이블을 메모리에 로드한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">image_path</td><td>디스크 이미지 파일 경로 </td></tr>
    <tr><td class="paramname">error_out</td><td>오류 코드를 저장할 포인터 (NULL이 아닌 경우에만 설정됨) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>초기화된 <a class="el" href="../../df/dc5/structsfuse__fs.html" title="SFUSE 파일 시스템 컨텍스트 구조체">sfuse_fs</a> 포인터, 실패 시 NULL (error_out에 오류 코드 설정) </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00106">106</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                                                       {</div>
<div class="line"><span class="lineno">  107</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *fs = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a>));</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">if</span> (!fs) {</div>
<div class="line"><span class="lineno">  109</span>    *error_out = ENOMEM;</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  111</span>  }</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="comment">/* 디스크 이미지 열기 */</span></div>
<div class="line"><span class="lineno">  114</span>  fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a> = open(image_path, O_RDWR);</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span> (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a> &lt; 0) {</div>
<div class="line"><span class="lineno">  116</span>    *error_out = errno;</div>
<div class="line"><span class="lineno">  117</span>    free(fs);</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  119</span>  }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="comment">/* 슈퍼블록 로드 */</span></div>
<div class="line"><span class="lineno">  122</span>  <span class="keywordtype">int</span> r = <a class="code hl_function" href="../../db/d98/super_8h.html#a027ca86e0fef4d81512d7af50f9b5bb6">sb_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>);</div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (r == -EINVAL &amp;&amp; <a class="code hl_variable" href="../../d2/d5a/fs_8c.html#a0771760ee8a223b01c598e70420cef0c">g_force_format</a>) {</div>
<div class="line"><span class="lineno">  125</span>      <span class="comment">/* 포맷되지 않았으면 자동 포맷 수행 */</span></div>
<div class="line"><span class="lineno">  126</span>      fprintf(stderr, <span class="stringliteral">&quot;SFUSE: 이미지 미포맷 감지, 자동 포맷 수행\n&quot;</span>);</div>
<div class="line"><span class="lineno">  127</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a36d02c17ab05553ae865cae9f1c85abc">fs_format_filesystem</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>) &lt; 0) {</div>
<div class="line"><span class="lineno">  128</span>        *error_out = EIO;</div>
<div class="line"><span class="lineno">  129</span>        close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  130</span>        free(fs);</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  132</span>      }</div>
<div class="line"><span class="lineno">  133</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  134</span>      <span class="comment">/* 기타 오류 */</span></div>
<div class="line"><span class="lineno">  135</span>      *error_out = (r == -EINVAL ? EINVAL : EIO);</div>
<div class="line"><span class="lineno">  136</span>      close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  137</span>      free(fs);</div>
<div class="line"><span class="lineno">  138</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span>  }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  <span class="comment">/* 비트맵 구조체 할당 */</span></div>
<div class="line"><span class="lineno">  143</span>  fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../d2/d35/structsfuse__bitmaps.html">sfuse_bitmaps</a>));</div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">if</span> (!fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>) {</div>
<div class="line"><span class="lineno">  145</span>    *error_out = ENOMEM;</div>
<div class="line"><span class="lineno">  146</span>    close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  147</span>    free(fs);</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  149</span>  }</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <span class="comment">/* 비트맵 블록 수 계산 및 로드 */</span></div>
<div class="line"><span class="lineno">  152</span>  uint32_t bits_per_block = <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> * 8;</div>
<div class="line"><span class="lineno">  153</span>  uint32_t im_blocks =</div>
<div class="line"><span class="lineno">  154</span>      (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a0b37cfe3235e397d42dddc21183f688b">total_inodes</a> + bits_per_block - 1) / bits_per_block;</div>
<div class="line"><span class="lineno">  155</span>  uint32_t bm_blocks =</div>
<div class="line"><span class="lineno">  156</span>      (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#af5c413e0bf39804304cad2b659941dd3">total_blocks</a> + bits_per_block - 1) / bits_per_block;</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a9862b8627755d4932e7383f8221159fc">bitmap_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#aa9f7184193bd49902350f37506e020f1">inode_bitmap_start</a>, fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>,</div>
<div class="line"><span class="lineno">  158</span>                  im_blocks + bm_blocks) &lt; 0) {</div>
<div class="line"><span class="lineno">  159</span>    *error_out = EIO;</div>
<div class="line"><span class="lineno">  160</span>    free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>);</div>
<div class="line"><span class="lineno">  161</span>    close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  162</span>    free(fs);</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  164</span>  }</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>  <span class="comment">/* 아이노드 테이블 블록 수 계산 및 메모리 할당 */</span></div>
<div class="line"><span class="lineno">  167</span>  uint32_t inode_blocks = (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a0b37cfe3235e397d42dddc21183f688b">total_inodes</a> + <a class="code hl_define" href="../../d3/d73/inode_8h.html#aea4db50e3f5dc442fde11ac9955ffeb4">SFUSE_INODES_PER_BLOCK</a> - 1) /</div>
<div class="line"><span class="lineno">  168</span>                          <a class="code hl_define" href="../../d3/d73/inode_8h.html#aea4db50e3f5dc442fde11ac9955ffeb4">SFUSE_INODES_PER_BLOCK</a>;</div>
<div class="line"><span class="lineno">  169</span>  fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">inode_table</a> = malloc(inode_blocks * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordflow">if</span> (!fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">inode_table</a>) {</div>
<div class="line"><span class="lineno">  171</span>    *error_out = ENOMEM;</div>
<div class="line"><span class="lineno">  172</span>    free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>);</div>
<div class="line"><span class="lineno">  173</span>    close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  174</span>    free(fs);</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  176</span>  }</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="comment">/* 아이노드 테이블 읽기 */</span></div>
<div class="line"><span class="lineno">  179</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; inode_blocks; ++i) {</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a30e81477038d68463e47e95a2a898c3c">inode_table_start</a> + i,</div>
<div class="line"><span class="lineno">  181</span>                   &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">inode_table</a>[i]) &lt; 0) {</div>
<div class="line"><span class="lineno">  182</span>      *error_out = EIO;</div>
<div class="line"><span class="lineno">  183</span>      free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">inode_table</a>);</div>
<div class="line"><span class="lineno">  184</span>      free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>);</div>
<div class="line"><span class="lineno">  185</span>      close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  186</span>      free(fs);</div>
<div class="line"><span class="lineno">  187</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  188</span>    }</div>
<div class="line"><span class="lineno">  189</span>  }</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  *error_out = 0;</div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">return</span> fs;</div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="abitmap_8h_html_a9862b8627755d4932e7383f8221159fc"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a9862b8627755d4932e7383f8221159fc">bitmap_load</a></div><div class="ttdeci">int bitmap_load(int fd, uint32_t start_blk, struct sfuse_bitmaps *bmaps, uint32_t count)</div><div class="ttdoc">비트맵을 디스크에서 읽어 메모리에 로드</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00021">bitmap.c:21</a></div></div>
<div class="ttc" id="afs_8c_html_a0771760ee8a223b01c598e70420cef0c"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a0771760ee8a223b01c598e70420cef0c">g_force_format</a></div><div class="ttdeci">bool g_force_format</div><div class="ttdoc">전역: 포맷 강제 여부 (-F 옵션)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d29/main_8c_source.html#l00012">main.c:12</a></div></div>
<div class="ttc" id="afs_8c_html_a36d02c17ab05553ae865cae9f1c85abc"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a36d02c17ab05553ae865cae9f1c85abc">fs_format_filesystem</a></div><div class="ttdeci">static int fs_format_filesystem(int fd, struct sfuse_superblock *sb)</div><div class="ttdoc">빈 이미지 파일을 VSFS 구조로 포맷</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00033">fs.c:33</a></div></div>
<div class="ttc" id="ainode_8h_html_aea4db50e3f5dc442fde11ac9955ffeb4"><div class="ttname"><a href="../../d3/d73/inode_8h.html#aea4db50e3f5dc442fde11ac9955ffeb4">SFUSE_INODES_PER_BLOCK</a></div><div class="ttdeci">#define SFUSE_INODES_PER_BLOCK</div><div class="ttdoc">한 블록에 담을 수 있는 아이노드 수</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00012">inode.h:12</a></div></div>
<div class="ttc" id="astructsfuse__bitmaps_html"><div class="ttname"><a href="../../d2/d35/structsfuse__bitmaps.html">sfuse_bitmaps</a></div><div class="ttdoc">아이노드 비트맵과 블록 비트맵을 함께 담는 구조체</div><div class="ttdef"><b>Definition</b> <a href="../../da/dcb/bitmap_8h_source.html#l00030">bitmap.h:30</a></div></div>
<div class="ttc" id="astructsfuse__fs_html"><div class="ttname"><a href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a></div><div class="ttdoc">SFUSE 파일 시스템 컨텍스트 구조체</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00019">fs.h:19</a></div></div>
<div class="ttc" id="astructsfuse__fs_html_a937ca2879e30e603bf5619adf8536ab5"><div class="ttname"><a href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">sfuse_fs::inode_table</a></div><div class="ttdeci">struct sfuse_inode_block * inode_table</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00023">fs.h:23</a></div></div>
<div class="ttc" id="astructsfuse__superblock_html_a0b37cfe3235e397d42dddc21183f688b"><div class="ttname"><a href="../../d7/d75/structsfuse__superblock.html#a0b37cfe3235e397d42dddc21183f688b">sfuse_superblock::total_inodes</a></div><div class="ttdeci">uint32_t total_inodes</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00053">super.h:53</a></div></div>
<div class="ttc" id="astructsfuse__superblock_html_a30e81477038d68463e47e95a2a898c3c"><div class="ttname"><a href="../../d7/d75/structsfuse__superblock.html#a30e81477038d68463e47e95a2a898c3c">sfuse_superblock::inode_table_start</a></div><div class="ttdeci">uint32_t inode_table_start</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00059">super.h:59</a></div></div>
<div class="ttc" id="astructsfuse__superblock_html_aa9f7184193bd49902350f37506e020f1"><div class="ttname"><a href="../../d7/d75/structsfuse__superblock.html#aa9f7184193bd49902350f37506e020f1">sfuse_superblock::inode_bitmap_start</a></div><div class="ttdeci">uint32_t inode_bitmap_start</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00057">super.h:57</a></div></div>
<div class="ttc" id="astructsfuse__superblock_html_af5c413e0bf39804304cad2b659941dd3"><div class="ttname"><a href="../../d7/d75/structsfuse__superblock.html#af5c413e0bf39804304cad2b659941dd3">sfuse_superblock::total_blocks</a></div><div class="ttdeci">uint32_t total_blocks</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00054">super.h:54</a></div></div>
<div class="ttc" id="asuper_8h_html_a027ca86e0fef4d81512d7af50f9b5bb6"><div class="ttname"><a href="../../db/d98/super_8h.html#a027ca86e0fef4d81512d7af50f9b5bb6">sb_load</a></div><div class="ttdeci">int sb_load(int fd, struct sfuse_superblock *sb_out)</div><div class="ttdoc">슈퍼블록을 디스크에서 읽어 로드</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d1d/super_8c_source.html#l00018">super.c:18</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_cgraph" id="adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_cgraph">
<area shape="rect" title="파일 시스템 초기화" alt="" coords="5,81,102,109"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9862b8627755d4932e7383f8221159fc" title="비트맵을 디스크에서 읽어 메모리에 로드" alt="" coords="179,5,281,33"/>
<area shape="poly" title=" " alt="" coords="84,78,149,49,177,37,179,42,151,54,86,83"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="359,31,451,58"/>
<area shape="poly" title=" " alt="" coords="102,86,343,51,344,56,103,91"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a36d02c17ab05553ae865cae9f1c85abc" title="빈 이미지 파일을 VSFS 구조로 포맷" alt="" coords="150,107,310,134"/>
<area shape="poly" title=" " alt="" coords="103,99,134,104,134,109,102,105"/>
<area shape="rect" href="../../d2/d1d/super_8c.html#a027ca86e0fef4d81512d7af50f9b5bb6" title="슈퍼블록을 디스크에서 읽어 로드" alt="" coords="194,159,266,186"/>
<area shape="poly" title=" " alt="" coords="80,107,151,143,181,155,179,160,149,148,78,112"/>
<area shape="poly" title=" " alt="" coords="282,24,344,33,343,38,281,29"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="358,107,452,134"/>
<area shape="poly" title=" " alt="" coords="310,118,342,118,342,123,310,123"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="500,107,603,134"/>
<area shape="poly" title=" " alt="" coords="453,118,485,118,485,123,453,123"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_icgraph" id="adf/d26/fs_8h_a585a14f482e0d9dc375d2f10808be104_icgraph">
<area shape="rect" title="파일 시스템 초기화" alt="" coords="108,5,204,33"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a0e6c18058ed432a1b33962e1f7fda11f" name="a0e6c18058ed432a1b33962e1f7fda11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e6c18058ed432a1b33962e1f7fda11f">&#9670;&#160;</a></span>fs_mkdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_mkdir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리 생성 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>생성할 디렉터리 경로 </td></tr>
    <tr><td class="paramname">mode</td><td>생성 모드 (퍼미션) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>디렉터리 생성</p>
<p>지정된 경로에 새 디렉터리를 생성하고 상위 디렉터리에 디렉터리 엔트리를 추가한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>생성할 디렉터리 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">mode</td><td>디렉터리 모드 및 권한 (하위 12비트 사용) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 디렉터리 타입 설정</p>
<p>&lt; 첫 엔트리에 새 inode 설정</p>
<p>&lt; 디렉터리 크기 갱신</p>
<p>&lt; 빈 슬롯에 inode 설정</p>
<p>&lt; 수정 시간 갱신</p>
<p>&lt; 변경 시간 갱신</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00740">740</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  740</span>                                                                 {</div>
<div class="line"><span class="lineno">  741</span>  uint32_t dummy;</div>
<div class="line"><span class="lineno">  742</span>  <span class="comment">/* 이미 존재하면 실패 */</span></div>
<div class="line"><span class="lineno">  743</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;dummy) == 0) {</div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordflow">return</span> -EEXIST;</div>
<div class="line"><span class="lineno">  745</span>  }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="comment">/* 상위 디렉터리와 새 이름 분리 */</span></div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordtype">char</span> *path_copy = strdup(path);</div>
<div class="line"><span class="lineno">  749</span>  <span class="keywordflow">if</span> (!path_copy)</div>
<div class="line"><span class="lineno">  750</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">  751</span>  <span class="keywordtype">char</span> *name = strrchr(path_copy, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  752</span>  <span class="keywordflow">if</span> (!name || *(name + 1) == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno">  753</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><span class="lineno">  755</span>  }</div>
<div class="line"><span class="lineno">  756</span>  *name = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  757</span>  <span class="keywordtype">char</span> *parent_path = (*path_copy == <span class="charliteral">&#39;\0&#39;</span>) ? <span class="stringliteral">&quot;/&quot;</span> : path_copy;</div>
<div class="line"><span class="lineno">  758</span>  name++;</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>  <span class="comment">/* 상위 디렉터리 inode 조회 */</span></div>
<div class="line"><span class="lineno">  761</span>  uint32_t parent_ino;</div>
<div class="line"><span class="lineno">  762</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, parent_path, &amp;parent_ino) &lt; 0) {</div>
<div class="line"><span class="lineno">  763</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  765</span>  }</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> parent_inode;</div>
<div class="line"><span class="lineno">  768</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  769</span>  <span class="comment">/* 상위가 디렉터리가 아니면 오류 */</span></div>
<div class="line"><span class="lineno">  770</span>  <span class="keywordflow">if</span> ((parent_inode.mode &amp; S_IFDIR) == 0) {</div>
<div class="line"><span class="lineno">  771</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  772</span>    <span class="keywordflow">return</span> -ENOTDIR;</div>
<div class="line"><span class="lineno">  773</span>  }</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>  <span class="comment">/* 새 아이노드 할당 */</span></div>
<div class="line"><span class="lineno">  776</span>  <span class="keywordtype">int</span> new_ino = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a08b712b2489ab7b3346f82316300c6b3">alloc_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>);</div>
<div class="line"><span class="lineno">  777</span>  <span class="keywordflow">if</span> (new_ino &lt; 0) {</div>
<div class="line"><span class="lineno">  778</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">return</span> new_ino;</div>
<div class="line"><span class="lineno">  780</span>  }</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>  <span class="comment">/* 새 아이노드 초기화 */</span></div>
<div class="line"><span class="lineno">  783</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> new_inode;</div>
<div class="line"><span class="lineno">  784</span>  memset(&amp;new_inode, 0, <span class="keyword">sizeof</span>(new_inode));</div>
<div class="line"><span class="lineno">  785</span>  new_inode.mode = (<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a399b204af355418f3faa7cde72389973">mode</a> &amp; 0xFFF) | S_IFDIR; </div>
<div class="line"><span class="lineno">  786</span>  new_inode.uid = getuid();</div>
<div class="line"><span class="lineno">  787</span>  new_inode.gid = getgid();</div>
<div class="line"><span class="lineno">  788</span>  new_inode.size = 0;</div>
<div class="line"><span class="lineno">  789</span>  time_t now = time(NULL);</div>
<div class="line"><span class="lineno">  790</span>  new_inode.atime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  791</span>  new_inode.mtime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  792</span>  new_inode.ctime = (uint32_t)now;</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>  <span class="comment">/* 상위 디렉터리에 엔트리 추가 (메모리 안전성: 블록 전체 초기화) */</span></div>
<div class="line"><span class="lineno">  795</span>  uint8_t dir_block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno">  796</span>  <span class="keywordtype">bool</span> added = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  797</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 12 &amp;&amp; !added; ++i) {</div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordflow">if</span> (parent_inode.direct[i] == 0) {</div>
<div class="line"><span class="lineno">  799</span>      <span class="comment">/* 새 디렉터리 블록 할당 */</span></div>
<div class="line"><span class="lineno">  800</span>      <span class="keywordtype">int</span> new_dir_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  801</span>      <span class="keywordflow">if</span> (new_dir_block &lt; 0) {</div>
<div class="line"><span class="lineno">  802</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  803</span>        free(path_copy);</div>
<div class="line"><span class="lineno">  804</span>        <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  805</span>      }</div>
<div class="line"><span class="lineno">  806</span>      parent_inode.direct[i] =</div>
<div class="line"><span class="lineno">  807</span>          fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> + (uint32_t)new_dir_block;</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>      memset(dir_block, 0, <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">  810</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)dir_block;</div>
<div class="line"><span class="lineno">  811</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = new_ino; </div>
<div class="line"><span class="lineno">  812</span>      strncpy(entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno">  813</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[<a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block);</div>
<div class="line"><span class="lineno">  816</span>      parent_inode.size += <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno">  817</span>      added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  818</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  819</span>      <span class="comment">/* 기존 블록에서 빈 슬롯 검색 */</span></div>
<div class="line"><span class="lineno">  820</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block) &lt; 0) {</div>
<div class="line"><span class="lineno">  821</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  822</span>        free(path_copy);</div>
<div class="line"><span class="lineno">  823</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  824</span>      }</div>
<div class="line"><span class="lineno">  825</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)dir_block;</div>
<div class="line"><span class="lineno">  826</span>      <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">if</span> (entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> == 0) {</div>
<div class="line"><span class="lineno">  828</span>          entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = new_ino; </div>
<div class="line"><span class="lineno">  829</span>          strncpy(entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno">  830</span>          entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[<a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  831</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block);</div>
<div class="line"><span class="lineno">  832</span>          added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  833</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  834</span>        }</div>
<div class="line"><span class="lineno">  835</span>      }</div>
<div class="line"><span class="lineno">  836</span>    }</div>
<div class="line"><span class="lineno">  837</span>  }</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>  <span class="comment">/* 공간 부족 시 롤백 */</span></div>
<div class="line"><span class="lineno">  840</span>  <span class="keywordflow">if</span> (!added) {</div>
<div class="line"><span class="lineno">  841</span>    <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, new_ino);</div>
<div class="line"><span class="lineno">  842</span>    free(path_copy);</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  844</span>  }</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>  <span class="comment">/* 새 아이노드 디스크에 기록 */</span></div>
<div class="line"><span class="lineno">  847</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, new_ino, &amp;new_inode);</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>  <span class="comment">/* 상위 디렉터리 메타데이터 갱신 */</span></div>
<div class="line"><span class="lineno">  850</span>  parent_inode.mtime = (uint32_t)now; </div>
<div class="line"><span class="lineno">  851</span>  parent_inode.ctime = (uint32_t)now; </div>
<div class="line"><span class="lineno">  852</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>  free(path_copy);</div>
<div class="line"><span class="lineno">  855</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  856</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_cgraph" id="adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_cgraph">
<area shape="rect" title="디렉터리 생성" alt="" coords="5,185,84,213"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="147,5,241,33"/>
<area shape="poly" title=" " alt="" coords="48,184,76,118,99,79,130,44,135,39,139,44,134,48,104,82,80,121,53,186"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a08b712b2489ab7b3346f82316300c6b3" title="슈퍼블록 기반으로 아이노드 할당" alt="" coords="146,57,242,85"/>
<area shape="poly" title=" " alt="" coords="53,183,84,141,106,117,130,96,138,91,141,95,133,100,109,121,88,144,57,187"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a156ed842116a648997c737d182b7416a" title="슈퍼블록 기반으로 아이노드 해제" alt="" coords="149,109,239,137"/>
<area shape="poly" title=" " alt="" coords="73,182,150,142,153,147,75,187"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="132,261,256,289"/>
<area shape="poly" title=" " alt="" coords="75,211,153,251,150,256,73,216"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="442,264,535,292"/>
<area shape="poly" title=" " alt="" coords="55,212,84,257,106,280,133,298,171,312,210,320,251,322,292,321,368,310,432,294,433,299,369,316,292,327,251,328,210,325,169,317,130,303,103,285,80,261,50,215"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="442,212,535,240"/>
<area shape="poly" title=" " alt="" coords="84,199,427,220,426,225,84,204"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="441,160,536,188"/>
<area shape="poly" title=" " alt="" coords="84,194,425,175,426,180,84,200"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="146,363,242,390"/>
<area shape="poly" title=" " alt="" coords="53,212,82,273,105,310,134,343,146,352,143,357,130,346,101,313,78,276,49,214"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="310,32,387,60"/>
<area shape="poly" title=" " alt="" coords="242,25,296,34,295,39,241,30"/>
<area shape="poly" title=" " alt="" coords="242,61,294,52,295,57,243,66"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="313,109,384,137"/>
<area shape="poly" title=" " alt="" coords="240,120,298,120,298,126,240,126"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="304,261,393,289"/>
<area shape="poly" title=" " alt="" coords="257,272,288,272,288,278,257,278"/>
<area shape="poly" title=" " alt="" coords="394,273,427,274,427,279,394,279"/>
<area shape="poly" title=" " alt="" coords="389,258,432,243,434,248,391,263"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="584,212,686,240"/>
<area shape="poly" title=" " alt="" coords="529,261,579,243,581,248,531,266"/>
<area shape="poly" title=" " alt="" coords="531,186,581,204,579,209,529,191"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_icgraph" id="adf/d26/fs_8h_a0e6c18058ed432a1b33962e1f7fda11f_icgraph">
<area shape="rect" title="디렉터리 생성" alt="" coords="487,5,566,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f" title="디렉터리 생성 콜백" alt="" coords="316,5,439,33"/>
<area shape="poly" title=" " alt="" coords="472,22,440,22,440,16,472,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a9741976c80c2167280c9a0c3ff856d2d" name="a9741976c80c2167280c9a0c3ff856d2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9741976c80c2167280c9a0c3ff856d2d">&#9670;&#160;</a></span>fs_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct fuse_file_info *</td>          <td class="paramname"><span class="paramname"><em>fi</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 열기 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>파일 경로 </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일 열기</p>
<p>path가 유효한 파일인지 확인</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>열고자 하는 파일 경로 문자열 </td></tr>
    <tr><td class="paramname">fi</td><td>FUSE 파일 정보 구조체 (사용하지 않음) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 -ENOENT </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00328">328</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  328</span>                                                                              {</div>
<div class="line"><span class="lineno">  329</span>  (void)fi;</div>
<div class="line"><span class="lineno">  330</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0)</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  334</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_cgraph" id="adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_cgraph">
<area shape="rect" title="파일 열기" alt="" coords="5,32,78,60"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="126,32,250,60"/>
<area shape="poly" title=" " alt="" coords="78,43,110,43,110,48,78,48"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="298,32,387,60"/>
<area shape="poly" title=" " alt="" coords="251,43,282,43,282,48,251,48"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="435,5,528,33"/>
<area shape="poly" title=" " alt="" coords="387,35,419,28,421,34,388,40"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="435,57,528,85"/>
<area shape="poly" title=" " alt="" coords="388,51,420,57,420,63,387,57"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="576,5,678,33"/>
<area shape="poly" title=" " alt="" coords="528,16,560,16,560,22,528,22"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_icgraph" id="adf/d26/fs_8h_a9741976c80c2167280c9a0c3ff856d2d_icgraph">
<area shape="rect" title="파일 열기" alt="" coords="481,5,554,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135" title="파일 열기 콜백" alt="" coords="316,5,433,33"/>
<area shape="poly" title=" " alt="" coords="466,22,434,22,434,16,466,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="301,22,269,22,269,16,301,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a28b88e33bc2ea2e1f024968f35073824" name="a28b88e33bc2ea2e1f024968f35073824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28b88e33bc2ea2e1f024968f35073824">&#9670;&#160;</a></span>fs_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 읽기 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>파일 경로 </td></tr>
    <tr><td class="paramname">buf</td><td>읽은 데이터를 저장할 버퍼 </td></tr>
    <tr><td class="paramname">size</td><td>읽을 바이트 수 </td></tr>
    <tr><td class="paramname">offset</td><td>읽기 오프셋 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>읽은 바이트 수 또는 음수 오류 코드</dd></dl>
<p>지정된 경로의 파일 데이터를 읽어 사용자 버퍼에 복사한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>읽을 파일 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">buf</td><td>데이터를 저장할 사용자 버퍼 포인터 </td></tr>
    <tr><td class="paramname">size</td><td>요청한 읽기 크기 (바이트 단위) </td></tr>
    <tr><td class="paramname">offset</td><td>파일 내 시작 오프셋 (바이트 단위) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>읽은 바이트 수 (&gt;=0), 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 논리 블록 인덱스</p>
<p>&lt; 블록 내 오프셋</p>
<p>&lt; 이터레이션당 최대 읽기 바이트</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00348">348</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  349</span>                          {</div>
<div class="line"><span class="lineno">  350</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  351</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0)</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">  355</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode) &lt; 0)</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>  <span class="comment">/* 디렉터리는 읽을 수 없음 */</span></div>
<div class="line"><span class="lineno">  359</span>  <span class="keywordflow">if</span> ((inode.mode &amp; S_IFDIR) == S_IFDIR)</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">return</span> -EISDIR;</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  <span class="comment">/* 오프셋이 파일 크기를 넘으면 0 리턴 */</span></div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)offset &gt;= inode.size)</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>  <span class="comment">/* 요청 크기가 파일 끝을 넘으면 조정 */</span></div>
<div class="line"><span class="lineno">  367</span>  <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)offset + <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> &gt; inode.size)</div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> = inode.<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - offset;</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  <span class="keywordtype">size_t</span> bytes_read = 0;</div>
<div class="line"><span class="lineno">  371</span>  uint8_t block_buf[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>  <span class="comment">/* 필요한 블록을 반복해서 읽음 */</span></div>
<div class="line"><span class="lineno">  374</span>  <span class="keywordflow">while</span> (bytes_read &lt; <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a>) {</div>
<div class="line"><span class="lineno">  375</span>    uint32_t block_index =</div>
<div class="line"><span class="lineno">  376</span>        (offset + bytes_read) / <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno">  377</span>    uint32_t block_offset =</div>
<div class="line"><span class="lineno">  378</span>        (offset + bytes_read) % <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno">  379</span>    uint32_t to_read =</div>
<div class="line"><span class="lineno">  380</span>        <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> - block_offset; </div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">if</span> (to_read &gt; <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - bytes_read)</div>
<div class="line"><span class="lineno">  383</span>      to_read = <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - bytes_read;</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    uint32_t disk_block = 0;</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">/* 직접 블록 참조 */</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> (block_index &lt; 12U) {</div>
<div class="line"><span class="lineno">  389</span>      disk_block = inode.direct[block_index];</div>
<div class="line"><span class="lineno">  390</span>    }</div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">/* 단일 간접 블록 참조 */</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index &lt; 12U + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>) {</div>
<div class="line"><span class="lineno">  393</span>      <span class="keywordflow">if</span> (!inode.indirect)</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  395</span>      uint32_t ptrs[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  396</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs) &lt; 0)</div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  398</span>      disk_block = ptrs[block_index - 12U];</div>
<div class="line"><span class="lineno">  399</span>    }</div>
<div class="line"><span class="lineno">  400</span>    <span class="comment">/* 이중 간접 블록 참조 */</span></div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  402</span>      <span class="keywordflow">if</span> (!inode.double_indirect)</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  404</span>      uint32_t l1[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  405</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, l1) &lt; 0)</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  407</span>      uint32_t dbl_index = block_index - (12U + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>);</div>
<div class="line"><span class="lineno">  408</span>      uint32_t l1_idx = dbl_index / <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>;</div>
<div class="line"><span class="lineno">  409</span>      uint32_t l2_idx = dbl_index % <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>;</div>
<div class="line"><span class="lineno">  410</span>      <span class="keywordflow">if</span> (l1_idx &gt;= <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a> || l1[l1_idx] == 0)</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  412</span>      uint32_t l2[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  413</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[l1_idx], l2) &lt; 0)</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  415</span>      disk_block = l2[l2_idx];</div>
<div class="line"><span class="lineno">  416</span>    }</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="comment">/* 할당되지 않은 블록이면 0으로 채움 */</span></div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> (disk_block == 0) {</div>
<div class="line"><span class="lineno">  420</span>      memset(buf + bytes_read, 0, to_read);</div>
<div class="line"><span class="lineno">  421</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  422</span>      <span class="comment">/* 실제 디스크 읽기 */</span></div>
<div class="line"><span class="lineno">  423</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, disk_block, block_buf) &lt; 0)</div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  425</span>      memcpy(buf + bytes_read, block_buf + block_offset, to_read);</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span>    bytes_read += to_read;</div>
<div class="line"><span class="lineno">  428</span>  }</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>  <span class="keywordflow">return</span> bytes_read;</div>
<div class="line"><span class="lineno">  431</span>}</div>
<div class="ttc" id="ainode_8h_html_a113396e915a4441e2d49df4b7bb6d26c"><div class="ttname"><a href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a></div><div class="ttdeci">#define SFUSE_PTRS_PER_BLOCK</div><div class="ttdoc">한 블록에 담을 수 있는 포인터 수 (32-bit)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00017">inode.h:17</a></div></div>
<div class="ttc" id="astructsfuse__inode_html_a8f67762b0e63a291da0db528b627922c"><div class="ttname"><a href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">sfuse_inode::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00026">inode.h:26</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_cgraph" id="adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_cgraph">
<area shape="rect" title="파일 읽기" alt="" coords="5,43,75,70"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="123,43,247,70"/>
<area shape="poly" title=" " alt="" coords="75,54,107,54,107,59,75,59"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="432,5,525,33"/>
<area shape="poly" title=" " alt="" coords="75,41,122,29,202,19,281,14,417,14,417,19,282,19,202,24,123,34,76,46"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="432,69,525,97"/>
<area shape="poly" title=" " alt="" coords="76,67,123,79,202,88,282,90,417,86,417,91,282,95,202,93,122,84,75,72"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="295,43,384,70"/>
<area shape="poly" title=" " alt="" coords="248,54,279,54,279,59,248,59"/>
<area shape="poly" title=" " alt="" coords="384,42,417,33,418,38,386,47"/>
<area shape="poly" title=" " alt="" coords="385,62,418,69,416,74,384,68"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="573,5,675,33"/>
<area shape="poly" title=" " alt="" coords="525,16,557,16,557,22,525,22"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_icgraph" id="adf/d26/fs_8h_a28b88e33bc2ea2e1f024968f35073824_icgraph">
<area shape="rect" title="파일 읽기" alt="" coords="478,5,548,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7" title="파일 읽기 콜백" alt="" coords="316,5,430,33"/>
<area shape="poly" title=" " alt="" coords="463,22,431,22,431,16,463,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="addbb0f0d2e2d634975c40330e23bc8ae" name="addbb0f0d2e2d634975c40330e23bc8ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addbb0f0d2e2d634975c40330e23bc8ae">&#9670;&#160;</a></span>fs_readdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_readdir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fuse_fill_dir_t</td>          <td class="paramname"><span class="paramname"><em>filler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리 내용 읽기 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>디렉터리 경로 </td></tr>
    <tr><td class="paramname">buf</td><td>FUSE가 제공하는 버퍼 </td></tr>
    <tr><td class="paramname">filler</td><td>디렉터리 엔트리 추가 콜백 </td></tr>
    <tr><td class="paramname">offset</td><td>읽기 오프셋 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>디렉터리 내용 읽기</p>
<p>지정 경로의 디렉터리 엔트리를 FUSE callback에 전달</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>디렉터리 경로 문자열 </td></tr>
    <tr><td class="paramname">buf</td><td>FUSE가 제공하는 버퍼 포인터 </td></tr>
    <tr><td class="paramname">filler</td><td>FUSE 디렉터리 엔트리 추가 콜백 </td></tr>
    <tr><td class="paramname">offset</td><td>읽기 시작 오프셋 (사용되지 않음) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00310">310</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>                                                     {</div>
<div class="line"><span class="lineno">  312</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  313</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0)</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  315</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="../../df/d9c/dir_8h.html#aca2f1f6050fc83a31ced84d12a96b4cb">dir_list</a>(fs, ino, buf, filler, offset);</div>
<div class="line"><span class="lineno">  316</span>}</div>
<div class="ttc" id="adir_8h_html_aca2f1f6050fc83a31ced84d12a96b4cb"><div class="ttname"><a href="../../df/d9c/dir_8h.html#aca2f1f6050fc83a31ced84d12a96b4cb">dir_list</a></div><div class="ttdeci">int dir_list(const struct sfuse_fs *fs, uint32_t dir_ino, void *buf, fuse_fill_dir_t filler, off_t offset)</div><div class="ttdoc">FUSE용 디렉터리 목록 채우기 콜백 호출</div><div class="ttdef"><b>Definition</b> <a href="../../de/d32/dir_8c_source.html#l00058">dir.c:58</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_cgraph.png" border="0" usemap="#adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_cgraph" id="adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_cgraph">
<area shape="rect" title="디렉터리 내용 읽기" alt="" coords="5,32,92,60"/>
<area shape="rect" href="../../de/d32/dir_8c.html#aca2f1f6050fc83a31ced84d12a96b4cb" title="FUSE용 디렉터리 목록 채우기 콜백 호출" alt="" coords="324,5,389,33"/>
<area shape="poly" title=" " alt="" coords="92,39,308,21,309,26,93,45"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="140,57,264,85"/>
<area shape="poly" title=" " alt="" coords="93,50,125,56,124,61,92,56"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="449,5,542,33"/>
<area shape="poly" title=" " alt="" coords="390,16,434,16,434,22,390,22"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="449,57,542,85"/>
<area shape="poly" title=" " alt="" coords="391,29,443,49,441,54,389,34"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="590,5,692,33"/>
<area shape="poly" title=" " alt="" coords="542,16,574,16,574,22,542,22"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="312,57,401,85"/>
<area shape="poly" title=" " alt="" coords="265,68,296,68,296,74,265,74"/>
<area shape="poly" title=" " alt="" coords="395,54,441,37,443,42,397,59"/>
<area shape="poly" title=" " alt="" coords="402,68,434,68,434,74,402,74"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_icgraph.png" border="0" usemap="#adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_icgraph" id="adf/d26/fs_8h_addbb0f0d2e2d634975c40330e23bc8ae_icgraph">
<area shape="rect" title="디렉터리 내용 읽기" alt="" coords="495,5,582,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad" title="디렉터리 목록 조회 콜백" alt="" coords="316,5,447,33"/>
<area shape="poly" title=" " alt="" coords="480,22,448,22,448,16,480,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="af677d22449626003a22868b28501f79a" name="af677d22449626003a22868b28501f79a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af677d22449626003a22868b28501f79a">&#9670;&#160;</a></span>fs_rename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_rename </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>to</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 또는 디렉터리 이름 변경 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">from</td><td>원본 경로 </td></tr>
    <tr><td class="paramname">to</td><td>대상 경로 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일 또는 디렉터리 이름 변경</p>
<p>지정된 경로의 엔트리를 원본 디렉터리에서 제거하고, 대상 디렉터리에 새 엔트리를 추가한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">from</td><td>원본 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">to</td><td>대상 경로 (null-terminated 문자열) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01049">1049</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1049</span>                                                                     {</div>
<div class="line"><span class="lineno"> 1050</span>  uint32_t src_ino;</div>
<div class="line"><span class="lineno"> 1051</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, from, &amp;src_ino) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1052</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1053</span>  }</div>
<div class="line"><span class="lineno"> 1054</span>  uint32_t dummy;</div>
<div class="line"><span class="lineno"> 1055</span>  <span class="comment">/* 대상이 이미 존재하면 실패 */</span></div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, to, &amp;dummy) == 0) {</div>
<div class="line"><span class="lineno"> 1057</span>    <span class="keywordflow">return</span> -EEXIST;</div>
<div class="line"><span class="lineno"> 1058</span>  }</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>  <span class="comment">/* 경로 복사 및 분할 */</span></div>
<div class="line"><span class="lineno"> 1061</span>  <span class="keywordtype">char</span> *from_copy = strdup(from);</div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordtype">char</span> *to_copy = strdup(to);</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keywordflow">if</span> (!from_copy || !to_copy) {</div>
<div class="line"><span class="lineno"> 1064</span>    free(from_copy);</div>
<div class="line"><span class="lineno"> 1065</span>    free(to_copy);</div>
<div class="line"><span class="lineno"> 1066</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno"> 1067</span>  }</div>
<div class="line"><span class="lineno"> 1068</span>  <span class="keywordtype">char</span> *from_name = strrchr(from_copy, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno"> 1069</span>  <span class="keywordtype">char</span> *to_name = strrchr(to_copy, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno"> 1070</span>  *from_name = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1071</span>  *to_name = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1072</span>  <span class="keywordtype">char</span> *from_parent_path = (*from_copy == <span class="charliteral">&#39;\0&#39;</span>) ? <span class="stringliteral">&quot;/&quot;</span> : from_copy;</div>
<div class="line"><span class="lineno"> 1073</span>  <span class="keywordtype">char</span> *to_parent_path = (*to_copy == <span class="charliteral">&#39;\0&#39;</span>) ? <span class="stringliteral">&quot;/&quot;</span> : to_copy;</div>
<div class="line"><span class="lineno"> 1074</span>  from_name++;</div>
<div class="line"><span class="lineno"> 1075</span>  to_name++;</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>  <span class="comment">/* 부모 디렉터리 inode 조회 */</span></div>
<div class="line"><span class="lineno"> 1078</span>  uint32_t from_parent_ino, to_parent_ino;</div>
<div class="line"><span class="lineno"> 1079</span>  <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, from_parent_path, &amp;from_parent_ino);</div>
<div class="line"><span class="lineno"> 1080</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, to_parent_path, &amp;to_parent_ino) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1081</span>    free(from_copy);</div>
<div class="line"><span class="lineno"> 1082</span>    free(to_copy);</div>
<div class="line"><span class="lineno"> 1083</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1084</span>  }</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> from_parent_inode, to_parent_inode;</div>
<div class="line"><span class="lineno"> 1087</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, from_parent_ino, &amp;from_parent_inode);</div>
<div class="line"><span class="lineno"> 1088</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, to_parent_ino, &amp;to_parent_inode);</div>
<div class="line"><span class="lineno"> 1089</span>  <span class="comment">/* 디렉터리 여부 확인 */</span></div>
<div class="line"><span class="lineno"> 1090</span>  <span class="keywordflow">if</span> ((from_parent_inode.mode &amp; S_IFDIR) == 0 ||</div>
<div class="line"><span class="lineno"> 1091</span>      (to_parent_inode.mode &amp; S_IFDIR) == 0) {</div>
<div class="line"><span class="lineno"> 1092</span>    free(from_copy);</div>
<div class="line"><span class="lineno"> 1093</span>    free(to_copy);</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">return</span> -ENOTDIR;</div>
<div class="line"><span class="lineno"> 1095</span>  }</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>  uint8_t buf_block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1098</span>  <span class="comment">/* 원본 부모 디렉터리에서 엔트리 제거 */</span></div>
<div class="line"><span class="lineno"> 1099</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 12U; ++i) {</div>
<div class="line"><span class="lineno"> 1100</span>    <span class="keywordflow">if</span> (from_parent_inode.direct[i] == 0)</div>
<div class="line"><span class="lineno"> 1101</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, from_parent_inode.direct[i], buf_block);</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)buf_block;</div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno"> 1105</span>      <span class="keywordflow">if</span> (entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> == src_ino &amp;&amp;</div>
<div class="line"><span class="lineno"> 1106</span>          strncmp(entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, from_name, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a>) == 0) {</div>
<div class="line"><span class="lineno"> 1107</span>        entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = 0;</div>
<div class="line"><span class="lineno"> 1108</span>        entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1109</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, from_parent_inode.direct[i], entries);</div>
<div class="line"><span class="lineno"> 1110</span>        <span class="keywordflow">goto</span> removed_src;</div>
<div class="line"><span class="lineno"> 1111</span>      }</div>
<div class="line"><span class="lineno"> 1112</span>    }</div>
<div class="line"><span class="lineno"> 1113</span>  }</div>
<div class="line"><span class="lineno"> 1114</span>removed_src:</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>  <span class="comment">/* 대상 부모 디렉터리에 엔트리 추가 */</span></div>
<div class="line"><span class="lineno"> 1117</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 12U; ++i) {</div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">if</span> (to_parent_inode.direct[i] == 0) {</div>
<div class="line"><span class="lineno"> 1119</span>      <span class="keywordtype">int</span> new_blk = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno"> 1120</span>      <span class="keywordflow">if</span> (new_blk &lt; 0)</div>
<div class="line"><span class="lineno"> 1121</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1122</span>      to_parent_inode.direct[i] = new_blk;</div>
<div class="line"><span class="lineno"> 1123</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)buf_block;</div>
<div class="line"><span class="lineno"> 1124</span>      memset(entries, 0, <span class="keyword">sizeof</span>(buf_block));</div>
<div class="line"><span class="lineno"> 1125</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = src_ino;</div>
<div class="line"><span class="lineno"> 1126</span>      strncpy(entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, to_name, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno"> 1127</span>      entries[0].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>[<a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1128</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, to_parent_inode.direct[i], entries);</div>
<div class="line"><span class="lineno"> 1129</span>      to_parent_inode.size += <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>;</div>
<div class="line"><span class="lineno"> 1130</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1131</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1132</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, to_parent_inode.direct[i], buf_block);</div>
<div class="line"><span class="lineno"> 1133</span>      <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)buf_block;</div>
<div class="line"><span class="lineno"> 1134</span>      <span class="keywordflow">for</span> (uint32_t k = 0; k &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++k) {</div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keywordflow">if</span> (entries[k].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> == 0) {</div>
<div class="line"><span class="lineno"> 1136</span>          entries[k].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> = src_ino;</div>
<div class="line"><span class="lineno"> 1137</span>          strncpy(entries[k].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, to_name, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a> - 1);</div>
<div class="line"><span class="lineno"> 1138</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, to_parent_inode.direct[i], entries);</div>
<div class="line"><span class="lineno"> 1139</span>          <span class="keywordflow">goto</span> added_dst;</div>
<div class="line"><span class="lineno"> 1140</span>        }</div>
<div class="line"><span class="lineno"> 1141</span>      }</div>
<div class="line"><span class="lineno"> 1142</span>    }</div>
<div class="line"><span class="lineno"> 1143</span>  }</div>
<div class="line"><span class="lineno"> 1144</span>added_dst:</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>  <span class="comment">/* 메타데이터 갱신 */</span></div>
<div class="line"><span class="lineno"> 1147</span>  time_t now_time = time(NULL);</div>
<div class="line"><span class="lineno"> 1148</span>  from_parent_inode.mtime = from_parent_inode.ctime = (uint32_t)now_time;</div>
<div class="line"><span class="lineno"> 1149</span>  to_parent_inode.mtime = to_parent_inode.ctime = (uint32_t)now_time;</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> src_inode;</div>
<div class="line"><span class="lineno"> 1152</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, src_ino, &amp;src_inode);</div>
<div class="line"><span class="lineno"> 1153</span>  src_inode.ctime = (uint32_t)now_time;</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, src_ino, &amp;src_inode);</div>
<div class="line"><span class="lineno"> 1156</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, from_parent_ino, &amp;from_parent_inode);</div>
<div class="line"><span class="lineno"> 1157</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, to_parent_ino, &amp;to_parent_inode);</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>  free(from_copy);</div>
<div class="line"><span class="lineno"> 1160</span>  free(to_copy);</div>
<div class="line"><span class="lineno"> 1161</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1162</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_af677d22449626003a22868b28501f79a_cgraph.png" border="0" usemap="#adf/d26/fs_8h_af677d22449626003a22868b28501f79a_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_af677d22449626003a22868b28501f79a_cgraph" id="adf/d26/fs_8h_af677d22449626003a22868b28501f79a_cgraph">
<area shape="rect" title="파일 또는 디렉터리 이름 변경" alt="" coords="5,133,96,161"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="159,5,253,33"/>
<area shape="poly" title=" " alt="" coords="61,131,95,93,142,50,160,39,163,43,145,55,99,97,65,135"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="144,159,268,186"/>
<area shape="poly" title=" " alt="" coords="96,152,129,157,128,162,96,157"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="458,160,551,188"/>
<area shape="poly" title=" " alt="" coords="72,159,105,179,144,195,218,210,276,212,335,206,410,195,442,189,443,194,411,200,336,211,276,217,217,215,143,200,103,184,70,164"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="458,108,551,136"/>
<area shape="poly" title=" " alt="" coords="96,142,443,123,443,128,96,147"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="316,57,410,85"/>
<area shape="poly" title=" " alt="" coords="76,130,107,115,143,101,224,82,300,73,301,78,225,87,144,106,109,119,78,135"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="158,260,254,288"/>
<area shape="poly" title=" " alt="" coords="65,160,99,198,145,240,161,250,158,254,142,244,95,202,61,163"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="325,5,401,33"/>
<area shape="poly" title=" " alt="" coords="254,16,310,16,310,22,254,22"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="318,159,408,186"/>
<area shape="poly" title=" " alt="" coords="268,170,303,170,303,175,268,175"/>
<area shape="poly" title=" " alt="" coords="408,170,443,171,443,176,408,176"/>
<area shape="poly" title=" " alt="" coords="403,156,449,139,450,144,405,161"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="599,109,701,137"/>
<area shape="poly" title=" " alt="" coords="545,157,593,140,595,145,547,162"/>
<area shape="poly" title=" " alt="" coords="411,73,551,94,587,102,585,107,550,99,410,78"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_af677d22449626003a22868b28501f79a_icgraph.png" border="0" usemap="#adf/d26/fs_8h_af677d22449626003a22868b28501f79a_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_af677d22449626003a22868b28501f79a_icgraph" id="adf/d26/fs_8h_af677d22449626003a22868b28501f79a_icgraph">
<area shape="rect" title="파일 또는 디렉터리 이름 변경" alt="" coords="499,5,590,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6886feb1b5bf1626b5b4ed7f14169edb" title="이름 변경 콜백" alt="" coords="316,5,451,33"/>
<area shape="poly" title=" " alt="" coords="483,22,452,22,452,16,483,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="301,22,268,22,268,16,301,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a8d5826ede78fcd2b76628eabb56e70db" name="a8d5826ede78fcd2b76628eabb56e70db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5826ede78fcd2b76628eabb56e70db">&#9670;&#160;</a></span>fs_resolve_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_resolve_path </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>out_ino</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>경로를 inode 번호로 변환 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>변환할 경로 문자열 </td></tr>
    <tr><td class="paramname">out_ino</td><td>변환된 inode 번호 저장 위치 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>경로를 inode 번호로 변환</p>
<p>루트("/")는 inode 1로 처리하며, 경로를 '/' 구분자로 분할하여 순차 검색</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>변환할 경로 문자열 (null-terminated) </td></tr>
    <tr><td class="paramname">out_ino</td><td>변환된 inode 번호를 저장할 포인터 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00236">236</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  236</span>                                                                              {</div>
<div class="line"><span class="lineno">  237</span>  <span class="keywordflow">if</span> (strcmp(path, <span class="stringliteral">&quot;/&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  238</span>    *out_ino = 1; <span class="comment">/* 루트 inode */</span></div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  240</span>  }</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>  <span class="comment">/* 경로 복사 및 분할 */</span></div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordtype">char</span> *path_copy = strdup(path);</div>
<div class="line"><span class="lineno">  244</span>  <span class="keywordflow">if</span> (!path_copy)</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  uint32_t current = 1; <span class="comment">/* 루트부터 시작 */</span></div>
<div class="line"><span class="lineno">  248</span>  <span class="keywordtype">char</span> *token = strtok(path_copy, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">while</span> (token) {</div>
<div class="line"><span class="lineno">  250</span>    uint32_t next;</div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordtype">int</span> ret = <a class="code hl_function" href="../../df/d9c/dir_8h.html#acd690811815cf7e33fb3ab6f8b95216e">dir_lookup</a>(fs, current, token, &amp;next);</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line"><span class="lineno">  253</span>      free(path_copy);</div>
<div class="line"><span class="lineno">  254</span>      <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  255</span>    }</div>
<div class="line"><span class="lineno">  256</span>    current = next;</div>
<div class="line"><span class="lineno">  257</span>    token = strtok(NULL, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno">  258</span>  }</div>
<div class="line"><span class="lineno">  259</span>  free(path_copy);</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  *out_ino = current;</div>
<div class="line"><span class="lineno">  262</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  263</span>}</div>
<div class="ttc" id="adir_8h_html_acd690811815cf7e33fb3ab6f8b95216e"><div class="ttname"><a href="../../df/d9c/dir_8h.html#acd690811815cf7e33fb3ab6f8b95216e">dir_lookup</a></div><div class="ttdeci">int dir_lookup(const struct sfuse_fs *fs, uint32_t dir_ino, const char *name, uint32_t *out_ino)</div><div class="ttdoc">디렉터리에서 이름으로 inode 번호를 검색</div><div class="ttdef"><b>Definition</b> <a href="../../de/d32/dir_8c_source.html#l00018">dir.c:18</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_cgraph" id="adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_cgraph">
<area shape="rect" title="경로를 inode 번호로 변환" alt="" coords="5,32,130,60"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="178,32,267,60"/>
<area shape="poly" title=" " alt="" coords="130,43,162,43,162,48,130,48"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="315,5,407,33"/>
<area shape="poly" title=" " alt="" coords="267,35,299,28,300,34,268,40"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="315,57,407,85"/>
<area shape="poly" title=" " alt="" coords="268,51,300,57,299,63,267,57"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="455,5,558,33"/>
<area shape="poly" title=" " alt="" coords="408,16,440,16,440,22,408,22"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_icgraph" id="adf/d26/fs_8h_a8d5826ede78fcd2b76628eabb56e70db_icgraph">
<area shape="rect" title="경로를 inode 번호로 변환" alt="" coords="831,317,955,345"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ae8816ea1bc016bed838b45345615d46c" title="접근 권한 검사" alt="" coords="694,5,778,33"/>
<area shape="poly" title=" " alt="" coords="885,303,874,250,854,183,823,112,804,78,781,48,767,36,770,31,785,44,808,76,828,110,859,182,879,249,890,301"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6129288ed91728ed7ef053ad8d0cc79d" title="파일 생성" alt="" coords="696,57,777,85"/>
<area shape="poly" title=" " alt="" coords="882,303,868,260,847,206,818,150,781,100,766,88,770,83,785,96,823,148,852,204,873,258,887,301"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a012d00e6eafc0bb7c9402e3f36cee00a" title="파일/디렉터리 속성 조회" alt="" coords="694,109,778,137"/>
<area shape="poly" title=" " alt="" coords="878,304,840,230,813,189,781,152,765,140,769,135,785,148,817,186,845,228,883,302"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a0e6c18058ed432a1b33962e1f7fda11f" title="디렉터리 생성" alt="" coords="697,161,776,189"/>
<area shape="poly" title=" " alt="" coords="872,306,833,256,781,204,764,192,767,187,785,200,837,253,876,303"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a9741976c80c2167280c9a0c3ff856d2d" title="파일 열기" alt="" coords="700,213,772,241"/>
<area shape="poly" title=" " alt="" coords="859,310,782,256,761,244,764,239,784,252,862,305"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a28b88e33bc2ea2e1f024968f35073824" title="파일 읽기" alt="" coords="702,265,771,293"/>
<area shape="poly" title=" " alt="" coords="834,314,771,293,772,288,835,309"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#addbb0f0d2e2d634975c40330e23bc8ae" title="디렉터리 내용 읽기" alt="" coords="693,317,780,345"/>
<area shape="poly" title=" " alt="" coords="815,334,780,334,780,328,815,328"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#af677d22449626003a22868b28501f79a" title="파일 또는 디렉터리 이름 변경" alt="" coords="691,369,782,397"/>
<area shape="poly" title=" " alt="" coords="836,353,781,371,780,366,834,348"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8cf3ec78e9108f22f73ac3ab974fe8dc" title="디렉터리 삭제" alt="" coords="535,419,610,446"/>
<area shape="poly" title=" " alt="" coords="868,357,830,386,784,411,739,424,692,432,611,436,611,431,691,427,737,419,782,406,827,382,864,353"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a7f3ad04cc17f3fb58519236a2ee996" title="파일 크기 조정 (truncate)" alt="" coords="525,523,620,550"/>
<area shape="poly" title=" " alt="" coords="886,361,872,396,851,438,822,479,784,512,744,531,701,541,658,545,620,544,620,539,658,539,700,536,742,526,782,508,818,475,846,435,867,394,881,359"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#add11b7953b7d14deb0456e14c8d7b197" title="파일 삭제" alt="" coords="696,471,776,498"/>
<area shape="poly" title=" " alt="" coords="873,359,834,405,785,455,762,472,758,468,781,450,830,401,869,356"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a818f99fae8ad5abcc450d41aac5d37ec" title="파일의 시간 속성 변경 (utimens)" alt="" coords="690,625,783,653"/>
<area shape="poly" title=" " alt="" coords="889,361,878,412,858,478,827,548,808,582,785,613,769,627,765,623,781,609,803,579,822,546,852,476,873,411,884,360"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#aecadaa463253df28c47f4a201dda2359" title="파일 쓰기" alt="" coords="700,572,773,600"/>
<area shape="poly" title=" " alt="" coords="885,361,849,453,820,506,785,556,764,574,761,570,781,552,816,503,844,450,880,359"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4" title="access 콜백" alt="" coords="321,5,450,33"/>
<area shape="poly" title=" " alt="" coords="679,22,451,22,451,16,679,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,316,268,344"/>
<area shape="poly" title=" " alt="" coords="323,44,318,48,289,80,265,117,228,195,205,266,194,316,189,315,200,265,223,193,260,114,285,77,314,44,319,39"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,316,60,344"/>
<area shape="poly" title=" " alt="" coords="92,332,60,332,60,327,92,327"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e" title="파일 생성 콜백" alt="" coords="322,57,449,85"/>
<area shape="poly" title=" " alt="" coords="680,74,449,74,449,68,680,68"/>
<area shape="poly" title=" " alt="" coords="324,95,318,100,293,125,270,154,234,217,210,275,196,316,191,315,205,273,230,214,266,151,289,122,314,96,320,91"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe" title="파일/디렉터리 속성 조회 콜백" alt="" coords="321,109,450,137"/>
<area shape="poly" title=" " alt="" coords="679,126,451,126,451,120,679,120"/>
<area shape="poly" title=" " alt="" coords="325,147,318,152,276,193,241,239,215,283,198,317,193,314,210,281,237,236,272,189,314,148,322,142"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f" title="디렉터리 생성 콜백" alt="" coords="324,161,447,189"/>
<area shape="poly" title=" " alt="" coords="682,178,447,178,447,172,682,172"/>
<area shape="poly" title=" " alt="" coords="327,199,317,204,281,232,249,263,202,317,198,314,245,259,278,228,315,200,324,194"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135" title="파일 열기 콜백" alt="" coords="327,213,444,241"/>
<area shape="poly" title=" " alt="" coords="685,230,445,230,445,224,685,224"/>
<area shape="poly" title=" " alt="" coords="331,250,317,256,259,288,212,318,209,313,257,283,315,251,329,245"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7" title="파일 읽기 콜백" alt="" coords="328,265,443,293"/>
<area shape="poly" title=" " alt="" coords="686,282,443,282,443,276,686,276"/>
<area shape="poly" title=" " alt="" coords="315,300,245,318,244,313,314,295"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad" title="디렉터리 목록 조회 콜백" alt="" coords="507,315,638,342"/>
<area shape="poly" title=" " alt="" coords="678,333,638,332,638,327,678,328"/>
<area shape="poly" title=" " alt="" coords="491,331,269,332,269,327,491,326"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6886feb1b5bf1626b5b4ed7f14169edb" title="이름 변경 콜백" alt="" coords="505,367,640,394"/>
<area shape="poly" title=" " alt="" coords="675,385,640,384,641,379,676,380"/>
<area shape="poly" title=" " alt="" coords="489,372,268,343,269,338,489,367"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title="디렉터리 삭제 콜백" alt="" coords="326,417,446,445"/>
<area shape="poly" title=" " alt="" coords="519,435,446,434,446,429,519,429"/>
<area shape="poly" title=" " alt="" coords="338,413,315,402,213,346,215,342,317,397,340,408"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f" title="파일 크기 변경 콜백" alt="" coords="316,521,455,549"/>
<area shape="poly" title=" " alt="" coords="509,539,456,538,456,533,509,533"/>
<area shape="poly" title=" " alt="" coords="332,516,314,504,274,463,239,419,194,345,199,343,243,416,278,460,318,500,335,511"/>
<area shape="poly" title=" " alt="" coords="681,470,610,447,611,442,682,465"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c" title="파일 삭제 콜백" alt="" coords="510,471,635,498"/>
<area shape="poly" title=" " alt="" coords="680,487,635,487,635,482,680,482"/>
<area shape="poly" title=" " alt="" coords="494,492,406,485,359,475,315,459,276,434,242,402,196,346,200,342,246,399,279,430,317,454,361,470,407,480,494,486"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9" title="파일/디렉터리 타임스탬프 갱신 콜백" alt="" coords="503,627,642,654"/>
<area shape="poly" title=" " alt="" coords="674,642,642,643,642,637,674,637"/>
<area shape="poly" title=" " alt="" coords="487,650,445,649,399,642,355,628,314,605,283,577,257,542,236,505,220,467,198,395,188,345,194,344,203,394,225,465,241,503,262,539,287,573,318,601,357,623,400,637,445,643,488,645"/>
<area shape="poly" title=" " alt="" coords="684,573,619,553,621,548,686,568"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59" title="파일 쓰기 콜백" alt="" coords="513,575,632,602"/>
<area shape="poly" title=" " alt="" coords="684,589,632,590,632,585,684,584"/>
<area shape="poly" title=" " alt="" coords="498,600,454,601,406,596,358,584,315,563,286,539,262,511,242,481,225,449,202,388,190,344,195,343,207,387,230,446,246,478,266,508,290,536,317,558,360,579,407,591,454,595,498,595"/>
</map>
</div>

</div>
</div>
<a id="a8cf3ec78e9108f22f73ac3ab974fe8dc" name="a8cf3ec78e9108f22f73ac3ab974fe8dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf3ec78e9108f22f73ac3ab974fe8dc">&#9670;&#160;</a></span>fs_rmdir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_rmdir </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리 삭제 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>삭제할 디렉터리 경로 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>디렉터리 삭제</p>
<p>지정된 경로의 디렉터리가 비어 있는지 확인한 후, fs_unlink 로직을 재사용하여 디렉터리를 제거한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>삭제할 디렉터리 경로 (null-terminated 문자열) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01001">1001</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1001</span>                                                    {</div>
<div class="line"><span class="lineno"> 1002</span>  uint32_t ino;</div>
<div class="line"><span class="lineno"> 1003</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1005</span>  }</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno"> 1008</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode);</div>
<div class="line"><span class="lineno"> 1009</span>  <span class="comment">/* 디렉터리인지 확인 */</span></div>
<div class="line"><span class="lineno"> 1010</span>  <span class="keywordflow">if</span> ((inode.mode &amp; S_IFDIR) == 0) {</div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keywordflow">return</span> -ENOTDIR;</div>
<div class="line"><span class="lineno"> 1012</span>  }</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>  <span class="comment">/* 비어 있는지 확인 */</span></div>
<div class="line"><span class="lineno"> 1015</span>  uint8_t block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1016</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 12; ++i) {</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">if</span> (inode.direct[i] == 0)</div>
<div class="line"><span class="lineno"> 1018</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.direct[i], block) &lt; 0)</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1021</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)block;</div>
<div class="line"><span class="lineno"> 1022</span>    <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno"> 1023</span>      <span class="keywordflow">if</span> (entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> != 0) {</div>
<div class="line"><span class="lineno"> 1024</span>        <span class="keywordflow">return</span> -ENOTEMPTY;</div>
<div class="line"><span class="lineno"> 1025</span>      }</div>
<div class="line"><span class="lineno"> 1026</span>    }</div>
<div class="line"><span class="lineno"> 1027</span>  }</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>  <span class="comment">/* fs_unlink 로직 재사용 */</span></div>
<div class="line"><span class="lineno"> 1030</span>  <span class="keywordtype">char</span> *dummy_path = strdup(path);</div>
<div class="line"><span class="lineno"> 1031</span>  <span class="keywordflow">if</span> (!dummy_path)</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno"> 1033</span>  <span class="keywordtype">int</span> res = <a class="code hl_function" href="../../d2/d5a/fs_8c.html#add11b7953b7d14deb0456e14c8d7b197">fs_unlink</a>(fs, path);</div>
<div class="line"><span class="lineno"> 1034</span>  free(dummy_path);</div>
<div class="line"><span class="lineno"> 1035</span>  <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1036</span>}</div>
<div class="ttc" id="afs_8c_html_add11b7953b7d14deb0456e14c8d7b197"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#add11b7953b7d14deb0456e14c8d7b197">fs_unlink</a></div><div class="ttdeci">int fs_unlink(struct sfuse_fs *fs, const char *path)</div><div class="ttdoc">파일 삭제</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00867">fs.c:867</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_cgraph" id="adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_cgraph">
<area shape="rect" title="디렉터리 삭제" alt="" coords="5,265,81,292"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="257,341,381,368"/>
<area shape="poly" title=" " alt="" coords="82,286,252,333,250,338,81,291"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="572,34,664,62"/>
<area shape="poly" title=" " alt="" coords="51,263,79,219,125,160,185,98,219,70,256,47,325,16,356,8,385,4,447,6,524,17,564,26,563,31,523,22,447,12,386,9,357,13,327,21,258,51,222,74,188,102,129,163,83,222,55,266"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="572,341,664,368"/>
<area shape="poly" title=" " alt="" coords="66,290,147,337,201,361,258,377,332,389,390,391,449,387,523,377,558,370,559,375,524,382,449,392,390,397,331,394,256,382,199,366,145,342,63,295"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#add11b7953b7d14deb0456e14c8d7b197" title="파일 삭제" alt="" coords="129,214,209,242"/>
<area shape="poly" title=" " alt="" coords="78,261,118,245,120,250,80,266"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="432,341,521,368"/>
<area shape="poly" title=" " alt="" coords="382,352,416,352,416,357,382,357"/>
<area shape="poly" title=" " alt="" coords="482,339,601,75,606,77,487,341"/>
<area shape="poly" title=" " alt="" coords="522,352,556,352,556,357,522,357"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="712,59,814,87"/>
<area shape="poly" title=" " alt="" coords="665,53,697,59,696,64,664,58"/>
<area shape="poly" title=" " alt="" coords="183,240,215,279,259,320,274,330,271,335,255,324,211,282,179,244"/>
<area shape="poly" title=" " alt="" coords="172,212,182,185,200,151,224,116,255,88,292,69,331,54,413,38,491,34,557,37,557,43,491,40,413,44,333,60,294,74,259,93,228,120,204,154,187,187,177,214"/>
<area shape="poly" title=" " alt="" coords="192,240,222,259,258,276,330,298,389,307,449,313,524,326,557,335,556,340,523,332,448,318,388,312,329,303,256,281,220,263,189,244"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad78edd18fe67d2ffa13fbc1fc89436c0" title="슈퍼블록 기반으로 데이터 블록 해제" alt="" coords="274,135,364,163"/>
<area shape="poly" title=" " alt="" coords="191,211,256,173,268,167,270,172,258,178,194,215"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a156ed842116a648997c737d182b7416a" title="슈퍼블록 기반으로 아이노드 해제" alt="" coords="274,187,364,215"/>
<area shape="poly" title=" " alt="" coords="209,218,258,209,259,214,210,223"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="429,85,524,112"/>
<area shape="poly" title=" " alt="" coords="175,212,205,166,228,141,256,121,295,105,336,96,414,91,414,96,337,101,296,110,258,126,232,145,210,169,180,215"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="271,239,367,267"/>
<area shape="poly" title=" " alt="" coords="210,232,256,240,255,245,209,237"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="441,162,512,190"/>
<area shape="poly" title=" " alt="" coords="365,154,426,164,425,170,364,159"/>
<area shape="poly" title=" " alt="" coords="364,191,425,181,426,186,365,196"/>
<area shape="poly" title=" " alt="" coords="524,92,697,76,697,81,524,97"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_icgraph" id="adf/d26/fs_8h_a8cf3ec78e9108f22f73ac3ab974fe8dc_icgraph">
<area shape="rect" title="디렉터리 삭제" alt="" coords="484,5,560,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title="디렉터리 삭제 콜백" alt="" coords="316,5,436,33"/>
<area shape="poly" title=" " alt="" coords="469,22,436,22,436,16,469,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,269,22,269,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a2bc3c75472b51af52b6e3bf1e4f17667" name="a2bc3c75472b51af52b6e3bf1e4f17667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc3c75472b51af52b6e3bf1e4f17667">&#9670;&#160;</a></span>fs_teardown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fs_teardown </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 시스템 정리 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>해제할 파일 시스템 컨텍스트</td></tr>
  </table>
  </dd>
</dl>
<p>파일 시스템 정리</p>
<p>슈퍼블록과 비트맵을 디스크에 동기화하고, 할당된 메모리 및 파일 디스크립터 정리</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>해제할 파일 시스템 컨텍스트 포인터 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00203">203</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>                                      {</div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">if</span> (!fs)</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">/* 슈퍼블록 동기화 */</span></div>
<div class="line"><span class="lineno">  208</span>  <a class="code hl_function" href="../../db/d98/super_8h.html#a6ec742f3d4baa9cae3ccba0efeec47dd">sb_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>);</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">/* 비트맵 동기화 */</span></div>
<div class="line"><span class="lineno">  211</span>  uint32_t bits_per_block = <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> * 8;</div>
<div class="line"><span class="lineno">  212</span>  uint32_t im_blocks =</div>
<div class="line"><span class="lineno">  213</span>      (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a0b37cfe3235e397d42dddc21183f688b">total_inodes</a> + bits_per_block - 1) / bits_per_block;</div>
<div class="line"><span class="lineno">  214</span>  uint32_t bm_blocks =</div>
<div class="line"><span class="lineno">  215</span>      (fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#af5c413e0bf39804304cad2b659941dd3">total_blocks</a> + bits_per_block - 1) / bits_per_block;</div>
<div class="line"><span class="lineno">  216</span>  <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a08e26f9ee07d1cd29ae89220513cc50a">bitmap_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#aa9f7184193bd49902350f37506e020f1">inode_bitmap_start</a>, fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>,</div>
<div class="line"><span class="lineno">  217</span>              im_blocks + bm_blocks);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">/* 메모리 및 파일 디스크립터 정리 */</span></div>
<div class="line"><span class="lineno">  220</span>  free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a937ca2879e30e603bf5619adf8536ab5">inode_table</a>);</div>
<div class="line"><span class="lineno">  221</span>  free(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>);</div>
<div class="line"><span class="lineno">  222</span>  close(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>);</div>
<div class="line"><span class="lineno">  223</span>  free(fs);</div>
<div class="line"><span class="lineno">  224</span>}</div>
<div class="ttc" id="abitmap_8h_html_a08e26f9ee07d1cd29ae89220513cc50a"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a08e26f9ee07d1cd29ae89220513cc50a">bitmap_sync</a></div><div class="ttdeci">int bitmap_sync(int fd, uint32_t start_blk, const struct sfuse_bitmaps *bmaps, uint32_t count)</div><div class="ttdoc">메모리 비트맵을 디스크에 동기화</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00040">bitmap.c:40</a></div></div>
<div class="ttc" id="asuper_8h_html_a6ec742f3d4baa9cae3ccba0efeec47dd"><div class="ttname"><a href="../../db/d98/super_8h.html#a6ec742f3d4baa9cae3ccba0efeec47dd">sb_sync</a></div><div class="ttdeci">int sb_sync(int fd, const struct sfuse_superblock *sb)</div><div class="ttdoc">슈퍼블록을 디스크에 동기화</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d1d/super_8c_source.html#l00040">super.c:40</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_cgraph" id="adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_cgraph">
<area shape="rect" title="파일 시스템 정리" alt="" coords="5,32,107,60"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a08e26f9ee07d1cd29ae89220513cc50a" title="메모리 비트맵을 디스크에 동기화" alt="" coords="155,5,259,33"/>
<area shape="poly" title=" " alt="" coords="107,34,139,28,140,34,108,40"/>
<area shape="rect" href="../../d2/d1d/super_8c.html#a6ec742f3d4baa9cae3ccba0efeec47dd" title="슈퍼블록을 디스크에 동기화" alt="" coords="170,57,244,85"/>
<area shape="poly" title=" " alt="" coords="108,52,155,60,154,65,107,57"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="307,5,403,33"/>
<area shape="poly" title=" " alt="" coords="260,16,291,16,291,22,260,22"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_icgraph" id="adf/d26/fs_8h_a2bc3c75472b51af52b6e3bf1e4f17667_icgraph">
<area shape="rect" title="파일 시스템 정리" alt="" coords="108,5,209,33"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="a6a7f3ad04cc17f3fb58519236a2ee996" name="a6a7f3ad04cc17f3fb58519236a2ee996"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a7f3ad04cc17f3fb58519236a2ee996">&#9670;&#160;</a></span>fs_truncate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_truncate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 크기 조정 (truncate) </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 파일 경로 </td></tr>
    <tr><td class="paramname">size</td><td>새로운 파일 크기 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일 크기 조정 (truncate)</p>
<p>지정된 경로의 파일 크기를 주어진 크기로 변경. 크기 축소 시 불필요한 데이터 블록을 해제하고, 크기 확장 시 필요한 경우 단일 바이트 쓰기를 통해 공간을 확보.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>대상 파일 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">size</td><td>새 파일 크기 (바이트 단위) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 유지할 블록 수</p>
<p>&lt; 기존 블록 수</p>
<p>&lt; 1차 인덱스</p>
<p>&lt; 2차 인덱스</p>
<p>&lt; 파일 크기 갱신</p>
<p>&lt; 수정 시간 갱신</p>
<p>&lt; 변경 시간 갱신</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01176">1176</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1176</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1177</span>  uint32_t ino;</div>
<div class="line"><span class="lineno"> 1178</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1179</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1180</span>  }</div>
<div class="line"><span class="lineno"> 1181</span> </div>
<div class="line"><span class="lineno"> 1182</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno"> 1183</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode);</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span>  <span class="comment">/* 디렉터리인 경우 오류 반환 */</span></div>
<div class="line"><span class="lineno"> 1186</span>  <span class="keywordflow">if</span> ((inode.mode &amp; S_IFDIR) == S_IFDIR) {</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordflow">return</span> -EISDIR;</div>
<div class="line"><span class="lineno"> 1188</span>  }</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>  off_t old_size = inode.size;</div>
<div class="line"><span class="lineno"> 1191</span>  <span class="comment">/* 변경할 크기가 동일하면 즉시 반환 */</span></div>
<div class="line"><span class="lineno"> 1192</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> == old_size) {</div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1194</span>  }</div>
<div class="line"><span class="lineno"> 1195</span>  <span class="comment">/* 크기 축소 */</span></div>
<div class="line"><span class="lineno"> 1196</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> &lt; old_size) {</div>
<div class="line"><span class="lineno"> 1197</span>    uint32_t keep_blocks =</div>
<div class="line"><span class="lineno"> 1198</span>        (<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> + <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> - 1) / <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno"> 1199</span>    uint32_t old_blocks = (old_size + <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> - 1) /</div>
<div class="line"><span class="lineno"> 1200</span>                          <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    <span class="comment">/* 축소되어야 할 블록 해제 */</span></div>
<div class="line"><span class="lineno"> 1203</span>    <span class="keywordflow">for</span> (uint32_t i = keep_blocks; i &lt; old_blocks; ++i) {</div>
<div class="line"><span class="lineno"> 1204</span>      <span class="keywordflow">if</span> (i &lt; 12) {</div>
<div class="line"><span class="lineno"> 1205</span>        <span class="keywordflow">if</span> (inode.direct[i] != 0) {</div>
<div class="line"><span class="lineno"> 1206</span>          <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, inode.direct[i]);</div>
<div class="line"><span class="lineno"> 1207</span>          inode.direct[i] = 0;</div>
<div class="line"><span class="lineno"> 1208</span>        }</div>
<div class="line"><span class="lineno"> 1209</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &lt; 12U + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>) {</div>
<div class="line"><span class="lineno"> 1210</span>        <span class="keywordflow">if</span> (inode.indirect != 0) {</div>
<div class="line"><span class="lineno"> 1211</span>          uint32_t ptrs[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1212</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs);</div>
<div class="line"><span class="lineno"> 1213</span>          <span class="keywordtype">int</span> idx = i - 12;</div>
<div class="line"><span class="lineno"> 1214</span>          <span class="keywordflow">if</span> (ptrs[idx] != 0) {</div>
<div class="line"><span class="lineno"> 1215</span>            <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, ptrs[idx]);</div>
<div class="line"><span class="lineno"> 1216</span>            ptrs[idx] = 0;</div>
<div class="line"><span class="lineno"> 1217</span>          }</div>
<div class="line"><span class="lineno"> 1218</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs);</div>
<div class="line"><span class="lineno"> 1219</span>        }</div>
<div class="line"><span class="lineno"> 1220</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1221</span>        <span class="keywordflow">if</span> (inode.double_indirect != 0) {</div>
<div class="line"><span class="lineno"> 1222</span>          uint32_t level1_arr[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1223</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, level1_arr);</div>
<div class="line"><span class="lineno"> 1224</span>          uint32_t idx = i - (12 + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>);</div>
<div class="line"><span class="lineno"> 1225</span>          uint32_t l1_idx = idx / <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; </div>
<div class="line"><span class="lineno"> 1226</span>          uint32_t l2_idx = idx % <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; </div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>          <span class="keywordflow">if</span> (level1_arr[l1_idx] != 0) {</div>
<div class="line"><span class="lineno"> 1229</span>            uint32_t level2_arr[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1230</span>            <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, level1_arr[l1_idx], level2_arr);</div>
<div class="line"><span class="lineno"> 1231</span>            <span class="keywordflow">if</span> (level2_arr[l2_idx] != 0) {</div>
<div class="line"><span class="lineno"> 1232</span>              <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, level2_arr[l2_idx]);</div>
<div class="line"><span class="lineno"> 1233</span>              level2_arr[l2_idx] = 0;</div>
<div class="line"><span class="lineno"> 1234</span>            }</div>
<div class="line"><span class="lineno"> 1235</span>            <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, level1_arr[l1_idx], level2_arr);</div>
<div class="line"><span class="lineno"> 1236</span>          }</div>
<div class="line"><span class="lineno"> 1237</span>        }</div>
<div class="line"><span class="lineno"> 1238</span>      }</div>
<div class="line"><span class="lineno"> 1239</span>    }</div>
<div class="line"><span class="lineno"> 1240</span> </div>
<div class="line"><span class="lineno"> 1241</span>    <span class="comment">/* 단일 간접 블록 전체가 비었는지 확인 후 해제 */</span></div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordflow">if</span> (inode.indirect != 0) {</div>
<div class="line"><span class="lineno"> 1243</span>      uint32_t ptrs[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1244</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs);</div>
<div class="line"><span class="lineno"> 1245</span>      <span class="keywordtype">int</span> all_empty = 1;</div>
<div class="line"><span class="lineno"> 1246</span>      <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno"> 1247</span>        <span class="keywordflow">if</span> (ptrs[j] != 0) {</div>
<div class="line"><span class="lineno"> 1248</span>          all_empty = 0;</div>
<div class="line"><span class="lineno"> 1249</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1250</span>        }</div>
<div class="line"><span class="lineno"> 1251</span>      }</div>
<div class="line"><span class="lineno"> 1252</span>      <span class="keywordflow">if</span> (all_empty) {</div>
<div class="line"><span class="lineno"> 1253</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, inode.indirect);</div>
<div class="line"><span class="lineno"> 1254</span>        inode.indirect = 0;</div>
<div class="line"><span class="lineno"> 1255</span>      }</div>
<div class="line"><span class="lineno"> 1256</span>    }</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>    <span class="comment">/* 이중 간접 블록 전체가 비었는지 확인 후 해제 */</span></div>
<div class="line"><span class="lineno"> 1259</span>    <span class="keywordflow">if</span> (inode.double_indirect != 0) {</div>
<div class="line"><span class="lineno"> 1260</span>      uint32_t level1[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1261</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, level1);</div>
<div class="line"><span class="lineno"> 1262</span>      <span class="keywordtype">int</span> all_l1_empty = 1;</div>
<div class="line"><span class="lineno"> 1263</span>      <span class="keywordflow">for</span> (uint32_t a = 0; a &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++a) {</div>
<div class="line"><span class="lineno"> 1264</span>        <span class="keywordflow">if</span> (level1[a] != 0) {</div>
<div class="line"><span class="lineno"> 1265</span>          uint32_t level2[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno"> 1266</span>          <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, level1[a], level2);</div>
<div class="line"><span class="lineno"> 1267</span>          <span class="keywordtype">int</span> all_l2_empty = 1;</div>
<div class="line"><span class="lineno"> 1268</span>          <span class="keywordflow">for</span> (uint32_t b = 0; b &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++b) {</div>
<div class="line"><span class="lineno"> 1269</span>            <span class="keywordflow">if</span> (level2[b] != 0) {</div>
<div class="line"><span class="lineno"> 1270</span>              all_l2_empty = 0;</div>
<div class="line"><span class="lineno"> 1271</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1272</span>            }</div>
<div class="line"><span class="lineno"> 1273</span>          }</div>
<div class="line"><span class="lineno"> 1274</span>          <span class="keywordflow">if</span> (all_l2_empty) {</div>
<div class="line"><span class="lineno"> 1275</span>            <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, level1[a]);</div>
<div class="line"><span class="lineno"> 1276</span>            level1[a] = 0;</div>
<div class="line"><span class="lineno"> 1277</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1278</span>            all_l1_empty = 0;</div>
<div class="line"><span class="lineno"> 1279</span>          }</div>
<div class="line"><span class="lineno"> 1280</span>        }</div>
<div class="line"><span class="lineno"> 1281</span>      }</div>
<div class="line"><span class="lineno"> 1282</span>      <span class="keywordflow">if</span> (all_l1_empty) {</div>
<div class="line"><span class="lineno"> 1283</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, inode.double_indirect);</div>
<div class="line"><span class="lineno"> 1284</span>        inode.double_indirect = 0;</div>
<div class="line"><span class="lineno"> 1285</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1286</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, level1);</div>
<div class="line"><span class="lineno"> 1287</span>      }</div>
<div class="line"><span class="lineno"> 1288</span>    }</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>    inode.size = <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a>; </div>
<div class="line"><span class="lineno"> 1291</span>  }</div>
<div class="line"><span class="lineno"> 1292</span>  <span class="comment">/* 크기 확장 */</span></div>
<div class="line"><span class="lineno"> 1293</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1294</span>    <span class="keywordtype">char</span> zero = 0;</div>
<div class="line"><span class="lineno"> 1295</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#aecadaa463253df28c47f4a201dda2359">fs_write</a>(fs, path, &amp;zero, 1, <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - 1) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1296</span>      <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno"> 1297</span>    }</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1299</span>  }</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>  <span class="comment">/* 시간 정보 갱신 및 동기화 */</span></div>
<div class="line"><span class="lineno"> 1302</span>  time_t now_time = time(NULL);</div>
<div class="line"><span class="lineno"> 1303</span>  inode.mtime = (uint32_t)now_time; </div>
<div class="line"><span class="lineno"> 1304</span>  inode.ctime = (uint32_t)now_time; </div>
<div class="line"><span class="lineno"> 1305</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode);</div>
<div class="line"><span class="lineno"> 1306</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1307</span>}</div>
<div class="ttc" id="abitmap_8h_html_ad78edd18fe67d2ffa13fbc1fc89436c0"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a></div><div class="ttdeci">void free_block(struct sfuse_superblock *sb, struct sfuse_block_bitmap *bmap, uint32_t blk)</div><div class="ttdoc">슈퍼블록 기반으로 데이터 블록 해제</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00135">bitmap.c:135</a></div></div>
<div class="ttc" id="afs_8c_html_aecadaa463253df28c47f4a201dda2359"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#aecadaa463253df28c47f4a201dda2359">fs_write</a></div><div class="ttdeci">int fs_write(struct sfuse_fs *fs, const char *path, const char *buf, size_t size, off_t offset)</div><div class="ttdoc">파일 쓰기</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00445">fs.c:445</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_cgraph" id="adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_cgraph">
<area shape="rect" title="파일 크기 조정 (truncate)" alt="" coords="5,235,100,262"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad78edd18fe67d2ffa13fbc1fc89436c0" title="슈퍼블록 기반으로 데이터 블록 해제" alt="" coords="148,7,237,34"/>
<area shape="poly" title=" " alt="" coords="55,233,86,152,112,100,146,51,154,42,158,46,150,54,117,102,91,154,60,235"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="285,311,409,338"/>
<area shape="poly" title=" " alt="" coords="101,259,148,271,275,304,273,309,147,276,99,264"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="595,133,687,161"/>
<area shape="poly" title=" " alt="" coords="86,232,174,196,284,162,370,145,457,138,520,137,579,139,579,144,520,142,457,143,371,150,286,167,176,201,88,236"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="595,311,687,338"/>
<area shape="poly" title=" " alt="" coords="67,261,101,300,149,341,214,379,245,390,285,399,328,405,372,404,416,399,458,391,535,368,596,343,598,348,537,373,459,396,416,405,372,410,328,410,285,404,243,395,211,384,146,345,98,304,63,264"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#aecadaa463253df28c47f4a201dda2359" title="파일 쓰기" alt="" coords="156,235,229,262"/>
<area shape="poly" title=" " alt="" coords="100,246,140,246,140,251,100,251"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="300,57,394,85"/>
<area shape="poly" title=" " alt="" coords="56,233,68,204,86,168,112,131,146,101,179,84,215,74,284,66,285,71,216,79,181,89,149,105,116,135,91,171,72,207,61,235"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="299,363,395,390"/>
<area shape="poly" title=" " alt="" coords="78,261,149,299,221,330,289,355,287,360,219,335,147,304,76,265"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="312,5,383,33"/>
<area shape="poly" title=" " alt="" coords="237,17,296,17,296,22,237,23"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="457,311,547,338"/>
<area shape="poly" title=" " alt="" coords="410,322,441,322,441,327,410,327"/>
<area shape="poly" title=" " alt="" coords="512,309,617,172,621,175,516,312"/>
<area shape="poly" title=" " alt="" coords="547,322,579,322,579,327,547,327"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="735,83,837,110"/>
<area shape="poly" title=" " alt="" coords="682,130,729,113,731,118,684,135"/>
<area shape="poly" title=" " alt="" coords="224,261,305,301,302,306,221,265"/>
<area shape="poly" title=" " alt="" coords="213,232,246,212,284,195,362,174,442,160,579,146,579,152,443,165,363,179,286,200,248,217,216,236"/>
<area shape="poly" title=" " alt="" coords="230,250,369,267,547,297,580,304,579,310,546,302,369,272,229,255"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="300,209,394,237"/>
<area shape="poly" title=" " alt="" coords="229,240,284,231,285,236,230,245"/>
<area shape="poly" title=" " alt="" coords="204,233,322,95,326,99,208,236"/>
<area shape="poly" title=" " alt="" coords="205,261,239,303,261,327,287,348,295,353,292,357,283,352,258,331,235,307,201,264"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="464,209,540,237"/>
<area shape="poly" title=" " alt="" coords="395,220,448,220,448,226,395,226"/>
<area shape="poly" title=" " alt="" coords="395,71,719,90,719,95,395,77"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_icgraph" id="adf/d26/fs_8h_a6a7f3ad04cc17f3fb58519236a2ee996_icgraph">
<area shape="rect" title="파일 크기 조정 (truncate)" alt="" coords="503,5,598,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f" title="파일 크기 변경 콜백" alt="" coords="316,5,455,33"/>
<area shape="poly" title=" " alt="" coords="487,22,456,22,456,16,487,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,268,22,268,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="add11b7953b7d14deb0456e14c8d7b197" name="add11b7953b7d14deb0456e14c8d7b197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add11b7953b7d14deb0456e14c8d7b197">&#9670;&#160;</a></span>fs_unlink()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_unlink </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 삭제 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>삭제할 파일 경로 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>지정된 경로의 파일을 삭제하고, 관련 데이터 블록 및 아이노드를 해제한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>삭제할 파일 경로 (null-terminated 문자열) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00867">867</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  867</span>                                                     {</div>
<div class="line"><span class="lineno">  868</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  869</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0) {</div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  871</span>  }</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">  874</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode);</div>
<div class="line"><span class="lineno">  875</span>  <span class="comment">/* 디렉터리는 삭제 불가 */</span></div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordflow">if</span> ((inode.mode &amp; S_IFDIR) == S_IFDIR) {</div>
<div class="line"><span class="lineno">  877</span>    <span class="keywordflow">return</span> -EISDIR;</div>
<div class="line"><span class="lineno">  878</span>  }</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>  <span class="comment">/* 상위 디렉터리 및 파일 이름 분리 */</span></div>
<div class="line"><span class="lineno">  881</span>  <span class="keywordtype">char</span> *path_copy = strdup(path);</div>
<div class="line"><span class="lineno">  882</span>  <span class="keywordflow">if</span> (!path_copy)</div>
<div class="line"><span class="lineno">  883</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">  884</span>  <span class="keywordtype">char</span> *name = strrchr(path_copy, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  885</span>  *name = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  886</span>  <span class="keywordtype">char</span> *parent_path = (*path_copy == <span class="charliteral">&#39;\0&#39;</span>) ? <span class="stringliteral">&quot;/&quot;</span> : path_copy;</div>
<div class="line"><span class="lineno">  887</span>  name++;</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>  <span class="comment">/* 상위 디렉터리 inode 조회 */</span></div>
<div class="line"><span class="lineno">  890</span>  uint32_t parent_ino;</div>
<div class="line"><span class="lineno">  891</span>  <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, parent_path, &amp;parent_ino);</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>  uint8_t dir_block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno">  894</span>  uint8_t zero_block[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>] = {0}; <span class="comment">/* 블록 초기화용 제로 버퍼 */</span></div>
<div class="line"><span class="lineno">  895</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> parent_inode;</div>
<div class="line"><span class="lineno">  896</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>  <span class="comment">/* 상위 디렉터리에서 디렉터리 엔트리 제거 */</span></div>
<div class="line"><span class="lineno">  899</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 12; ++i) {</div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">if</span> (parent_inode.direct[i] == 0)</div>
<div class="line"><span class="lineno">  901</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  902</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block) &lt; 0)</div>
<div class="line"><span class="lineno">  903</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  904</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *entries = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)dir_block;</div>
<div class="line"><span class="lineno">  905</span>    <span class="keywordflow">for</span> (uint32_t j = 0; j &lt; <a class="code hl_define" href="../../df/d9c/dir_8h.html#aea073931da657513026982c1aac99b4d">DENTS_PER_BLOCK</a>; ++j) {</div>
<div class="line"><span class="lineno">  906</span>      <span class="keywordflow">if</span> (entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a> == ino &amp;&amp;</div>
<div class="line"><span class="lineno">  907</span>          strncmp(entries[j].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a9b38e50447844882ddaaacb947f3d5dc">name</a>, <a class="code hl_define" href="../../df/d9c/dir_8h.html#a309b8658c2817a5c55a08445e9760743">SFUSE_NAME_MAX</a>) == 0) {</div>
<div class="line"><span class="lineno">  908</span>        <span class="comment">/* 삭제 시 디렉터리 엔트리 전체를 0으로 초기화 */</span></div>
<div class="line"><span class="lineno">  909</span>        memset(&amp;entries[j], 0, <span class="keyword">sizeof</span>(entries[j]));</div>
<div class="line"><span class="lineno">  910</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, parent_inode.direct[i], dir_block);</div>
<div class="line"><span class="lineno">  911</span>        <span class="keywordflow">goto</span> found_entry;</div>
<div class="line"><span class="lineno">  912</span>      }</div>
<div class="line"><span class="lineno">  913</span>    }</div>
<div class="line"><span class="lineno">  914</span>  }</div>
<div class="line"><span class="lineno">  915</span>found_entry:</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>  <span class="comment">/* 직접 데이터 블록 해제: 내용 제로화 후 상대 인덱스로 비트맵 해제 */</span></div>
<div class="line"><span class="lineno">  918</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 12; ++i) {</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.direct[i] == 0)</div>
<div class="line"><span class="lineno">  920</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  921</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.direct[i],</div>
<div class="line"><span class="lineno">  922</span>                zero_block); <span class="comment">// 블록 내용 모두 0으로 덮어쓰기</span></div>
<div class="line"><span class="lineno">  923</span>    <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>,</div>
<div class="line"><span class="lineno">  924</span>               <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.direct[i] -</div>
<div class="line"><span class="lineno">  925</span>                   fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>); <span class="comment">// 상대 블록 번호로 비트맵 해제</span></div>
<div class="line"><span class="lineno">  926</span>    <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.direct[i] = 0;</div>
<div class="line"><span class="lineno">  927</span>  }</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>  <span class="comment">/* 단일 간접 블록 해제: 데이터 블록과 포인터 블록 모두 제로화 후 해제 */</span></div>
<div class="line"><span class="lineno">  930</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.indirect != 0) {</div>
<div class="line"><span class="lineno">  931</span>    uint32_t ptrs[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  932</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.indirect, ptrs);</div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">for</span> (uint32_t k = 0; k &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++k) {</div>
<div class="line"><span class="lineno">  934</span>      <span class="keywordflow">if</span> (ptrs[k] == 0)</div>
<div class="line"><span class="lineno">  935</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  936</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, ptrs[k], zero_block);</div>
<div class="line"><span class="lineno">  937</span>      <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, ptrs[k] - fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>);</div>
<div class="line"><span class="lineno">  938</span>      ptrs[k] = 0;</div>
<div class="line"><span class="lineno">  939</span>    }</div>
<div class="line"><span class="lineno">  940</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.indirect,</div>
<div class="line"><span class="lineno">  941</span>                zero_block); <span class="comment">// 포인터 블록도 제로화</span></div>
<div class="line"><span class="lineno">  942</span>    <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>,</div>
<div class="line"><span class="lineno">  943</span>               <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.indirect - fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>);</div>
<div class="line"><span class="lineno">  944</span>    <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.indirect = 0;</div>
<div class="line"><span class="lineno">  945</span>  }</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>  <span class="comment">/* 이중 간접 블록 해제: 이중 레벨 순회하며 제로화 후 해제 */</span></div>
<div class="line"><span class="lineno">  948</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.double_indirect != 0) {</div>
<div class="line"><span class="lineno">  949</span>    uint32_t l1[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  950</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.double_indirect, l1);</div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordflow">for</span> (uint32_t i1 = 0; i1 &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++i1) {</div>
<div class="line"><span class="lineno">  952</span>      <span class="keywordflow">if</span> (l1[i1] == 0)</div>
<div class="line"><span class="lineno">  953</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  954</span>      uint32_t l2[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  955</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[i1], l2);</div>
<div class="line"><span class="lineno">  956</span>      <span class="keywordflow">for</span> (uint32_t i2 = 0; i2 &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; ++i2) {</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">if</span> (l2[i2] == 0)</div>
<div class="line"><span class="lineno">  958</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  959</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l2[i2], zero_block);</div>
<div class="line"><span class="lineno">  960</span>        <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>,</div>
<div class="line"><span class="lineno">  961</span>                   l2[i2] - fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>);</div>
<div class="line"><span class="lineno">  962</span>        l2[i2] = 0;</div>
<div class="line"><span class="lineno">  963</span>      }</div>
<div class="line"><span class="lineno">  964</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[i1], zero_block); <span class="comment">// 2차 포인터 블록 제로화</span></div>
<div class="line"><span class="lineno">  965</span>      <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>, l1[i1] - fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>);</div>
<div class="line"><span class="lineno">  966</span>      l1[i1] = 0;</div>
<div class="line"><span class="lineno">  967</span>    }</div>
<div class="line"><span class="lineno">  968</span>    <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.double_indirect,</div>
<div class="line"><span class="lineno">  969</span>                zero_block); <span class="comment">// 1차 포인터 블록 제로화</span></div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#ad78edd18fe67d2ffa13fbc1fc89436c0">free_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>,</div>
<div class="line"><span class="lineno">  971</span>               <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.double_indirect - fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a>);</div>
<div class="line"><span class="lineno">  972</span>    <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a73e74a2f27bfdd1383b6292beff30476">inode</a>.double_indirect = 0;</div>
<div class="line"><span class="lineno">  973</span>  }</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>  <span class="comment">/* 아이노드 비트맵 해제 및 아이노드 초기화 */</span></div>
<div class="line"><span class="lineno">  976</span>  <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a156ed842116a648997c737d182b7416a">free_inode</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#ae875a8ba6b9ca19192fc23bef93c8adf">inode</a>, ino);</div>
<div class="line"><span class="lineno">  977</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> empty_inode;</div>
<div class="line"><span class="lineno">  978</span>  memset(&amp;empty_inode, 0, <span class="keyword">sizeof</span>(empty_inode));</div>
<div class="line"><span class="lineno">  979</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;empty_inode);</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  <span class="comment">/* 상위 디렉터리 메타데이터 갱신 */</span></div>
<div class="line"><span class="lineno">  982</span>  time_t now_time = time(NULL);</div>
<div class="line"><span class="lineno">  983</span>  parent_inode.mtime = (uint32_t)now_time;</div>
<div class="line"><span class="lineno">  984</span>  parent_inode.ctime = (uint32_t)now_time;</div>
<div class="line"><span class="lineno">  985</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, parent_ino, &amp;parent_inode);</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>  free(path_copy);</div>
<div class="line"><span class="lineno">  988</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  989</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_cgraph.png" border="0" usemap="#adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_cgraph" id="adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_cgraph">
<area shape="rect" title="파일 삭제" alt="" coords="5,159,86,186"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad78edd18fe67d2ffa13fbc1fc89436c0" title="슈퍼블록 기반으로 데이터 블록 해제" alt="" coords="151,57,240,85"/>
<area shape="poly" title=" " alt="" coords="61,156,132,101,150,90,153,95,135,105,64,160"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a156ed842116a648997c737d182b7416a" title="슈퍼블록 기반으로 아이노드 해제" alt="" coords="151,5,241,33"/>
<area shape="poly" title=" " alt="" coords="51,157,81,103,104,72,132,44,139,39,142,43,135,48,108,75,86,106,56,159"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="134,209,258,237"/>
<area shape="poly" title=" " alt="" coords="87,183,139,201,137,206,85,188"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="448,211,541,238"/>
<area shape="poly" title=" " alt="" coords="59,185,90,218,111,234,135,246,173,257,213,264,294,265,370,255,434,240,435,246,371,260,294,270,212,269,172,262,133,251,108,238,87,222,55,188"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="448,159,541,186"/>
<area shape="poly" title=" " alt="" coords="86,170,433,170,433,175,86,175"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="306,108,400,136"/>
<area shape="poly" title=" " alt="" coords="86,161,133,151,291,127,291,132,134,156,87,166"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="148,311,244,338"/>
<area shape="poly" title=" " alt="" coords="56,185,87,235,110,264,135,290,149,300,146,305,132,295,106,268,83,238,52,188"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="318,31,389,58"/>
<area shape="poly" title=" " alt="" coords="241,61,302,50,303,56,242,66"/>
<area shape="poly" title=" " alt="" coords="242,24,302,34,301,39,241,29"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="308,209,398,237"/>
<area shape="poly" title=" " alt="" coords="258,220,293,220,293,226,258,226"/>
<area shape="poly" title=" " alt="" coords="398,221,433,221,433,227,398,226"/>
<area shape="poly" title=" " alt="" coords="393,206,439,190,440,195,395,211"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="589,160,691,188"/>
<area shape="poly" title=" " alt="" coords="535,208,583,191,585,196,537,213"/>
<area shape="poly" title=" " alt="" coords="401,124,541,145,577,153,575,158,540,150,400,129"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_icgraph.png" border="0" usemap="#adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_icgraph" id="adf/d26/fs_8h_add11b7953b7d14deb0456e14c8d7b197_icgraph">
<area shape="rect" title="파일 삭제" alt="" coords="613,32,693,60"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8cf3ec78e9108f22f73ac3ab974fe8dc" title="디렉터리 삭제" alt="" coords="489,7,565,34"/>
<area shape="poly" title=" " alt="" coords="597,37,565,31,566,25,598,32"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c" title="파일 삭제 콜백" alt="" coords="316,57,441,85"/>
<area shape="poly" title=" " alt="" coords="597,54,442,68,441,63,597,48"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title="디렉터리 삭제 콜백" alt="" coords="318,5,439,33"/>
<area shape="poly" title=" " alt="" coords="474,23,439,22,439,17,474,17"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,32,268,60"/>
<area shape="poly" title=" " alt="" coords="304,32,269,37,268,32,303,27"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,32,60,60"/>
<area shape="poly" title=" " alt="" coords="92,48,60,48,60,43,92,43"/>
<area shape="poly" title=" " alt="" coords="301,64,268,59,269,54,301,58"/>
</map>
</div>

</div>
</div>
<a id="a818f99fae8ad5abcc450d41aac5d37ec" name="a818f99fae8ad5abcc450d41aac5d37ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a818f99fae8ad5abcc450d41aac5d37ec">&#9670;&#160;</a></span>fs_utimens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_utimens </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timespec</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>[2]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일의 시간 속성 변경 (utimens) </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 </td></tr>
    <tr><td class="paramname">tv</td><td>[0]=접근 시간, [1]=변경 시간 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드</dd></dl>
<p>파일의 시간 속성 변경 (utimens)</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>대상 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">tv</td><td>tv[0]=접근 시간, tv[1]=수정 시간 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>성공 시 0, 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 접근 시간 설정</p>
<p>&lt; 수정 시간 설정</p>
<p>&lt; 메타데이터 변경 시간 갱신</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l01356">1356</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1357</span>                                            {</div>
<div class="line"><span class="lineno"> 1358</span>  uint32_t ino;</div>
<div class="line"><span class="lineno"> 1359</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1360</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno"> 1361</span>  }</div>
<div class="line"><span class="lineno"> 1362</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno"> 1363</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno"> 1365</span>  }</div>
<div class="line"><span class="lineno"> 1366</span>  inode.<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a4ec8882c06d3f0935c3af6d551aee955">atime</a> = (uint32_t)tv[0].tv_sec; </div>
<div class="line"><span class="lineno"> 1367</span>  inode.mtime = (uint32_t)tv[1].tv_sec; </div>
<div class="line"><span class="lineno"> 1368</span>  inode.ctime = (uint32_t)time(NULL);   </div>
<div class="line"><span class="lineno"> 1369</span>  <a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode);</div>
<div class="line"><span class="lineno"> 1370</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1371</span>}</div>
<div class="ttc" id="astructsfuse__inode_html_a4ec8882c06d3f0935c3af6d551aee955"><div class="ttname"><a href="../../d2/d13/structsfuse__inode.html#a4ec8882c06d3f0935c3af6d551aee955">sfuse_inode::atime</a></div><div class="ttdeci">uint32_t atime</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00027">inode.h:27</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_cgraph" id="adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_cgraph">
<area shape="rect" title="파일의 시간 속성 변경 (utimens)" alt="" coords="5,57,99,85"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="147,7,271,34"/>
<area shape="poly" title=" " alt="" coords="96,54,149,37,150,42,98,59"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="461,57,554,85"/>
<area shape="poly" title=" " alt="" coords="99,68,446,68,446,74,99,74"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="319,108,413,136"/>
<area shape="poly" title=" " alt="" coords="100,78,147,87,304,111,304,116,146,92,99,83"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="322,7,411,34"/>
<area shape="poly" title=" " alt="" coords="271,18,306,18,306,23,271,23"/>
<area shape="poly" title=" " alt="" coords="408,32,453,49,452,54,406,37"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="461,5,554,33"/>
<area shape="poly" title=" " alt="" coords="411,17,446,17,446,22,411,23"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="602,83,704,110"/>
<area shape="poly" title=" " alt="" coords="554,77,587,82,586,88,554,82"/>
<area shape="poly" title=" " alt="" coords="414,115,586,100,587,105,414,120"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_icgraph" id="adf/d26/fs_8h_a818f99fae8ad5abcc450d41aac5d37ec_icgraph">
<area shape="rect" title="파일의 시간 속성 변경 (utimens)" alt="" coords="502,5,596,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9" title="파일/디렉터리 타임스탬프 갱신 콜백" alt="" coords="316,5,454,33"/>
<area shape="poly" title=" " alt="" coords="487,22,455,22,455,16,487,16"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="poly" title=" " alt="" coords="300,22,269,22,269,16,300,16"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
<a id="aecadaa463253df28c47f4a201dda2359" name="aecadaa463253df28c47f4a201dda2359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecadaa463253df28c47f4a201dda2359">&#9670;&#160;</a></span>fs_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dc5/structsfuse__fs.html">sfuse_fs</a> *</td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>파일 쓰기 </p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 </td></tr>
    <tr><td class="paramname">path</td><td>파일 경로 </td></tr>
    <tr><td class="paramname">buf</td><td>쓸 데이터 버퍼 </td></tr>
    <tr><td class="paramname">size</td><td>쓸 바이트 수 </td></tr>
    <tr><td class="paramname">offset</td><td>쓰기 오프셋 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>쓴 바이트 수 또는 음수 오류 코드</dd></dl>
<p>지정된 경로의 파일에 사용자 버퍼의 데이터를 기록한다.</p>
<dl class="params"><dt>매개변수</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>파일 시스템 컨텍스트 포인터 </td></tr>
    <tr><td class="paramname">path</td><td>쓰기 대상 파일 경로 (null-terminated 문자열) </td></tr>
    <tr><td class="paramname">buf</td><td>기록할 데이터가 담긴 버퍼 포인터 </td></tr>
    <tr><td class="paramname">size</td><td>기록할 바이트 수 </td></tr>
    <tr><td class="paramname">offset</td><td>파일 내 시작 오프셋 (바이트 단위) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>반환값</dt><dd>기록된 바이트 수 (&gt;=0), 실패 시 음수 오류 코드 </dd></dl>
<p>&lt; 현재 오프셋</p>
<p>&lt; 논리 블록 인덱스</p>
<p>&lt; 블록 내 오프셋</p>
<p>&lt; 블록 경계까지 쓸 바이트</p>
<p>&lt; 대상 블록 포인터 위치</p>
<p>&lt; 실제 할당된 디스크 블록 번호</p>
<p>&lt; 1차 인덱스</p>
<p>&lt; 2차 인덱스</p>
<p>&lt; 수정 시간 갱신</p>
<p>&lt; 변경 시간 갱신</p>

<p class="definition"><a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a> 파일의 <a class="el" href="../../d2/d5a/fs_8c_source.html#l00445">445</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  446</span>                                        {</div>
<div class="line"><span class="lineno">  447</span>  uint32_t ino;</div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db">fs_resolve_path</a>(fs, path, &amp;ino) &lt; 0)</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d73/inode_8h.html#a490b41738be882c224282cb0873c4185">inode_load</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode) &lt; 0)</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>  <span class="comment">/*&lt; 디렉터리에는 쓰기 불가 */</span></div>
<div class="line"><span class="lineno">  456</span>  <span class="keywordflow">if</span> ((inode.mode &amp; S_IFDIR) == S_IFDIR)</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">return</span> -EISDIR;</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>  <span class="keywordtype">size_t</span> bytes_written = 0;</div>
<div class="line"><span class="lineno">  460</span>  uint8_t block_buf[<a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>];</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">/*&lt; 요청한 크기만큼 반복 처리 */</span></div>
<div class="line"><span class="lineno">  463</span>  <span class="keywordflow">while</span> (bytes_written &lt; <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a>) {</div>
<div class="line"><span class="lineno">  464</span>    off_t cur_offset = offset + bytes_written; </div>
<div class="line"><span class="lineno">  465</span>    uint32_t block_index =</div>
<div class="line"><span class="lineno">  466</span>        cur_offset / <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno">  467</span>    uint32_t block_offset =</div>
<div class="line"><span class="lineno">  468</span>        cur_offset % <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>; </div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordtype">size_t</span> to_write =</div>
<div class="line"><span class="lineno">  470</span>        <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a> - block_offset; </div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span> (to_write &gt; <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - bytes_written)</div>
<div class="line"><span class="lineno">  472</span>      to_write = <a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> - bytes_written;</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    uint32_t *target = NULL; </div>
<div class="line"><span class="lineno">  475</span>    uint32_t disk_block = 0; </div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="comment">/*&lt; 직접 블록 */</span></div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">if</span> (block_index &lt; 12U) {</div>
<div class="line"><span class="lineno">  479</span>      target = &amp;inode.direct[block_index];</div>
<div class="line"><span class="lineno">  480</span>      disk_block = *target; <span class="comment">/* direct 블록 포인터로 disk_block 초기화 */</span></div>
<div class="line"><span class="lineno">  481</span>    }</div>
<div class="line"><span class="lineno">  482</span>    <span class="comment">/*&lt; 단일 간접 블록 */</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index &lt; 12U + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>) {</div>
<div class="line"><span class="lineno">  484</span>      <span class="keywordflow">if</span> (inode.indirect == 0) {</div>
<div class="line"><span class="lineno">  485</span>        <span class="comment">/* 간접 블록이 없으면 새 할당 */</span></div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  488</span>          <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  489</span>        inode.indirect =</div>
<div class="line"><span class="lineno">  490</span>            (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  491</span>                       new_block); <span class="comment">/* 간접 블록 주소도 절대 번호로 변환 */</span></div>
<div class="line"><span class="lineno">  492</span>        uint32_t tmp[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>] = {0};</div>
<div class="line"><span class="lineno">  493</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, tmp);</div>
<div class="line"><span class="lineno">  494</span>      }</div>
<div class="line"><span class="lineno">  495</span>      <span class="comment">/* 기존 간접 블록에서 포인터 읽기 */</span></div>
<div class="line"><span class="lineno">  496</span>      uint32_t ptrs[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  497</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>      target = &amp;ptrs[block_index - 12U];</div>
<div class="line"><span class="lineno">  500</span>      disk_block = *target;</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>      <span class="comment">/* 새 데이터 블록 할당 */</span></div>
<div class="line"><span class="lineno">  503</span>      <span class="keywordflow">if</span> (disk_block == 0) {</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  505</span>        <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  506</span>          <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  507</span>        disk_block = (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  508</span>                                new_block); <span class="comment">/* 새 블록 인덱스를 데이터 영역</span></div>
<div class="line"><span class="lineno">  509</span><span class="comment">                                               오프셋과 합산 */</span></div>
<div class="line"><span class="lineno">  510</span>        *target = disk_block;</div>
<div class="line"><span class="lineno">  511</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.indirect, ptrs);</div>
<div class="line"><span class="lineno">  512</span>      }</div>
<div class="line"><span class="lineno">  513</span>    }</div>
<div class="line"><span class="lineno">  514</span>    <span class="comment">/*&lt; 이중 간접 블록 */</span></div>
<div class="line"><span class="lineno">  515</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  516</span>      uint32_t dbl_index = block_index - (12U + <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>);</div>
<div class="line"><span class="lineno">  517</span>      uint32_t l1_idx = dbl_index / <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; </div>
<div class="line"><span class="lineno">  518</span>      uint32_t l2_idx = dbl_index % <a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>; </div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>      <span class="keywordflow">if</span> (inode.double_indirect == 0) {</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  523</span>          <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  524</span>        inode.double_indirect =</div>
<div class="line"><span class="lineno">  525</span>            (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  526</span>                       new_block); <span class="comment">/* 이중 간접 블록도 절대 번호로 변환 */</span></div>
<div class="line"><span class="lineno">  527</span>        uint32_t tmp[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>] = {0};</div>
<div class="line"><span class="lineno">  528</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, tmp);</div>
<div class="line"><span class="lineno">  529</span>      }</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>      uint32_t l1[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  532</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, l1);</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>      <span class="keywordflow">if</span> (l1[l1_idx] == 0) {</div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  536</span>        <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  537</span>          <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  538</span>        l1[l1_idx] = (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  539</span>                                new_block); <span class="comment">/* 레벨1 인덱스에도 데이터 영역 시작</span></div>
<div class="line"><span class="lineno">  540</span><span class="comment">                                               오프셋 적용 */</span></div>
<div class="line"><span class="lineno">  541</span>        uint32_t tmp[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>] = {0};</div>
<div class="line"><span class="lineno">  542</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[l1_idx], tmp);</div>
<div class="line"><span class="lineno">  543</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, inode.double_indirect, l1);</div>
<div class="line"><span class="lineno">  544</span>      }</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>      uint32_t l2[<a class="code hl_define" href="../../d3/d73/inode_8h.html#a113396e915a4441e2d49df4b7bb6d26c">SFUSE_PTRS_PER_BLOCK</a>];</div>
<div class="line"><span class="lineno">  547</span>      <a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[l1_idx], l2);</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>      <span class="keywordflow">if</span> (l2[l2_idx] == 0) {</div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  552</span>          <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  553</span>        l2[l2_idx] = (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  554</span>                                new_block); <span class="comment">/* 레벨2 인덱스에도 오프셋을 더해</span></div>
<div class="line"><span class="lineno">  555</span><span class="comment">                                               절대 주소로 */</span></div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, l1[l1_idx], l2);</div>
<div class="line"><span class="lineno">  557</span>      }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>      disk_block = l2[l2_idx];</div>
<div class="line"><span class="lineno">  560</span>      target = &amp;l2[l2_idx];</div>
<div class="line"><span class="lineno">  561</span>    }</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    <span class="comment">/*&lt; 아직 할당되지 않았으면 새로 할당 */</span></div>
<div class="line"><span class="lineno">  564</span>    <span class="keywordflow">if</span> (target &amp;&amp; *target == 0) {</div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordtype">int</span> new_block = <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a7342a6b6280af158749416ff1fffadfc">alloc_block</a>(&amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a188eaee1b599d1c0260a905a1c27c73d">bmaps</a>-&gt;<a class="code hl_variable" href="../../d2/d35/structsfuse__bitmaps.html#a9b626055d1a1c2f76698bd9723f0110f">block</a>);</div>
<div class="line"><span class="lineno">  566</span>      <span class="keywordflow">if</span> (new_block &lt; 0)</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">  568</span>      *target = (uint32_t)(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>.<a class="code hl_variable" href="../../d7/d75/structsfuse__superblock.html#a85add9a4b064a3a048d7580e1ecd9a85">data_block_start</a> +</div>
<div class="line"><span class="lineno">  569</span>                           new_block); <span class="comment">/* 상대 인덱스에 데이터 영역 시작 블록</span></div>
<div class="line"><span class="lineno">  570</span><span class="comment">                                          번호 더해 절대 블록 번호로 저장 */</span></div>
<div class="line"><span class="lineno">  571</span>      disk_block = *target;</div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="comment">/*&lt; 기존 블록 읽기 */</span></div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#a737beb05c598c11278e8b17146b48dcf">read_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, disk_block, block_buf) &lt; 0)</div>
<div class="line"><span class="lineno">  576</span>      <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <span class="comment">/*&lt; 데이터 쓰기 */</span></div>
<div class="line"><span class="lineno">  579</span>    memcpy(block_buf + block_offset, buf + bytes_written, to_write);</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/d40/block_8h.html#af4beb38783113f42a845b7702ebaa8d5">write_block</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, disk_block, block_buf) &lt; 0)</div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    bytes_written += to_write;</div>
<div class="line"><span class="lineno">  584</span>  }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>  <span class="comment">/*&lt; 파일 크기 갱신 */</span></div>
<div class="line"><span class="lineno">  587</span>  <span class="keywordflow">if</span> ((uint32_t)(offset + bytes_written) &gt; inode.size)</div>
<div class="line"><span class="lineno">  588</span>    inode.<a class="code hl_variable" href="../../d2/d13/structsfuse__inode.html#a8f67762b0e63a291da0db528b627922c">size</a> = offset + bytes_written;</div>
<div class="line"><span class="lineno">  589</span>  inode.mtime = time(NULL);  </div>
<div class="line"><span class="lineno">  590</span>  inode.ctime = inode.mtime; </div>
<div class="line"><span class="lineno">  591</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d73/inode_8h.html#abbb03a523d329cec86d9473e1a6ff70b">inode_sync</a>(fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#af14cab3f6994b0e91e858ddffc424140">backing_fd</a>, &amp;fs-&gt;<a class="code hl_variable" href="../../df/dc5/structsfuse__fs.html#a86cd2ebfda2408f59d3260897c1a4866">sb</a>, ino, &amp;inode) &lt; 0)</div>
<div class="line"><span class="lineno">  592</span>    <span class="keywordflow">return</span> -EIO;</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>  <span class="keywordflow">return</span> bytes_written;</div>
<div class="line"><span class="lineno">  595</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_cgraph.png" border="0" usemap="#adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_cgraph" id="adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_cgraph">
<area shape="rect" title="파일 쓰기" alt="" coords="5,133,79,161"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="142,5,236,33"/>
<area shape="poly" title=" " alt="" coords="51,131,82,93,125,50,142,39,145,43,128,55,86,96,55,135"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="127,159,251,186"/>
<area shape="poly" title=" " alt="" coords="79,151,112,157,111,162,79,156"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="441,160,534,188"/>
<area shape="poly" title=" " alt="" coords="62,159,91,179,127,195,200,211,259,213,318,206,393,195,425,189,426,194,394,200,318,211,259,218,200,216,126,200,89,184,59,164"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="441,108,534,136"/>
<area shape="poly" title=" " alt="" coords="79,142,426,123,426,128,79,148"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="299,57,393,85"/>
<area shape="poly" title=" " alt="" coords="64,131,93,115,126,101,207,81,283,72,284,77,208,87,127,106,95,119,67,135"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="141,260,237,288"/>
<area shape="poly" title=" " alt="" coords="55,160,86,198,128,240,143,250,140,254,125,244,82,202,51,163"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="308,5,384,33"/>
<area shape="poly" title=" " alt="" coords="237,16,293,16,293,22,237,22"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="302,159,391,186"/>
<area shape="poly" title=" " alt="" coords="251,170,286,170,286,175,251,175"/>
<area shape="poly" title=" " alt="" coords="391,170,426,171,426,176,391,176"/>
<area shape="poly" title=" " alt="" coords="386,156,432,139,433,144,388,161"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="582,109,684,137"/>
<area shape="poly" title=" " alt="" coords="528,157,576,140,578,145,530,162"/>
<area shape="poly" title=" " alt="" coords="394,73,534,94,570,102,568,107,533,99,393,78"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_icgraph.png" border="0" usemap="#adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_icgraph" id="adf/d26/fs_8h_aecadaa463253df28c47f4a201dda2359_icgraph">
<area shape="rect" title="파일 쓰기" alt="" coords="646,32,719,60"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a7f3ad04cc17f3fb58519236a2ee996" title="파일 크기 조정 (truncate)" alt="" coords="503,7,598,34"/>
<area shape="poly" title=" " alt="" coords="630,38,598,32,599,27,631,33"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59" title="파일 쓰기 콜백" alt="" coords="326,57,445,85"/>
<area shape="poly" title=" " alt="" coords="631,53,446,69,445,63,630,48"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f" title="파일 크기 변경 콜백" alt="" coords="316,5,455,33"/>
<area shape="poly" title=" " alt="" coords="487,23,456,22,456,17,487,17"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7f093e2e9259d0b6002f4da685de854d" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,32,268,60"/>
<area shape="poly" title=" " alt="" coords="301,33,269,38,268,32,300,28"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,32,60,60"/>
<area shape="poly" title=" " alt="" coords="92,48,60,48,60,43,92,43"/>
<area shape="poly" title=" " alt="" coords="311,64,268,59,269,54,312,59"/>
</map>
</div>

</div>
</div>
<a id="a7f093e2e9259d0b6002f4da685de854d" name="a7f093e2e9259d0b6002f4da685de854d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f093e2e9259d0b6002f4da685de854d">&#9670;&#160;</a></span>sfuse_get_operations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct fuse_operations * sfuse_get_operations </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SFUSE용 FUSE operations 구조체 반환 </p>
<dl class="section return"><dt>반환값</dt><dd>설정된 fuse_operations 포인터</dd></dl>
<p>SFUSE용 FUSE operations 구조체 반환</p>
<p>생성된 콜백 함수들을 ops 구조체에 등록하여 반환한다.</p>
<dl class="section return"><dt>반환값</dt><dd>설정된 fuse_operations 구조체 포인터 </dd></dl>

<p class="definition"><a class="el" href="../../d9/d70/ops_8c_source.html">ops.c</a> 파일의 <a class="el" href="../../d9/d70/ops_8c_source.html#l00232">232</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                                   {</div>
<div class="line"><span class="lineno">  233</span>  <span class="keyword">static</span> <span class="keyword">struct </span>fuse_operations ops;</div>
<div class="line"><span class="lineno">  234</span>  memset(&amp;ops, 0, <span class="keyword">sizeof</span>(ops));</div>
<div class="line"><span class="lineno">  235</span>  ops.getattr = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe">sfuse_getattr_cb</a>;</div>
<div class="line"><span class="lineno">  236</span>  ops.access = <a class="code hl_function" href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4">sfuse_access_cb</a>;</div>
<div class="line"><span class="lineno">  237</span>  ops.readdir = <a class="code hl_function" href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad">sfuse_readdir_cb</a>;</div>
<div class="line"><span class="lineno">  238</span>  ops.open = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135">sfuse_open_cb</a>;</div>
<div class="line"><span class="lineno">  239</span>  ops.read = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7">sfuse_read_cb</a>;</div>
<div class="line"><span class="lineno">  240</span>  ops.write = <a class="code hl_function" href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59">sfuse_write_cb</a>;</div>
<div class="line"><span class="lineno">  241</span>  ops.create = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e">sfuse_create_cb</a>;</div>
<div class="line"><span class="lineno">  242</span>  ops.mkdir = <a class="code hl_function" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f">sfuse_mkdir_cb</a>;</div>
<div class="line"><span class="lineno">  243</span>  ops.unlink = <a class="code hl_function" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c">sfuse_unlink_cb</a>;</div>
<div class="line"><span class="lineno">  244</span>  ops.rmdir = <a class="code hl_function" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234">sfuse_rmdir_cb</a>;</div>
<div class="line"><span class="lineno">  245</span>  ops.rename = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a6886feb1b5bf1626b5b4ed7f14169edb">sfuse_rename_cb</a>;</div>
<div class="line"><span class="lineno">  246</span>  ops.truncate = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f">sfuse_truncate_cb</a>;</div>
<div class="line"><span class="lineno">  247</span>  ops.flush = <a class="code hl_function" href="../../d9/d70/ops_8c.html#ae6af7e792b2c9c0e5b3f1d29d0d22925">sfuse_flush_cb</a>;</div>
<div class="line"><span class="lineno">  248</span>  ops.fsync = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a1fddf11f9d0514cb1ba55bddd68e3d7f">sfuse_fsync_cb</a>;</div>
<div class="line"><span class="lineno">  249</span>  ops.utimens = <a class="code hl_function" href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9">sfuse_utimens_cb</a>;</div>
<div class="line"><span class="lineno">  250</span>  <span class="keywordflow">return</span> &amp;ops;</div>
<div class="line"><span class="lineno">  251</span>}</div>
<div class="ttc" id="aops_8c_html_a042aaedab092b188556e193b25a81e9f"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f">sfuse_truncate_cb</a></div><div class="ttdeci">static int sfuse_truncate_cb(const char *path, off_t size, struct fuse_file_info *fi)</div><div class="ttdoc">파일 크기 변경 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00175">ops.c:175</a></div></div>
<div class="ttc" id="aops_8c_html_a1fddf11f9d0514cb1ba55bddd68e3d7f"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a1fddf11f9d0514cb1ba55bddd68e3d7f">sfuse_fsync_cb</a></div><div class="ttdeci">static int sfuse_fsync_cb(const char *path, int datasync, struct fuse_file_info *fi)</div><div class="ttdoc">fsync 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00218">ops.c:218</a></div></div>
<div class="ttc" id="aops_8c_html_a4e8379279e62363763d8c7da873361d7"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7">sfuse_read_cb</a></div><div class="ttdeci">static int sfuse_read_cb(const char *path, char *buf, size_t size, off_t offset, struct fuse_file_info *fi)</div><div class="ttdoc">파일 읽기 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00082">ops.c:82</a></div></div>
<div class="ttc" id="aops_8c_html_a62bb834f4955786318b1c8588cbb0135"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135">sfuse_open_cb</a></div><div class="ttdeci">static int sfuse_open_cb(const char *path, struct fuse_file_info *fi)</div><div class="ttdoc">파일 열기 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00067">ops.c:67</a></div></div>
<div class="ttc" id="aops_8c_html_a6886feb1b5bf1626b5b4ed7f14169edb"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a6886feb1b5bf1626b5b4ed7f14169edb">sfuse_rename_cb</a></div><div class="ttdeci">static int sfuse_rename_cb(const char *from, const char *to, unsigned int flags)</div><div class="ttdoc">이름 변경 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00160">ops.c:160</a></div></div>
<div class="ttc" id="aops_8c_html_a6c01c3409d41549c5ca34b9a2f64ccfe"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe">sfuse_getattr_cb</a></div><div class="ttdeci">static int sfuse_getattr_cb(const char *path, struct stat *stbuf, struct fuse_file_info *fi)</div><div class="ttdoc">파일/디렉터리 속성 조회 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00021">ops.c:21</a></div></div>
<div class="ttc" id="aops_8c_html_a6dc52b86f2cef1906558a324213cac6e"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e">sfuse_create_cb</a></div><div class="ttdeci">static int sfuse_create_cb(const char *path, mode_t mode, struct fuse_file_info *fi)</div><div class="ttdoc">파일 생성 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00112">ops.c:112</a></div></div>
<div class="ttc" id="aops_8c_html_a7e84e199a67a156f1c4f3b9a85d46ad9"><div class="ttname"><a href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9">sfuse_utimens_cb</a></div><div class="ttdeci">static int sfuse_utimens_cb(const char *path, const struct timespec tv[2], struct fuse_file_info *fi)</div><div class="ttdoc">파일/디렉터리 타임스탬프 갱신 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00190">ops.c:190</a></div></div>
<div class="ttc" id="aops_8c_html_aad351f0b0a44bc288b2400fd405cef8c"><div class="ttname"><a href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c">sfuse_unlink_cb</a></div><div class="ttdeci">static int sfuse_unlink_cb(const char *path)</div><div class="ttdoc">파일 삭제 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00136">ops.c:136</a></div></div>
<div class="ttc" id="aops_8c_html_aad4c968c1ab3a4b7e7c8b36054266f59"><div class="ttname"><a href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59">sfuse_write_cb</a></div><div class="ttdeci">static int sfuse_write_cb(const char *path, const char *buf, size_t size, off_t offset, struct fuse_file_info *fi)</div><div class="ttdoc">파일 쓰기 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00098">ops.c:98</a></div></div>
<div class="ttc" id="aops_8c_html_acac9f9c69134190f86e015e89e39d43f"><div class="ttname"><a href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f">sfuse_mkdir_cb</a></div><div class="ttdeci">static int sfuse_mkdir_cb(const char *path, mode_t mode)</div><div class="ttdoc">디렉터리 생성 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00125">ops.c:125</a></div></div>
<div class="ttc" id="aops_8c_html_acdaffbb59b5fe7d0ceda916714ddc3ad"><div class="ttname"><a href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad">sfuse_readdir_cb</a></div><div class="ttdeci">static int sfuse_readdir_cb(const char *path, void *buf, fuse_fill_dir_t filler, off_t offset, struct fuse_file_info *fi, enum fuse_readdir_flags flags)</div><div class="ttdoc">디렉터리 목록 조회 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00051">ops.c:51</a></div></div>
<div class="ttc" id="aops_8c_html_acf365c5992fb91ebb3982a04fbbdf3b4"><div class="ttname"><a href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4">sfuse_access_cb</a></div><div class="ttdeci">static int sfuse_access_cb(const char *path, int mask)</div><div class="ttdoc">access 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00035">ops.c:35</a></div></div>
<div class="ttc" id="aops_8c_html_acf89b7cf9e32fbd2b7c749abb1b89234"><div class="ttname"><a href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234">sfuse_rmdir_cb</a></div><div class="ttdeci">static int sfuse_rmdir_cb(const char *path)</div><div class="ttdoc">디렉터리 삭제 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00147">ops.c:147</a></div></div>
<div class="ttc" id="aops_8c_html_ae6af7e792b2c9c0e5b3f1d29d0d22925"><div class="ttname"><a href="../../d9/d70/ops_8c.html#ae6af7e792b2c9c0e5b3f1d29d0d22925">sfuse_flush_cb</a></div><div class="ttdeci">static int sfuse_flush_cb(const char *path, struct fuse_file_info *fi)</div><div class="ttdoc">flush 콜백</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d70/ops_8c_source.html#l00204">ops.c:204</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_cgraph.png" border="0" usemap="#adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_cgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_cgraph" id="adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_cgraph">
<area shape="rect" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="5,725,166,752"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4" title="access 콜백" alt="" coords="219,778,348,806"/>
<area shape="poly" title=" " alt="" coords="140,750,215,771,214,776,139,755"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e" title="파일 생성 콜백" alt="" coords="407,529,533,556"/>
<area shape="poly" title=" " alt="" coords="91,723,107,690,133,648,168,605,189,586,212,571,256,552,302,540,348,535,391,534,391,539,349,540,303,546,257,557,215,575,193,591,172,609,137,651,112,693,95,725"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#ae6af7e792b2c9c0e5b3f1d29d0d22925" title="flush 콜백" alt="" coords="225,431,342,459"/>
<area shape="poly" title=" " alt="" coords="87,723,99,676,123,608,160,535,184,500,212,470,217,465,221,469,216,474,188,504,164,538,128,610,105,677,92,725"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a1fddf11f9d0514cb1ba55bddd68e3d7f" title="fsync 콜백" alt="" coords="223,483,344,511"/>
<area shape="poly" title=" " alt="" coords="90,723,105,685,131,633,167,577,212,527,226,517,229,521,215,531,171,581,136,636,110,688,94,725"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe" title="파일/디렉터리 속성 조회 콜백" alt="" coords="406,1219,535,1247"/>
<area shape="poly" title=" " alt="" coords="90,753,97,817,116,913,132,967,154,1020,181,1071,216,1117,255,1151,300,1178,347,1198,391,1213,390,1218,345,1203,297,1183,251,1155,212,1120,177,1074,149,1022,127,968,111,914,92,818,85,753"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f" title="디렉터리 생성 콜백" alt="" coords="222,585,345,612"/>
<area shape="poly" title=" " alt="" coords="101,722,150,681,212,635,240,618,243,622,215,639,153,686,105,726"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135" title="파일 열기 콜백" alt="" coords="225,942,342,970"/>
<area shape="poly" title=" " alt="" coords="96,751,141,826,175,873,215,915,239,932,235,936,212,919,171,876,137,829,92,754"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7" title="파일 읽기 콜백" alt="" coords="226,1079,340,1107"/>
<area shape="poly" title=" " alt="" coords="93,752,107,802,132,875,168,957,190,998,216,1035,249,1068,245,1072,212,1039,186,1000,163,960,127,877,102,804,88,753"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad" title="디렉터리 목록 조회 콜백" alt="" coords="404,1067,536,1095"/>
<area shape="poly" title=" " alt="" coords="93,752,106,795,131,856,167,922,190,952,215,979,256,1009,301,1032,347,1050,390,1063,389,1068,345,1055,298,1037,253,1013,212,983,185,955,162,924,126,858,101,797,88,753"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6886feb1b5bf1626b5b4ed7f14169edb" title="이름 변경 콜백" alt="" coords="216,283,351,311"/>
<area shape="poly" title=" " alt="" coords="85,724,93,657,113,557,129,500,150,443,178,387,212,337,233,317,237,321,216,340,182,390,155,445,134,502,118,558,98,658,90,724"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title="디렉터리 삭제 콜백" alt="" coords="223,831,344,859"/>
<area shape="poly" title=" " alt="" coords="109,751,157,781,215,815,231,822,229,827,212,819,154,786,106,755"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f" title="파일 크기 변경 콜백" alt="" coords="214,649,353,676"/>
<area shape="poly" title=" " alt="" coords="123,721,230,680,232,685,125,726"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c" title="파일 삭제 콜백" alt="" coords="221,725,346,752"/>
<area shape="poly" title=" " alt="" coords="166,736,205,736,205,741,166,741"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9" title="파일/디렉터리 타임스탬프 갱신 콜백" alt="" coords="401,927,539,955"/>
<area shape="poly" title=" " alt="" coords="99,751,144,808,178,840,215,868,256,889,301,905,386,927,385,932,299,911,254,894,212,873,174,845,141,812,94,754"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59" title="파일 쓰기 콜백" alt="" coords="224,350,342,378"/>
<area shape="poly" title=" " alt="" coords="87,724,100,671,125,592,161,503,185,459,212,418,245,385,249,389,216,421,189,462,166,505,130,594,105,672,92,725"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ae8816ea1bc016bed838b45345615d46c" title="접근 권한 검사" alt="" coords="592,826,676,854"/>
<area shape="poly" title=" " alt="" coords="349,798,577,829,576,835,348,803"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8d5826ede78fcd2b76628eabb56e70db" title="경로 문자열을 inode 번호로 변환" alt="" coords="729,927,853,955"/>
<area shape="poly" title=" " alt="" coords="658,852,682,870,730,907,748,917,745,922,727,911,679,874,655,856"/>
<area shape="rect" href="../../de/d32/dir_8c.html#acd690811815cf7e33fb3ab6f8b95216e" title="디렉터리에서 이름으로 inode 번호를 검색" alt="" coords="901,826,990,854"/>
<area shape="poly" title=" " alt="" coords="812,925,909,860,912,865,815,929"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a490b41738be882c224282cb0873c4185" title="디스크 이미지에서 아이노드를 읽어 구조체에 로드" alt="" coords="1038,927,1131,955"/>
<area shape="poly" title=" " alt="" coords="968,852,1053,916,1050,920,964,856"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a737beb05c598c11278e8b17146b48dcf" title="지정한 블록 번호의 데이터를 읽어 버퍼에 저장" alt="" coords="1038,674,1131,702"/>
<area shape="poly" title=" " alt="" coords="967,823,988,806,1030,758,1063,713,1068,716,1035,762,992,810,970,828"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#ae003f96dd0c540bc9f2fc169274f1d6f" title="아이노드 테이블 내 특정 아이노드의 디스크 내 바이트 오프셋을 계산" alt="" coords="1179,699,1281,727"/>
<area shape="poly" title=" " alt="" coords="1092,925,1209,739,1214,741,1097,928"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6129288ed91728ed7ef053ad8d0cc79d" title="파일 생성" alt="" coords="593,421,675,448"/>
<area shape="poly" title=" " alt="" coords="515,526,538,514,562,490,586,464,597,455,600,459,589,468,566,494,541,518,518,530"/>
<area shape="poly" title=" " alt="" coords="648,447,667,475,683,509,697,554,705,593,710,661,713,730,719,769,731,814,752,867,776,912,771,915,748,869,726,815,714,770,708,730,704,662,699,594,692,556,678,511,662,478,644,450"/>
<area shape="poly" title=" " alt="" coords="675,427,715,425,761,428,810,438,855,458,925,563,993,669,1022,736,1046,803,1078,911,1073,913,1041,805,1017,738,988,672,921,565,851,462,808,443,761,433,715,430,675,432"/>
<area shape="poly" title=" " alt="" coords="675,418,713,409,759,403,807,403,854,413,896,434,934,461,967,494,997,529,1044,600,1073,658,1069,661,1039,603,993,532,963,497,930,465,893,438,852,418,806,408,759,408,714,414,676,424"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a7342a6b6280af158749416ff1fffadfc" title="슈퍼블록 기반으로 데이터 블록 할당" alt="" coords="744,215,838,243"/>
<area shape="poly" title=" " alt="" coords="642,419,678,357,691,328,697,303,707,279,727,254,731,250,735,254,731,258,712,282,703,304,696,329,683,360,647,421"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a08b712b2489ab7b3346f82316300c6b3" title="슈퍼블록 기반으로 아이노드 할당" alt="" coords="743,319,838,347"/>
<area shape="poly" title=" " alt="" coords="655,418,679,400,727,363,745,352,748,357,730,367,682,404,658,422"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a156ed842116a648997c737d182b7416a" title="슈퍼블록 기반으로 아이노드 해제" alt="" coords="746,674,836,702"/>
<area shape="poly" title=" " alt="" coords="646,447,775,659,771,662,642,450"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#abbb03a523d329cec86d9473e1a6ff70b" title="아이노드 구조체 내용을 디스크 이미지에 동기화" alt="" coords="744,471,838,499"/>
<area shape="poly" title=" " alt="" coords="676,445,732,463,730,468,674,450"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#af4beb38783113f42a845b7702ebaa8d5" title="버퍼의 내용을 지정한 블록 번호에 기록" alt="" coords="743,267,839,295"/>
<area shape="poly" title=" " alt="" coords="658,418,679,401,694,376,701,353,709,330,727,306,732,301,736,305,731,310,713,332,706,355,699,378,683,404,662,422"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad195af185232b43149a1d9442e28d077" title="비트맵에서 0인 비트를 찾아 1로 설정하고 인덱스를 반환" alt="" coords="908,267,984,295"/>
<area shape="poly" title=" " alt="" coords="835,241,894,261,892,266,834,246"/>
<area shape="poly" title=" " alt="" coords="834,316,892,296,894,301,835,321"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a9d97a51ca0096c6fe7bf18c3947d2abb" title="비트맵에서 지정한 인덱스 비트를 0으로 설정" alt="" coords="910,725,981,752"/>
<area shape="poly" title=" " alt="" coords="836,700,896,720,895,725,835,705"/>
<area shape="poly" title=" " alt="" coords="839,488,912,503,953,515,991,531,1056,567,1116,609,1205,686,1202,691,1112,614,1053,571,989,535,951,520,911,508,838,493"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#afa59764091da583a569ad9e517043425" title="FUSE에서 플러시 요청 처리" alt="" coords="434,425,506,452"/>
<area shape="poly" title=" " alt="" coords="342,440,419,437,419,443,343,446"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ab503c5dc5cb6a0dc77f0b6d92bfccf5f" title="FUSE에서 fsync 요청 처리" alt="" coords="432,477,508,504"/>
<area shape="poly" title=" " alt="" coords="344,492,417,490,417,495,344,498"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a012d00e6eafc0bb7c9402e3f36cee00a" title="파일/디렉터리 속성 조회" alt="" coords="592,1282,676,1310"/>
<area shape="poly" title=" " alt="" coords="509,1245,583,1273,581,1278,508,1250"/>
<area shape="poly" title=" " alt="" coords="639,1280,775,968,780,970,644,1282"/>
<area shape="poly" title=" " alt="" coords="677,1303,744,1313,827,1315,870,1311,913,1301,953,1285,989,1262,1005,1242,1020,1211,1045,1129,1064,1041,1076,970,1082,971,1070,1042,1050,1130,1025,1213,1009,1245,992,1266,955,1290,914,1306,871,1316,827,1321,743,1318,676,1308"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a0e6c18058ed432a1b33962e1f7fda11f" title="디렉터리 생성" alt="" coords="595,522,673,550"/>
<area shape="poly" title=" " alt="" coords="345,592,437,583,539,565,581,553,583,558,540,570,438,588,346,597"/>
<area shape="poly" title=" " alt="" coords="642,549,676,660,731,813,777,912,773,914,726,815,671,661,637,551"/>
<area shape="poly" title=" " alt="" coords="668,548,852,633,943,679,992,711,1028,761,1054,816,1071,869,1081,912,1076,913,1066,870,1049,818,1023,764,989,715,940,684,850,638,666,552"/>
<area shape="poly" title=" " alt="" coords="673,527,737,521,819,522,863,526,908,534,951,547,992,565,1018,585,1041,609,1073,659,1068,662,1037,613,1015,589,989,570,949,552,906,539,862,531,819,527,737,527,674,532"/>
<area shape="poly" title=" " alt="" coords="644,520,661,492,678,459,688,428,692,401,693,352,694,329,698,305,709,280,727,254,730,251,733,254,731,257,713,283,703,306,699,329,698,352,697,402,693,430,683,461,666,495,648,523"/>
<area shape="poly" title=" " alt="" coords="644,520,768,357,772,361,648,523"/>
<area shape="poly" title=" " alt="" coords="651,548,766,661,762,664,648,552"/>
<area shape="poly" title=" " alt="" coords="673,521,731,502,732,507,674,526"/>
<area shape="poly" title=" " alt="" coords="643,520,678,459,691,416,695,379,703,344,712,325,727,306,730,302,734,306,731,309,716,328,708,345,700,380,696,417,683,461,647,523"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a9741976c80c2167280c9a0c3ff856d2d" title="파일 열기" alt="" coords="434,1003,506,1031"/>
<area shape="poly" title=" " alt="" coords="329,968,420,998,418,1003,327,973"/>
<area shape="poly" title=" " alt="" coords="506,1006,714,956,715,962,507,1011"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a28b88e33bc2ea2e1f024968f35073824" title="파일 읽기" alt="" coords="599,1131,669,1159"/>
<area shape="poly" title=" " alt="" coords="341,1099,584,1135,584,1140,341,1104"/>
<area shape="poly" title=" " alt="" coords="664,1129,679,1116,696,1093,705,1072,713,1050,726,1022,766,966,771,969,731,1025,718,1052,710,1074,701,1096,683,1120,667,1133"/>
<area shape="poly" title=" " alt="" coords="670,1152,734,1166,817,1174,862,1172,906,1166,949,1154,989,1133,1009,1118,1025,1099,1051,1054,1067,1009,1076,969,1082,971,1072,1010,1056,1057,1029,1102,1012,1122,992,1138,951,1159,908,1171,862,1178,817,1179,733,1171,668,1157"/>
<area shape="poly" title=" " alt="" coords="668,1129,735,1098,821,1050,866,1020,910,986,952,948,988,907,1020,859,1044,806,1074,716,1079,717,1049,808,1024,861,992,911,955,952,914,990,869,1024,823,1054,737,1103,670,1134"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#addbb0f0d2e2d634975c40330e23bc8ae" title="디렉터리 내용 읽기" alt="" coords="591,1079,677,1107"/>
<area shape="poly" title=" " alt="" coords="536,1083,575,1086,575,1091,536,1088"/>
<area shape="poly" title=" " alt="" coords="656,1077,679,1059,728,1010,767,965,771,969,731,1014,682,1063,659,1081"/>
<area shape="rect" href="../../de/d32/dir_8c.html#aca2f1f6050fc83a31ced84d12a96b4cb" title="FUSE용 디렉터리 목록 채우기 콜백 호출" alt="" coords="913,1079,978,1107"/>
<area shape="poly" title=" " alt="" coords="678,1090,897,1090,897,1096,678,1096"/>
<area shape="poly" title=" " alt="" coords="967,1077,988,1059,1030,1012,1063,966,1068,970,1035,1015,992,1063,970,1081"/>
<area shape="poly" title=" " alt="" coords="971,1077,988,1060,1007,1006,1032,908,1075,716,1080,717,1037,909,1012,1007,993,1062,974,1080"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#af677d22449626003a22868b28501f79a" title="파일 또는 디렉터리 이름 변경" alt="" coords="589,267,679,295"/>
<area shape="poly" title=" " alt="" coords="351,291,573,281,573,286,351,297"/>
<area shape="poly" title=" " alt="" coords="670,293,683,306,701,352,712,411,717,481,719,556,720,703,723,765,731,814,752,867,775,913,771,915,747,869,726,815,718,765,714,703,713,556,712,481,707,412,696,353,678,309,666,297"/>
<area shape="poly" title=" " alt="" coords="639,265,671,213,696,185,727,164,803,135,838,129,871,128,903,134,933,148,963,169,992,198,1005,217,1016,241,1030,300,1037,370,1039,446,1037,597,1037,662,1041,713,1060,823,1079,911,1074,912,1055,824,1036,713,1032,662,1032,597,1034,446,1031,370,1025,301,1011,243,1001,220,988,201,960,173,931,152,901,139,870,134,838,134,804,140,730,169,700,189,675,216,644,268"/>
<area shape="poly" title=" " alt="" coords="634,266,639,223,654,165,666,134,682,104,702,78,727,56,763,34,797,18,830,7,863,3,895,5,927,15,959,32,992,56,1009,75,1023,101,1046,169,1063,253,1074,345,1085,527,1086,658,1081,658,1080,528,1069,346,1058,253,1041,170,1018,103,1004,78,989,60,956,36,925,20,894,11,863,8,831,13,799,23,765,39,730,61,706,81,686,107,670,136,659,166,644,224,639,267"/>
<area shape="poly" title=" " alt="" coords="677,264,732,246,734,251,679,269"/>
<area shape="poly" title=" " alt="" coords="666,293,682,306,715,343,742,383,780,456,775,458,737,386,710,346,679,310,663,298"/>
<area shape="poly" title=" " alt="" coords="680,278,727,278,727,284,680,284"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a8cf3ec78e9108f22f73ac3ab974fe8dc" title="디렉터리 삭제" alt="" coords="432,875,508,903"/>
<area shape="poly" title=" " alt="" coords="345,857,418,874,417,879,343,862"/>
<area shape="poly" title=" " alt="" coords="509,890,588,899,681,913,718,921,717,926,680,918,587,904,508,895"/>
<area shape="poly" title=" " alt="" coords="510,894,527,902,541,914,561,948,568,982,567,1015,561,1048,557,1079,557,1110,566,1140,589,1168,638,1207,687,1234,735,1249,784,1254,833,1248,884,1232,935,1207,989,1172,1011,1152,1030,1128,1056,1072,1072,1016,1079,970,1084,971,1077,1017,1061,1074,1034,1131,1015,1156,992,1176,938,1212,886,1237,835,1253,784,1259,734,1255,685,1239,635,1212,585,1172,561,1142,551,1111,551,1079,556,1047,562,1015,563,982,556,950,537,917,524,906,507,899"/>
<area shape="poly" title=" " alt="" coords="509,898,541,913,556,927,565,941,573,954,589,964,660,989,690,994,719,995,779,986,852,964,921,915,988,863,1016,826,1039,786,1071,715,1075,717,1044,788,1020,829,992,867,924,919,854,969,780,991,719,1000,689,999,658,994,586,969,570,958,560,944,552,931,538,918,507,902"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#add11b7953b7d14deb0456e14c8d7b197" title="파일 삭제" alt="" coords="594,725,674,752"/>
<area shape="poly" title=" " alt="" coords="485,873,605,761,608,765,489,877"/>
<area shape="poly" title=" " alt="" coords="663,751,683,769,695,788,701,806,706,840,711,873,718,890,731,907,741,917,737,921,727,911,714,892,706,875,701,841,696,808,690,790,679,772,659,754"/>
<area shape="poly" title=" " alt="" coords="660,751,683,768,707,799,731,830,763,856,791,873,820,889,855,914,877,939,887,949,902,957,933,965,966,966,1028,957,1029,962,966,972,933,970,900,962,884,953,873,942,851,918,817,894,788,878,760,860,727,834,702,803,679,772,657,755"/>
<area shape="poly" title=" " alt="" coords="659,751,682,768,705,793,715,803,730,812,763,822,790,823,852,812,924,794,989,761,1025,737,1056,710,1060,714,1029,741,992,766,925,799,854,817,790,828,762,827,728,817,711,808,701,797,679,772,655,755"/>
<area shape="poly" title=" " alt="" coords="674,723,731,704,733,709,675,728"/>
<area shape="poly" title=" " alt="" coords="642,723,771,511,775,514,646,725"/>
<area shape="poly" title=" " alt="" coords="637,724,678,560,684,521,686,487,685,426,686,397,692,369,705,338,727,306,729,303,733,306,731,309,709,341,697,370,691,398,690,426,691,487,690,522,683,562,642,725"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#ad78edd18fe67d2ffa13fbc1fc89436c0" title="슈퍼블록 기반으로 데이터 블록 해제" alt="" coords="746,775,836,803"/>
<area shape="poly" title=" " alt="" coords="675,749,733,768,731,773,674,754"/>
<area shape="poly" title=" " alt="" coords="835,772,895,752,896,757,836,777"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a7f3ad04cc17f3fb58519236a2ee996" title="파일 크기 조정 (truncate)" alt="" coords="423,630,517,658"/>
<area shape="poly" title=" " alt="" coords="353,653,407,647,408,653,354,658"/>
<area shape="poly" title=" " alt="" coords="485,656,528,706,589,762,614,776,637,785,659,794,683,813,700,838,707,861,714,884,731,907,743,917,739,921,727,911,709,886,702,863,695,840,679,816,656,798,635,790,612,781,586,766,524,709,481,660"/>
<area shape="poly" title=" " alt="" coords="518,641,596,648,640,657,682,672,697,681,707,691,730,711,764,725,795,732,824,740,855,762,873,788,880,814,886,838,903,863,931,885,962,902,1025,926,1023,931,959,907,928,889,899,867,881,841,874,815,868,790,851,766,821,745,793,737,763,730,727,715,703,695,694,685,680,677,638,663,596,654,518,646"/>
<area shape="poly" title=" " alt="" coords="517,629,587,616,647,612,709,613,830,625,939,646,1024,667,1023,672,937,651,829,631,709,618,648,617,588,621,518,634"/>
<area shape="poly" title=" " alt="" coords="483,627,537,566,558,534,569,521,586,508,621,493,658,484,728,479,729,484,659,490,622,498,589,513,572,524,563,537,541,569,487,631"/>
<area shape="poly" title=" " alt="" coords="486,628,512,601,537,566,547,544,553,523,557,485,563,448,571,428,585,407,608,387,630,378,653,371,679,356,702,331,712,319,727,306,735,300,738,305,730,310,716,322,706,334,682,360,656,376,632,383,611,392,589,411,576,431,568,450,562,486,558,524,552,546,542,569,516,604,490,631"/>
<area shape="poly" title=" " alt="" coords="519,651,597,673,641,690,682,711,707,732,730,755,747,765,744,770,727,759,703,736,679,715,638,695,596,678,517,656"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#aecadaa463253df28c47f4a201dda2359" title="파일 쓰기" alt="" coords="597,319,671,347"/>
<area shape="poly" title=" " alt="" coords="486,628,513,601,537,566,549,538,555,512,557,464,561,417,570,391,585,363,593,355,597,358,590,367,575,393,567,418,563,465,560,513,554,539,542,569,517,604,490,632"/>
<area shape="poly" title=" " alt="" coords="649,346,667,374,683,408,700,468,708,520,710,611,711,702,717,753,731,814,752,867,776,913,771,915,747,869,726,815,712,754,705,702,705,611,703,521,695,469,678,410,662,376,644,349"/>
<area shape="poly" title=" " alt="" coords="664,317,679,305,688,291,694,278,699,251,706,225,714,213,727,201,765,181,801,169,836,165,870,168,903,179,935,197,964,222,993,254,1012,294,1025,347,1032,409,1035,477,1036,610,1041,713,1061,823,1079,911,1074,912,1055,824,1036,713,1031,610,1029,477,1026,410,1019,348,1007,295,988,257,961,226,931,201,901,184,869,173,836,170,802,174,767,186,730,206,718,216,710,227,704,252,699,279,693,294,683,308,667,321"/>
<area shape="poly" title=" " alt="" coords="665,317,679,305,690,285,696,266,697,228,701,191,710,174,727,158,762,135,796,118,829,107,861,103,894,106,926,116,959,133,992,158,1006,173,1019,194,1040,250,1056,319,1067,395,1081,547,1085,658,1080,659,1076,547,1062,396,1050,320,1034,251,1014,197,1002,176,989,162,956,138,924,121,893,111,861,109,830,113,798,123,765,139,730,162,715,177,706,193,703,228,701,267,695,287,683,308,668,321"/>
<area shape="poly" title=" " alt="" coords="661,316,679,304,702,279,712,267,727,254,735,248,738,253,730,258,716,270,706,282,682,308,664,321"/>
<area shape="poly" title=" " alt="" coords="651,345,766,458,762,462,648,349"/>
<area shape="poly" title=" " alt="" coords="670,318,731,298,733,303,672,323"/>
<area shape="poly" title=" " alt="" coords="346,736,579,736,579,741,346,741"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a818f99fae8ad5abcc450d41aac5d37ec" title="파일의 시간 속성 변경 (utimens)" alt="" coords="587,927,681,955"/>
<area shape="poly" title=" " alt="" coords="540,938,572,938,572,944,540,944"/>
<area shape="poly" title=" " alt="" coords="681,938,713,938,713,944,681,944"/>
<area shape="poly" title=" " alt="" coords="652,953,691,989,750,1036,822,1082,862,1101,902,1116,947,1128,967,1126,989,1116,1007,1102,1023,1086,1048,1046,1065,1005,1075,969,1080,971,1070,1007,1053,1049,1027,1089,1011,1106,992,1121,968,1131,947,1133,900,1121,859,1106,820,1086,747,1040,688,993,648,957"/>
<area shape="poly" title=" " alt="" coords="644,925,661,897,678,864,697,809,705,764,713,719,726,662,776,512,781,514,731,663,718,720,711,765,702,810,683,866,666,900,648,928"/>
<area shape="poly" title=" " alt="" coords="343,356,582,335,582,340,343,361"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_icgraph.png" border="0" usemap="#adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_icgraph" loading="lazy" alt=""/></div>
<map name="adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_icgraph" id="adf/d26/fs_8h_a7f093e2e9259d0b6002f4da685de854d_icgraph">
<area shape="rect" title="SFUSE용 FUSE operations 구조체 반환" alt="" coords="108,5,268,33"/>
<area shape="rect" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="SFUSE 엔트리 포인트" alt="" coords="5,5,60,33"/>
<area shape="poly" title=" " alt="" coords="92,22,60,22,60,16,92,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a href="../../df/d26/fs_8h.html">fs.h</a></li>
    <li class="footer">다음에 의해 생성됨 :  <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
