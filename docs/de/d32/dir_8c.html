<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SFUSE_Documentation: src/dir.c 파일 참조</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SFUSE_Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','검색',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('de/d32/dir_8c.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">로딩중...</div>
<div class="SRStatus" id="Searching">검색중...</div>
<div class="SRStatus" id="NoMatches">일치하는것 없음</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">dir.c 파일 참조</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d9c/dir_8h_source.html">dir.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/dcb/bitmap_8h_source.html">bitmap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d40/block_8h_source.html">block.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d1d/img_8h_source.html">img.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d73/inode_8h_source.html">inode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d98/super_8h_source.html">super.h</a>&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
dir.c에 대한 include 의존 그래프</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d52/dir_8c__incl.png" border="0" usemap="#asrc_2dir_8c" loading="lazy" alt=""/></div>
<map name="asrc_2dir_8c" id="asrc_2dir_8c">
<area shape="rect" title=" " alt="" coords="622,5,694,33"/>
<area shape="rect" href="../../df/d9c/dir_8h.html" title=" " alt="" coords="202,81,253,109"/>
<area shape="poly" title=" " alt="" coords="622,27,469,48,272,84,268,85,267,79,271,78,468,43,621,22"/>
<area shape="rect" href="../../d3/d73/inode_8h.html" title=" " alt="" coords="82,157,152,184"/>
<area shape="poly" title=" " alt="" coords="622,24,524,30,398,40,276,58,227,69,192,83,174,96,158,112,133,145,129,142,154,108,170,92,189,79,225,64,275,52,397,35,524,24,621,19"/>
<area shape="rect" href="../../db/d98/super_8h.html" title=" " alt="" coords="320,232,389,260"/>
<area shape="poly" title=" " alt="" coords="622,27,525,45,469,61,414,83,357,112,337,129,319,158,316,173,318,189,335,219,330,222,313,191,311,173,315,156,333,126,354,107,412,79,467,56,524,40,621,22"/>
<area shape="rect" title=" " alt="" coords="455,308,526,336"/>
<area shape="poly" title=" " alt="" coords="680,31,715,58,751,95,766,117,775,139,776,163,769,186,748,215,723,239,694,260,662,277,598,301,542,315,540,310,597,296,660,272,691,255,719,235,744,211,764,183,771,162,769,140,761,119,747,99,711,62,677,35"/>
<area shape="rect" href="../../da/dcb/bitmap_8h.html" title=" " alt="" coords="425,81,505,109"/>
<area shape="poly" title=" " alt="" coords="625,36,514,78,512,73,623,31"/>
<area shape="rect" href="../../de/d40/block_8h.html" title=" " alt="" coords="532,232,600,260"/>
<area shape="poly" title=" " alt="" coords="650,35,619,82,592,155,575,218,570,217,587,153,615,80,646,32"/>
<area shape="rect" href="../../df/d1d/img_8h.html" title=" " alt="" coords="629,81,688,109"/>
<area shape="poly" title=" " alt="" coords="661,34,661,65,656,65,656,34"/>
<area shape="rect" title=" " alt="" coords="680,157,754,184"/>
<area shape="poly" title=" " alt="" coords="672,32,688,54,702,80,712,111,717,141,712,142,707,112,697,82,683,56,667,35"/>
<area shape="rect" title=" " alt="" coords="821,81,888,109"/>
<area shape="poly" title=" " alt="" coords="694,31,807,73,805,78,692,36"/>
<area shape="rect" title=" " alt="" coords="912,81,981,109"/>
<area shape="poly" title=" " alt="" coords="695,27,897,78,896,83,694,32"/>
<area shape="rect" title=" " alt="" coords="1004,81,1075,109"/>
<area shape="poly" title=" " alt="" coords="695,23,822,45,990,78,989,83,821,50,694,29"/>
<area shape="poly" title=" " alt="" coords="209,111,150,150,147,146,206,107"/>
<area shape="poly" title=" " alt="" coords="234,108,249,144,274,183,296,204,320,222,316,226,292,208,270,186,245,146,230,110"/>
<area shape="poly" title=" " alt="" coords="231,109,237,144,250,183,274,226,309,258,341,276,375,291,441,309,439,315,373,296,339,281,306,262,269,229,245,185,232,145,226,110"/>
<area shape="rect" title=" " alt="" coords="328,157,402,184"/>
<area shape="poly" title=" " alt="" coords="253,107,329,147,326,152,251,112"/>
<area shape="poly" title=" " alt="" coords="153,180,305,227,304,232,151,185"/>
<area shape="poly" title=" " alt="" coords="123,183,140,221,154,241,172,258,192,268,220,278,292,294,440,313,439,319,291,299,219,283,190,273,169,262,150,245,136,224,118,185"/>
<area shape="rect" title=" " alt="" coords="5,232,101,260"/>
<area shape="poly" title=" " alt="" coords="108,187,76,222,72,219,104,183"/>
<area shape="poly" title=" " alt="" coords="380,258,454,298,452,303,377,263"/>
<area shape="poly" title=" " alt="" coords="461,110,443,145,416,186,382,223,378,220,412,183,438,142,457,108"/>
<area shape="poly" title=" " alt="" coords="469,109,490,292,484,293,464,109"/>
<area shape="poly" title=" " alt="" coords="449,111,396,150,393,145,446,107"/>
<area shape="poly" title=" " alt="" coords="555,262,516,299,513,295,551,259"/>
<area shape="poly" title=" " alt="" coords="633,111,396,228,393,223,631,107"/>
<area shape="poly" title=" " alt="" coords="661,109,659,139,652,179,638,222,615,262,599,278,580,291,541,309,539,304,578,286,596,273,611,258,633,220,647,178,653,139,656,109"/>
<area shape="poly" title=" " alt="" coords="671,108,699,143,695,146,667,111"/>
</map>
</div>
</div>
<p><a href="../../de/d32/dir_8c_source.html">이 파일의 소스 코드 페이지로 가기</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
함수</h2></td></tr>
<tr class="memitem:ac2f55242043759c79ce3aaa895ffbd6b" id="r_ac2f55242043759c79ce3aaa895ffbd6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2f55242043759c79ce3aaa895ffbd6b">dir_load</a> (int fd, const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *sb, uint32_t ino, void *buf)</td></tr>
<tr class="memdesc:ac2f55242043759c79ce3aaa895ffbd6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리 블록들을 모두 읽어들임  <br /></td></tr>
<tr class="memitem:a46039c7666b2dae1401a0b3e8ad5f1f1" id="r_a46039c7666b2dae1401a0b3e8ad5f1f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46039c7666b2dae1401a0b3e8ad5f1f1">dir_add_entry</a> (int fd, const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *sb, uint32_t ino, const char *name, uint32_t child_ino, uint8_t *block_map, uint8_t *inode_map, struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *supermap)</td></tr>
<tr class="memdesc:a46039c7666b2dae1401a0b3e8ad5f1f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리에 새 엔트리 추가  <br /></td></tr>
<tr class="memitem:a6d70dfe2356e0eefe891a57e11c62e16" id="r_a6d70dfe2356e0eefe891a57e11c62e16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d70dfe2356e0eefe891a57e11c62e16">dir_remove_entry</a> (int fd, const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *sb, uint32_t ino, const char *name)</td></tr>
<tr class="memdesc:a6d70dfe2356e0eefe891a57e11c62e16"><td class="mdescLeft">&#160;</td><td class="mdescRight">디렉터리 엔트리 삭제  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">함수 문서화</h2>
<a id="a46039c7666b2dae1401a0b3e8ad5f1f1" name="a46039c7666b2dae1401a0b3e8ad5f1f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46039c7666b2dae1401a0b3e8ad5f1f1">&#9670;&#160;</a></span>dir_add_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_add_entry </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *</td>          <td class="paramname"><span class="paramname"><em>sb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>ino</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>child_ino</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>block_map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>inode_map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *</td>          <td class="paramname"><span class="paramname"><em>supermap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리에 새 엔트리 추가 </p>
<p>dir_add_entry: 디렉터리에 새 엔트리 추가 </p>

<p class="definition"><a class="el" href="../../de/d32/dir_8c_source.html">dir.c</a> 파일의 <a class="el" href="../../de/d32/dir_8c_source.html#l00035">35</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>                                                                    {</div>
<div class="line"><span class="lineno">   38</span>  <span class="comment">// 디렉터리 아이노드 로드</span></div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordtype">int</span> res = <a class="code hl_function" href="../../d3/d73/inode_8h.html#a72a6e85b07ee4130a233e0db78fc95fe">inode_load</a>(fd, sb, ino, &amp;inode);</div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">if</span> (res &lt; 0)</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">// 디렉터리 블록 전체 로드</span></div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordtype">size_t</span> buf_size = <a class="code hl_define" href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a> * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>;</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordtype">void</span> *buf = malloc(buf_size);</div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordflow">if</span> (!buf)</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">   49</span>  res = <a class="code hl_function" href="#ac2f55242043759c79ce3aaa895ffbd6b">dir_load</a>(fd, sb, ino, buf);</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line"><span class="lineno">   51</span>    free(buf);</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   53</span>  }</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *ents = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)buf;</div>
<div class="line"><span class="lineno">   56</span>  uint32_t max_entries = buf_size / <span class="keyword">sizeof</span>(*ents);</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// 빈 슬롯 찾기</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; max_entries; i++) {</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> (ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a99c72c6a3e99c1f963e6cac40c25533a">ino</a> == 0) {</div>
<div class="line"><span class="lineno">   61</span>      ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a99c72c6a3e99c1f963e6cac40c25533a">ino</a> = child_ino;</div>
<div class="line"><span class="lineno">   62</span>      strncpy(ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>, <span class="keyword">sizeof</span>(ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>) - 1);</div>
<div class="line"><span class="lineno">   63</span>      ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>[<span class="keyword">sizeof</span>(ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>      <span class="comment">// 모든 블록에 다시 기록</span></div>
<div class="line"><span class="lineno">   66</span>      <span class="keywordflow">for</span> (uint32_t b = 0; b &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a>; b++) {</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">if</span> (inode.direct[b] == 0)</div>
<div class="line"><span class="lineno">   68</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   69</span>        res = <a class="code hl_function" href="../../de/d40/block_8h.html#a68fff59f4eeded5f354caed94cd27f12">write_block</a>(fd, inode.direct[b],</div>
<div class="line"><span class="lineno">   70</span>                          (<span class="keywordtype">char</span> *)buf + b * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">   71</span>        <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line"><span class="lineno">   72</span>          free(buf);</div>
<div class="line"><span class="lineno">   73</span>          <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   74</span>        }</div>
<div class="line"><span class="lineno">   75</span>      }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>      <span class="comment">// 슈퍼블록 및 비트맵 동기화</span></div>
<div class="line"><span class="lineno">   78</span>      <a class="code hl_function" href="../../db/d98/super_8h.html#a90dace97e8d65a597b6d660e0d5b2170">sb_sync</a>(fd, supermap);</div>
<div class="line"><span class="lineno">   79</span>      <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a227b256c17ea31f9c7743f3abc35966f">bitmap_sync</a>(fd, sb-&gt;<a class="code hl_variable" href="../../da/d50/structsfuse__super.html#a0f3c93e1295e95f48787c8b2d6adb7f5">block_bitmap_start</a>, block_map, sb-&gt;<a class="code hl_variable" href="../../da/d50/structsfuse__super.html#a1beda11a6d52ccf0351e22d81b50a20d">blocks_count</a> / 8);</div>
<div class="line"><span class="lineno">   80</span>      <a class="code hl_function" href="../../da/dcb/bitmap_8h.html#a227b256c17ea31f9c7743f3abc35966f">bitmap_sync</a>(fd, sb-&gt;<a class="code hl_variable" href="../../da/d50/structsfuse__super.html#ad08b4df84f43d7d6738c5f25b22e5829">inode_bitmap_start</a>, inode_map, sb-&gt;<a class="code hl_variable" href="../../da/d50/structsfuse__super.html#a6ea0f291f1292da7a86611336d28d36f">inodes_count</a> / 8);</div>
<div class="line"><span class="lineno">   81</span>      free(buf);</div>
<div class="line"><span class="lineno">   82</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   83</span>    }</div>
<div class="line"><span class="lineno">   84</span>  }</div>
<div class="line"><span class="lineno">   85</span>  free(buf);</div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line"><span class="lineno">   87</span>}</div>
<div class="ttc" id="abitmap_8h_html_a227b256c17ea31f9c7743f3abc35966f"><div class="ttname"><a href="../../da/dcb/bitmap_8h.html#a227b256c17ea31f9c7743f3abc35966f">bitmap_sync</a></div><div class="ttdeci">int bitmap_sync(int fd, uint32_t block_no, uint8_t *map, size_t map_size)</div><div class="ttdoc">비트맵 데이터를 디스크에 기록</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9a/bitmap_8c_source.html#l00035">bitmap.c:35</a></div></div>
<div class="ttc" id="ablock_8h_html_a68fff59f4eeded5f354caed94cd27f12"><div class="ttname"><a href="../../de/d40/block_8h.html#a68fff59f4eeded5f354caed94cd27f12">write_block</a></div><div class="ttdeci">int write_block(int fd, uint32_t block_no, const void *buf)</div><div class="ttdoc">디바이스에 블록 단위(4KB)로 쓰기</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d1c/block_8c_source.html#l00033">block.c:33</a></div></div>
<div class="ttc" id="adir_8c_html_ac2f55242043759c79ce3aaa895ffbd6b"><div class="ttname"><a href="#ac2f55242043759c79ce3aaa895ffbd6b">dir_load</a></div><div class="ttdeci">int dir_load(int fd, const struct sfuse_super *sb, uint32_t ino, void *buf)</div><div class="ttdoc">디렉터리 블록들을 모두 읽어들임</div><div class="ttdef"><b>Definition</b> <a href="../../de/d32/dir_8c_source.html#l00017">dir.c:17</a></div></div>
<div class="ttc" id="ainode_8h_html_a72a6e85b07ee4130a233e0db78fc95fe"><div class="ttname"><a href="../../d3/d73/inode_8h.html#a72a6e85b07ee4130a233e0db78fc95fe">inode_load</a></div><div class="ttdeci">int inode_load(int fd, const struct sfuse_super *sb, uint32_t ino, struct sfuse_inode *inode)</div><div class="ttdoc">디스크에서 아이노드 읽기</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d2b/inode_8c_source.html#l00013">inode.c:13</a></div></div>
<div class="ttc" id="ainode_8h_html_ad8e7218c1f4e716d890d13bcba484ea3"><div class="ttname"><a href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a></div><div class="ttdeci">#define SFUSE_NDIR_BLOCKS</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00010">inode.h:10</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a></div><div class="ttdoc">디렉터리 엔트리 구조체 ino: 저장된 아이노드 번호 (0이면 빈 슬롯) name: NULL 종단 문자열 (최대 SFUSE_NAME_LEN)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00017">dir.h:17</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html_a7f18e59aff64f060b49301cb9ac50bab"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">sfuse_dirent::name</a></div><div class="ttdeci">char name[255+1]</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00019">dir.h:19</a></div></div>
<div class="ttc" id="astructsfuse__dirent_html_a99c72c6a3e99c1f963e6cac40c25533a"><div class="ttname"><a href="../../d8/d1a/structsfuse__dirent.html#a99c72c6a3e99c1f963e6cac40c25533a">sfuse_dirent::ino</a></div><div class="ttdeci">uint32_t ino</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9c/dir_8h_source.html#l00018">dir.h:18</a></div></div>
<div class="ttc" id="astructsfuse__inode_html"><div class="ttname"><a href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a></div><div class="ttdoc">아이노드 구조체</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d73/inode_8h_source.html#l00015">inode.h:15</a></div></div>
<div class="ttc" id="astructsfuse__super_html_a0f3c93e1295e95f48787c8b2d6adb7f5"><div class="ttname"><a href="../../da/d50/structsfuse__super.html#a0f3c93e1295e95f48787c8b2d6adb7f5">sfuse_super::block_bitmap_start</a></div><div class="ttdeci">uint32_t block_bitmap_start</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00029">super.h:29</a></div></div>
<div class="ttc" id="astructsfuse__super_html_a1beda11a6d52ccf0351e22d81b50a20d"><div class="ttname"><a href="../../da/d50/structsfuse__super.html#a1beda11a6d52ccf0351e22d81b50a20d">sfuse_super::blocks_count</a></div><div class="ttdeci">uint32_t blocks_count</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00025">super.h:25</a></div></div>
<div class="ttc" id="astructsfuse__super_html_a6ea0f291f1292da7a86611336d28d36f"><div class="ttname"><a href="../../da/d50/structsfuse__super.html#a6ea0f291f1292da7a86611336d28d36f">sfuse_super::inodes_count</a></div><div class="ttdeci">uint32_t inodes_count</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00024">super.h:24</a></div></div>
<div class="ttc" id="astructsfuse__super_html_ad08b4df84f43d7d6738c5f25b22e5829"><div class="ttname"><a href="../../da/d50/structsfuse__super.html#ad08b4df84f43d7d6738c5f25b22e5829">sfuse_super::inode_bitmap_start</a></div><div class="ttdeci">uint32_t inode_bitmap_start</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00028">super.h:28</a></div></div>
<div class="ttc" id="asuper_8h_html_a0f31825083a6f1e0e2f5b5a2fd1181aa"><div class="ttname"><a href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a></div><div class="ttdeci">#define SFUSE_BLOCK_SIZE</div><div class="ttdef"><b>Definition</b> <a href="../../db/d98/super_8h_source.html#l00008">super.h:8</a></div></div>
<div class="ttc" id="asuper_8h_html_a90dace97e8d65a597b6d660e0d5b2170"><div class="ttname"><a href="../../db/d98/super_8h.html#a90dace97e8d65a597b6d660e0d5b2170">sb_sync</a></div><div class="ttdeci">int sb_sync(int fd, const struct sfuse_super *sb)</div><div class="ttdoc">슈퍼블록 구조체를 디스크에 기록</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d1d/super_8c_source.html#l00031">super.c:31</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_cgraph.png" border="0" usemap="#ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_cgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_cgraph" id="ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_cgraph">
<area shape="rect" title="디렉터리에 새 엔트리 추가" alt="" coords="5,109,116,137"/>
<area shape="rect" href="../../df/d9a/bitmap_8c.html#a227b256c17ea31f9c7743f3abc35966f" title="비트맵 데이터를 디스크에 기록" alt="" coords="164,5,268,33"/>
<area shape="poly" title=" " alt="" coords="77,107,115,77,162,44,170,39,173,43,165,48,119,81,81,111"/>
<area shape="rect" href="../../de/d32/dir_8c.html#ac2f55242043759c79ce3aaa895ffbd6b" title="디렉터리 블록들을 모두 읽어들임" alt="" coords="179,161,252,189"/>
<area shape="poly" title=" " alt="" coords="105,135,165,156,164,161,103,140"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a72a6e85b07ee4130a233e0db78fc95fe" title="디스크에서 아이노드 읽기" alt="" coords="316,212,408,240"/>
<area shape="poly" title=" " alt="" coords="77,135,115,168,139,185,165,198,198,209,234,217,301,223,300,229,233,222,197,214,163,203,136,189,111,172,74,139"/>
<area shape="rect" href="../../d2/d1d/super_8c.html#a90dace97e8d65a597b6d660e0d5b2170" title="슈퍼블록 구조체를 디스크에 기록" alt="" coords="179,57,252,85"/>
<area shape="poly" title=" " alt="" coords="103,106,164,86,165,91,105,111"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a68fff59f4eeded5f354caed94cd27f12" title="디바이스에 블록 단위(4KB)로 쓰기" alt="" coords="168,109,264,137"/>
<area shape="poly" title=" " alt="" coords="116,120,152,120,152,126,116,126"/>
<area shape="rect" href="../../d1/d3e/img_8c.html#ad1abb87bbd6acc052bc498cd3d8f3278" title="원시 디바이스에 특정 오프셋만큼 쓰기" alt="" coords="319,57,405,85"/>
<area shape="poly" title=" " alt="" coords="258,31,308,49,306,54,256,36"/>
<area shape="poly" title=" " alt="" coords="254,185,306,204,305,209,252,190"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a8a7cedcc55adf1eeb0a4d2d05cf4b795" title="디바이스에서 블록 단위(4KB)로 읽기" alt="" coords="316,160,408,188"/>
<area shape="poly" title=" " alt="" coords="253,172,300,172,301,177,253,178"/>
<area shape="rect" href="../../d1/d3e/img_8c.html#ab5f174b2ac56c4370d34760eebb328ad" title="원시 디바이스에서 특정 오프셋만큼 읽기" alt="" coords="456,187,539,214"/>
<area shape="poly" title=" " alt="" coords="408,215,441,208,442,214,409,220"/>
<area shape="poly" title=" " alt="" coords="409,180,442,187,441,192,408,186"/>
<area shape="poly" title=" " alt="" coords="253,68,304,68,304,74,253,74"/>
<area shape="poly" title=" " alt="" coords="256,106,306,88,308,93,258,111"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_icgraph.png" border="0" usemap="#ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_icgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_icgraph" id="ade/d32/dir_8c_a46039c7666b2dae1401a0b3e8ad5f1f1_icgraph">
<area shape="rect" title="디렉터리에 새 엔트리 추가" alt="" coords="189,57,299,85"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e" title=" " alt="" coords="10,5,136,33"/>
<area shape="poly" title=" " alt="" coords="181,55,120,36,122,31,182,50"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f" title=" " alt="" coords="11,57,135,85"/>
<area shape="poly" title=" " alt="" coords="173,74,135,74,135,68,173,68"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a40eb26b6c59a422e4ad1e906dff00037" title=" " alt="" coords="5,109,141,137"/>
<area shape="poly" title=" " alt="" coords="182,93,122,111,120,106,181,87"/>
</map>
</div>

</div>
</div>
<a id="ac2f55242043759c79ce3aaa895ffbd6b" name="ac2f55242043759c79ce3aaa895ffbd6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2f55242043759c79ce3aaa895ffbd6b">&#9670;&#160;</a></span>dir_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_load </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *</td>          <td class="paramname"><span class="paramname"><em>sb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>ino</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리 블록들을 모두 읽어들임 </p>
<p>dir_load: 디렉터리 데이터 블록들을 모두 읽어서 버퍼에 로드 </p>

<p class="definition"><a class="el" href="../../de/d32/dir_8c_source.html">dir.c</a> 파일의 <a class="el" href="../../de/d32/dir_8c_source.html#l00017">17</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>                                                                            {</div>
<div class="line"><span class="lineno">   18</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">   19</span>  <span class="keywordtype">int</span> res = <a class="code hl_function" href="../../d3/d73/inode_8h.html#a72a6e85b07ee4130a233e0db78fc95fe">inode_load</a>(fd, sb, ino, &amp;inode);</div>
<div class="line"><span class="lineno">   20</span>  <span class="keywordflow">if</span> (res &lt; 0)</div>
<div class="line"><span class="lineno">   21</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   22</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a>; i++) {</div>
<div class="line"><span class="lineno">   23</span>    <span class="keywordflow">if</span> (inode.direct[i] == 0)</div>
<div class="line"><span class="lineno">   24</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   25</span>    res = <a class="code hl_function" href="../../de/d40/block_8h.html#a8a7cedcc55adf1eeb0a4d2d05cf4b795">read_block</a>(fd, inode.direct[i], (<span class="keywordtype">char</span> *)buf + i * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (res &lt; 0)</div>
<div class="line"><span class="lineno">   27</span>      <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   28</span>  }</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   30</span>}</div>
<div class="ttc" id="ablock_8h_html_a8a7cedcc55adf1eeb0a4d2d05cf4b795"><div class="ttname"><a href="../../de/d40/block_8h.html#a8a7cedcc55adf1eeb0a4d2d05cf4b795">read_block</a></div><div class="ttdeci">int read_block(int fd, uint32_t block_no, void *buf)</div><div class="ttdoc">디바이스에서 블록 단위(4KB)로 읽기</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d1c/block_8c_source.html#l00016">block.c:16</a></div></div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_cgraph.png" border="0" usemap="#ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_cgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_cgraph" id="ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_cgraph">
<area shape="rect" title="디렉터리 블록들을 모두 읽어들임" alt="" coords="5,32,79,60"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a72a6e85b07ee4130a233e0db78fc95fe" title="디스크에서 아이노드 읽기" alt="" coords="127,5,219,33"/>
<area shape="poly" title=" " alt="" coords="78,36,111,29,112,34,80,41"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a8a7cedcc55adf1eeb0a4d2d05cf4b795" title="디바이스에서 블록 단위(4KB)로 읽기" alt="" coords="127,57,219,85"/>
<area shape="poly" title=" " alt="" coords="80,50,112,57,111,62,79,56"/>
<area shape="rect" href="../../d1/d3e/img_8c.html#ab5f174b2ac56c4370d34760eebb328ad" title="원시 디바이스에서 특정 오프셋만큼 읽기" alt="" coords="267,32,349,60"/>
<area shape="poly" title=" " alt="" coords="220,26,252,32,251,37,219,31"/>
<area shape="poly" title=" " alt="" coords="219,60,251,54,252,59,220,65"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_icgraph.png" border="0" usemap="#ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_icgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_icgraph" id="ade/d32/dir_8c_ac2f55242043759c79ce3aaa895ffbd6b_icgraph">
<area shape="rect" title="디렉터리 블록들을 모두 읽어들임" alt="" coords="548,160,622,188"/>
<area shape="rect" href="../../de/d32/dir_8c.html#a46039c7666b2dae1401a0b3e8ad5f1f1" title="디렉터리에 새 엔트리 추가" alt="" coords="203,7,314,34"/>
<area shape="poly" title=" " alt="" coords="542,155,445,105,327,50,297,37,299,32,329,45,447,100,545,150"/>
<area shape="rect" href="../../de/d32/dir_8c.html#a6d70dfe2356e0eefe891a57e11c62e16" title="디렉터리 엔트리 삭제" alt="" coords="190,160,326,188"/>
<area shape="poly" title=" " alt="" coords="533,176,327,176,327,171,533,171"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#aba575ee5529edea958cfbb7926a4f6c0" title="경로를 아이노드 번호로 해석" alt="" coords="376,368,500,396"/>
<area shape="poly" title=" " alt="" coords="567,202,452,369,447,366,563,199"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6dc52b86f2cef1906558a324213cac6e" title=" " alt="" coords="10,57,136,85"/>
<area shape="poly" title=" " alt="" coords="192,41,127,59,126,54,190,36"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acac9f9c69134190f86e015e89e39d43f" title=" " alt="" coords="11,5,135,33"/>
<area shape="poly" title=" " alt="" coords="188,23,135,22,135,17,188,17"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a40eb26b6c59a422e4ad1e906dff00037" title=" " alt="" coords="5,109,141,137"/>
<area shape="poly" title=" " alt="" coords="199,44,190,49,176,61,167,73,157,86,142,99,119,111,117,106,139,94,153,82,163,70,172,58,187,45,197,39"/>
<area shape="poly" title=" " alt="" coords="190,158,126,140,127,135,192,153"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title=" " alt="" coords="13,213,133,241"/>
<area shape="poly" title=" " alt="" coords="194,195,125,215,123,210,192,190"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c" title=" " alt="" coords="10,161,136,189"/>
<area shape="poly" title=" " alt="" coords="175,177,136,177,136,172,174,172"/>
<area shape="poly" title=" " alt="" coords="430,353,420,307,400,251,370,195,350,171,327,151,283,129,234,117,186,114,141,116,141,110,186,108,235,112,285,124,329,146,354,167,374,192,405,249,425,306,435,352"/>
<area shape="poly" title=" " alt="" coords="431,411,417,447,396,488,367,527,350,544,329,557,291,575,257,583,223,577,187,557,151,524,123,483,103,437,88,390,74,302,71,241,77,241,79,302,94,389,108,435,128,480,155,520,190,553,225,572,257,577,290,570,327,553,346,540,363,523,392,485,413,445,426,409"/>
<area shape="poly" title=" " alt="" coords="425,411,388,466,361,493,329,514,290,530,255,539,221,534,187,513,170,496,157,477,146,440,147,402,155,363,163,323,167,283,161,243,152,224,139,204,124,191,128,187,143,200,157,221,166,242,172,283,169,324,160,364,153,403,151,440,162,475,174,492,190,509,223,529,255,533,288,525,327,509,358,489,384,463,421,408"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a7f58173fe2f2486a7dee9e5e78a9e998" title="전체 경로를 부모 아이노드와 이름으로 분할" alt="" coords="206,59,310,86"/>
<area shape="poly" title=" " alt="" coords="430,354,419,302,400,236,370,168,350,135,326,106,302,89,305,85,330,103,354,132,374,165,405,235,425,301,435,352"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf365c5992fb91ebb3982a04fbbdf3b4" title=" " alt="" coords="194,624,323,652"/>
<area shape="poly" title=" " alt="" coords="432,411,419,453,398,505,368,559,330,608,304,626,301,621,326,604,364,556,393,503,414,452,427,409"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a6c01c3409d41549c5ca34b9a2f64ccfe" title=" " alt="" coords="194,676,323,704"/>
<area shape="poly" title=" " alt="" coords="436,412,426,465,407,532,376,603,355,636,330,665,312,678,309,673,326,661,351,632,371,600,402,530,421,464,431,411"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a62bb834f4955786318b1c8588cbb0135" title=" " alt="" coords="200,212,317,240"/>
<area shape="poly" title=" " alt="" coords="418,356,379,305,354,278,326,255,305,243,307,238,330,250,358,274,384,302,422,353"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a4e8379279e62363763d8c7da873361d7" title=" " alt="" coords="201,264,316,292"/>
<area shape="poly" title=" " alt="" coords="406,360,369,333,327,307,300,295,303,290,329,302,372,329,409,356"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acdaffbb59b5fe7d0ceda916714ddc3ad" title=" " alt="" coords="193,316,324,344"/>
<area shape="poly" title=" " alt="" coords="372,366,308,347,310,342,374,361"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a042aaedab092b188556e193b25a81e9f" title=" " alt="" coords="189,368,328,396"/>
<area shape="poly" title=" " alt="" coords="360,384,328,384,328,379,360,379"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a7e84e199a67a156f1c4f3b9a85d46ad9" title=" " alt="" coords="189,420,328,448"/>
<area shape="poly" title=" " alt="" coords="374,403,310,422,308,417,372,398"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad4c968c1ab3a4b7e7c8b36054266f59" title=" " alt="" coords="199,472,318,500"/>
<area shape="poly" title=" " alt="" coords="409,408,372,435,329,462,303,474,300,469,327,457,369,431,406,403"/>
<area shape="poly" title=" " alt="" coords="190,75,136,74,136,69,191,69"/>
<area shape="poly" title=" " alt="" coords="192,56,123,36,125,31,194,51"/>
<area shape="poly" title=" " alt="" coords="192,93,127,111,126,106,191,88"/>
<area shape="poly" title=" " alt="" coords="236,100,142,203,120,215,117,210,139,198,232,96"/>
<area shape="poly" title=" " alt="" coords="227,98,142,151,115,163,113,158,139,146,224,93"/>
</map>
</div>

</div>
</div>
<a id="a6d70dfe2356e0eefe891a57e11c62e16" name="a6d70dfe2356e0eefe891a57e11c62e16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d70dfe2356e0eefe891a57e11c62e16">&#9670;&#160;</a></span>dir_remove_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_remove_entry </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../da/d50/structsfuse__super.html">sfuse_super</a> *</td>          <td class="paramname"><span class="paramname"><em>sb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>ino</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>디렉터리 엔트리 삭제 </p>
<p>dir_remove_entry: 디렉터리에서 엔트리 삭제 </p>

<p class="definition"><a class="el" href="../../de/d32/dir_8c_source.html">dir.c</a> 파일의 <a class="el" href="../../de/d32/dir_8c_source.html#l00092">92</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>                                       {</div>
<div class="line"><span class="lineno">   94</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d2/d13/structsfuse__inode.html">sfuse_inode</a> inode;</div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordtype">int</span> res = <a class="code hl_function" href="../../d3/d73/inode_8h.html#a72a6e85b07ee4130a233e0db78fc95fe">inode_load</a>(fd, sb, ino, &amp;inode);</div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">if</span> (res &lt; 0)</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordtype">size_t</span> buf_size = <a class="code hl_define" href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a> * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>;</div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordtype">void</span> *buf = malloc(buf_size);</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordflow">if</span> (!buf)</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><span class="lineno">  103</span>  res = <a class="code hl_function" href="#ac2f55242043759c79ce3aaa895ffbd6b">dir_load</a>(fd, sb, ino, buf);</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line"><span class="lineno">  105</span>    free(buf);</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  107</span>  }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *ents = (<span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d1a/structsfuse__dirent.html">sfuse_dirent</a> *)buf;</div>
<div class="line"><span class="lineno">  110</span>  uint32_t max_entries = buf_size / <span class="keyword">sizeof</span>(*ents);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; max_entries; i++) {</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span> (ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a99c72c6a3e99c1f963e6cac40c25533a">ino</a> != 0 &amp;&amp; strcmp(ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>, <a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>) == 0) {</div>
<div class="line"><span class="lineno">  114</span>      ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a99c72c6a3e99c1f963e6cac40c25533a">ino</a> = 0;</div>
<div class="line"><span class="lineno">  115</span>      ents[i].<a class="code hl_variable" href="../../d8/d1a/structsfuse__dirent.html#a7f18e59aff64f060b49301cb9ac50bab">name</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>      <span class="comment">// 해당 블록들에 기록</span></div>
<div class="line"><span class="lineno">  118</span>      <span class="keywordflow">for</span> (uint32_t b = 0; b &lt; <a class="code hl_define" href="../../d3/d73/inode_8h.html#ad8e7218c1f4e716d890d13bcba484ea3">SFUSE_NDIR_BLOCKS</a>; b++) {</div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">if</span> (inode.direct[b] == 0)</div>
<div class="line"><span class="lineno">  120</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  121</span>        res = <a class="code hl_function" href="../../de/d40/block_8h.html#a68fff59f4eeded5f354caed94cd27f12">write_block</a>(fd, inode.direct[b],</div>
<div class="line"><span class="lineno">  122</span>                          (<span class="keywordtype">char</span> *)buf + b * <a class="code hl_define" href="../../db/d98/super_8h.html#a0f31825083a6f1e0e2f5b5a2fd1181aa">SFUSE_BLOCK_SIZE</a>);</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line"><span class="lineno">  124</span>          free(buf);</div>
<div class="line"><span class="lineno">  125</span>          <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  126</span>        }</div>
<div class="line"><span class="lineno">  127</span>      }</div>
<div class="line"><span class="lineno">  128</span>      free(buf);</div>
<div class="line"><span class="lineno">  129</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  130</span>    }</div>
<div class="line"><span class="lineno">  131</span>  }</div>
<div class="line"><span class="lineno">  132</span>  free(buf);</div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">return</span> -ENOENT;</div>
<div class="line"><span class="lineno">  134</span>}</div>
</div><!-- fragment --><div class="dynheader">
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_cgraph.png" border="0" usemap="#ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_cgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_cgraph" id="ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_cgraph">
<area shape="rect" title="디렉터리 엔트리 삭제" alt="" coords="5,57,142,85"/>
<area shape="rect" href="../../de/d32/dir_8c.html#ac2f55242043759c79ce3aaa895ffbd6b" title="디렉터리 블록들을 모두 읽어들임" alt="" coords="201,57,274,85"/>
<area shape="poly" title=" " alt="" coords="142,68,186,68,186,74,142,74"/>
<area shape="rect" href="../../d8/d2b/inode_8c.html#a72a6e85b07ee4130a233e0db78fc95fe" title="디스크에서 아이노드 읽기" alt="" coords="334,5,426,33"/>
<area shape="poly" title=" " alt="" coords="136,54,189,43,318,24,319,29,190,48,137,59"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a68fff59f4eeded5f354caed94cd27f12" title="디바이스에 블록 단위(4KB)로 쓰기" alt="" coords="190,109,286,137"/>
<area shape="poly" title=" " alt="" coords="121,83,178,102,177,107,119,88"/>
<area shape="poly" title=" " alt="" coords="274,55,325,36,327,41,276,60"/>
<area shape="rect" href="../../d3/d1c/block_8c.html#a8a7cedcc55adf1eeb0a4d2d05cf4b795" title="디바이스에서 블록 단위(4KB)로 읽기" alt="" coords="334,57,426,85"/>
<area shape="poly" title=" " alt="" coords="275,68,318,68,318,74,275,74"/>
<area shape="rect" href="../../d1/d3e/img_8c.html#ab5f174b2ac56c4370d34760eebb328ad" title="원시 디바이스에서 특정 오프셋만큼 읽기" alt="" coords="474,32,557,60"/>
<area shape="poly" title=" " alt="" coords="427,26,460,32,459,37,426,31"/>
<area shape="poly" title=" " alt="" coords="426,60,459,54,460,59,427,65"/>
<area shape="rect" href="../../d1/d3e/img_8c.html#ad1abb87bbd6acc052bc498cd3d8f3278" title="원시 디바이스에 특정 오프셋만큼 쓰기" alt="" coords="337,109,423,137"/>
<area shape="poly" title=" " alt="" coords="286,120,322,120,322,126,286,126"/>
</map>
</div>
<div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_icgraph.png" border="0" usemap="#ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_icgraph" loading="lazy" alt=""/></div>
<map name="ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_icgraph" id="ade/d32/dir_8c_a6d70dfe2356e0eefe891a57e11c62e16_icgraph">
<area shape="rect" title="디렉터리 엔트리 삭제" alt="" coords="189,57,325,85"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#a40eb26b6c59a422e4ad1e906dff00037" title=" " alt="" coords="5,5,141,33"/>
<area shape="poly" title=" " alt="" coords="190,55,124,36,125,31,191,50"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#acf89b7cf9e32fbd2b7c749abb1b89234" title=" " alt="" coords="13,57,133,85"/>
<area shape="poly" title=" " alt="" coords="173,74,134,74,134,68,173,68"/>
<area shape="rect" href="../../d9/d70/ops_8c.html#aad351f0b0a44bc288b2400fd405cef8c" title=" " alt="" coords="10,109,136,137"/>
<area shape="poly" title=" " alt="" coords="191,92,125,111,124,106,190,87"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="../../de/d32/dir_8c.html">dir.c</a></li>
    <li class="footer">다음에 의해 생성됨 :  <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
